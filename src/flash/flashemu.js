/*!
 * FlashEmu v1.0.0 (2017-8-29)
 * (c) 2017-2017 spacemeowx2
 * Released under the MIT License.
 */
!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global.FlashEmu=factory()}(this,function(){"use strict";function __decorate(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r}function __awaiter(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments)).next())})}function setGlobalFlags(flags){globalFlags=flags}function checkContinuation(uint8array,start,checkLength){let array=uint8array;if(start+checkLength<array.length){for(;checkLength--;)if(128!=(192&array[++start]))return!1;return!0}return!1}function encodeUTF8(str){let o=[];for(let i=0;i<str.length;i++)o=o.concat((unicodeCode=>{let utf8Bytes=[];return unicodeCode<128?utf8Bytes.push(unicodeCode):unicodeCode<2048?(utf8Bytes.push(unicodeCode>>>6|192),utf8Bytes.push(63&unicodeCode|128)):unicodeCode<65536?(utf8Bytes.push(unicodeCode>>>12|224),utf8Bytes.push(unicodeCode>>6&63|128),utf8Bytes.push(63&unicodeCode|128)):unicodeCode<1<<21&&(utf8Bytes.push(unicodeCode>>>18|240),utf8Bytes.push(unicodeCode>>12&63|128),utf8Bytes.push(unicodeCode>>6&63|128),utf8Bytes.push(63&unicodeCode|128)),utf8Bytes})(str.charCodeAt(i)));return new Uint8Array(o)}function decodeUTF8(uint8array){let out=[],input=uint8array,i=0,length=uint8array.length;for(;i<length;)if(input[i]<128)out.push(String.fromCharCode(input[i])),++i;else{if(input[i]<192);else if(input[i]<224){if(checkContinuation(input,i,1)){let ucs4=(31&input[i])<<6|63&input[i+1];if(ucs4>=128){out.push(String.fromCharCode(65535&ucs4)),i+=2;continue}}}else if(input[i]<240){if(checkContinuation(input,i,2)){let ucs4=(15&input[i])<<12|(63&input[i+1])<<6|63&input[i+2];if(ucs4>=2048&&55296!=(63488&ucs4)){out.push(String.fromCharCode(65535&ucs4)),i+=3;continue}}}else if(input[i]<248&&checkContinuation(input,i,3)){let ucs4=(7&input[i])<<18|(63&input[i+1])<<12|(63&input[i+2])<<6|63&input[i+3];if(ucs4>65536&&ucs4<1114112){ucs4-=65536,out.push(String.fromCharCode(ucs4>>>10|55296)),out.push(String.fromCharCode(1023&ucs4|56320)),i+=4;continue}}out.push(String.fromCharCode(65533)),++i}return out.join("")}function hex(bytes){return bytes.map(i=>HexString[i>>4]+HexString[15&i]).join("")}function popManyInto(src,count,dst){let i=count;for(;i--;)dst[i]=src.pop();dst.length=count}function ord(str){return str.charCodeAt(0)}function isEmptyMethod(code){let view=new Uint8Array(code);return 208===view[0]&&48===view[1]&&71===view[2]}function axCoerceString(x){return"string"==typeof x?x:void 0===x?null:x+""}function axConvertString(x){return"string"==typeof x?x:x+""}function axEquals(left,right){return left==right}function axTypeOf(x){return typeof x}function axCoerceName(x){return"string"==typeof x?x:void 0==x?"null":x.toString()}function wrapFunction(sec,func){let ret;if(func instanceof Function&&!(func instanceof AXObject)){let map=wrapedFunction.get(sec);if(map||wrapedFunction.set(sec,map=new WeakMap),ret=map.get(func))return ret;(ret=sec.system.getClass(Multiname.Public("Function")).axNew()).native.func=func,map.set(func,ret)}return ret.call=function(...args){return this.native.call(...args)},ret}function clear(){funcTable.clear(),startStack.clear()}function topFunctions(count=20,key="runTime"){let ret={},out={};for(let[k,v]of funcTable)ret[k]=v;return Array.from(funcTable.keys()).sort((a,b)=>funcTable.get(b)[key]-funcTable.get(a)[key]).slice(0,count).forEach(e=>{out[e]=ret[e]}),out}function applyTraits(target,newTraits,scope){const app=target.app;app.sec;let traits=target.traits,toAppendTrait=[];for(let trait of newTraits){let method,runtimeTrait=new RuntimeTraitInfo(trait.name,trait.kindType);switch(trait.kindType){case TRAIT.Method:method=app.createMethodForTrait(trait,scope),runtimeTrait.value=method;break;case TRAIT.Getter:runtimeTrait.get=app.createMethodForTrait(trait,scope);break;case TRAIT.Setter:runtimeTrait.set=app.createMethodForTrait(trait,scope);break;case TRAIT.Slot:case TRAIT.Const:case TRAIT.Class:const slotTrait=trait.data;runtimeTrait.writable=!0,runtimeTrait.value=slotTrait.getDefaultValue(),runtimeTrait.typeName=slotTrait.typeName,runtimeTrait.slot=slotTrait.slotId,traits.addSlotTrait(runtimeTrait)}let currentTrait=traits.addTrait(runtimeTrait);toAppendTrait.push(runtimeTrait),currentTrait&&(trait.kindType!==TRAIT.Getter&&trait.kindType!==TRAIT.Setter||toAppendTrait.splice(toAppendTrait.indexOf(currentTrait),1))}for(let runtimeTrait of toAppendTrait)target.val.set(runtimeTrait.name.mangledName,runtimeTrait)}function getAppNative(app){let native=secNative.get(app.sec);return native||secNative.set(app.sec,native={AXClass:new Map,FunctionClass:new WeakMap}),native}function NativeClass(name){return constructor=>{name||"AX"===(name=constructor.name).substr(0,2)&&(name=name.substr(2)),nativeClasses.set(name,constructor)}}function Dynamic(){return constructor=>{nativeIsDynamic.set(constructor,!0)}}function NativeFunction(name){return function(target,propertyKey,descriptor){const cls=target.constructor;if(name=name||propertyKey,nativeFunctions.has(name))throw new Error("duplication of native function name");let map=nativeFuncClsNameMap.get(cls);map||nativeFuncClsNameMap.set(cls,map=new Map),map.set(name,propertyKey),nativeFunctions.set(name,cls)}}function getNativeFunction(app,name){let cls=nativeFunctions.get(name);if(!cls)return null;let set=getAppNative(app).FunctionClass,inst=set.get(cls);return inst||set.set(cls,inst=new cls(app)),(...args)=>inst[nativeFuncClsNameMap.get(cls).get(name)].call(inst,...args)}function simpleNativeGetter(key){return function(){return this.native[key]}}function simpleNativeSetter(key){return function(v){return this.native||logger$6.error("wtf!!"),this.native[key]=v}}function getMethodOrAccessorNative(app,trait){const parent=trait.holder;getAppNative(app);let metas;if(parent instanceof ClassInfo)metas=parent.holderMeta&&parent.holderMeta.filter(m=>"native"===m.name);else{if(!(parent instanceof InstanceInfo))throw new Error(`Unsupport trait type`);{const cls=parent.getClass();metas=cls.holderMeta&&cls.holderMeta.filter(m=>"native"===m.name)}}let func;if(1===metas.length){const meta=metas[0];if(!nativeClasses.get(meta.get("cls")))return logger$6.warn("Class",meta.get("cls"),"not found"),null;const isGetter=trait.isGetter(),isSetter=trait.isSetter();let propertyKey=trait.name.name;return isGetter?simpleNativeGetter(propertyKey):isSetter?simpleNativeSetter(propertyKey):func=function(...args){const target=this.native;return target[propertyKey]||logger$6.error("propertyKey",propertyKey,"not found"),target[propertyKey].call(this.native,...args)}}throw new Error("No native metadata")}function newNativeInstance(self,name,...args){const cls=getAppNative(self.app).AXClass.get(name);if(!cls)throw new Error(`Native class ${name} not registered`);if(!cls.native.axNewNative)throw new Error("wrong axNativeClass "+name);return cls.native.axNewNative(self,...args)}function getNativeAXClass(app,name,superCls){if(!name)return null;const cls=nativeClasses.get(name),isDynamic=nativeIsDynamic.get(cls);let set=getAppNative(app).AXClass,axCls=set.get(name);return axCls||(axCls=isDynamic?new AXDynamicNativeClass(app,cls,name,superCls):new AXNativeClass(app,cls,name,superCls),set.set(name,axCls),cls||logger$6.warn(`cls ${name} not found`)),axCls}function unwrapNsset(rn){rn.nsSet&&(rn.nsSet=rn.nsSet.map(ns=>{if(ns instanceof AXNativeObject)return ns.native;if(ns instanceof Namespace)return ns;throw new Error("unwrapNsset: Type error")}))}function zero$1(buf){for(var len=buf.length;--len>=0;)buf[len]=0}function StaticTreeDesc(static_tree,extra_bits,extra_base,elems,max_length){this.static_tree=static_tree,this.extra_bits=extra_bits,this.extra_base=extra_base,this.elems=elems,this.max_length=max_length,this.has_stree=static_tree&&static_tree.length}function TreeDesc(dyn_tree,stat_desc){this.dyn_tree=dyn_tree,this.max_code=0,this.stat_desc=stat_desc}function d_code(dist){return dist<256?_dist_code[dist]:_dist_code[256+(dist>>>7)]}function put_short(s,w){s.pending_buf[s.pending++]=255&w,s.pending_buf[s.pending++]=w>>>8&255}function send_bits(s,value,length){s.bi_valid>Buf_size-length?(s.bi_buf|=value<<s.bi_valid&65535,put_short(s,s.bi_buf),s.bi_buf=value>>Buf_size-s.bi_valid,s.bi_valid+=length-Buf_size):(s.bi_buf|=value<<s.bi_valid&65535,s.bi_valid+=length)}function send_code(s,c,tree){send_bits(s,tree[2*c],tree[2*c+1])}function bi_reverse(code,len){var res=0;do{res|=1&code,code>>>=1,res<<=1}while(--len>0);return res>>>1}function bi_flush(s){16===s.bi_valid?(put_short(s,s.bi_buf),s.bi_buf=0,s.bi_valid=0):s.bi_valid>=8&&(s.pending_buf[s.pending++]=255&s.bi_buf,s.bi_buf>>=8,s.bi_valid-=8)}function gen_bitlen(s,desc){var h,n,m,bits,xbits,f,tree=desc.dyn_tree,max_code=desc.max_code,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,extra=desc.stat_desc.extra_bits,base=desc.stat_desc.extra_base,max_length=desc.stat_desc.max_length,overflow=0;for(bits=0;bits<=MAX_BITS$1;bits++)s.bl_count[bits]=0;for(tree[2*s.heap[s.heap_max]+1]=0,h=s.heap_max+1;h<HEAP_SIZE$1;h++)(bits=tree[2*tree[2*(n=s.heap[h])+1]+1]+1)>max_length&&(bits=max_length,overflow++),tree[2*n+1]=bits,n>max_code||(s.bl_count[bits]++,xbits=0,n>=base&&(xbits=extra[n-base]),f=tree[2*n],s.opt_len+=f*(bits+xbits),has_stree&&(s.static_len+=f*(stree[2*n+1]+xbits)));if(0!==overflow){do{for(bits=max_length-1;0===s.bl_count[bits];)bits--;s.bl_count[bits]--,s.bl_count[bits+1]+=2,s.bl_count[max_length]--,overflow-=2}while(overflow>0);for(bits=max_length;0!==bits;bits--)for(n=s.bl_count[bits];0!==n;)(m=s.heap[--h])>max_code||(tree[2*m+1]!==bits&&(s.opt_len+=(bits-tree[2*m+1])*tree[2*m],tree[2*m+1]=bits),n--)}}function gen_codes(tree,max_code,bl_count){var bits,n,next_code=new Array(MAX_BITS$1+1),code=0;for(bits=1;bits<=MAX_BITS$1;bits++)next_code[bits]=code=code+bl_count[bits-1]<<1;for(n=0;n<=max_code;n++){var len=tree[2*n+1];0!==len&&(tree[2*n]=bi_reverse(next_code[len]++,len))}}function tr_static_init(){var n,bits,length,code,dist,bl_count=new Array(MAX_BITS$1+1);for(length=0,code=0;code<LENGTH_CODES$1-1;code++)for(base_length[code]=length,n=0;n<1<<extra_lbits[code];n++)_length_code[length++]=code;for(_length_code[length-1]=code,dist=0,code=0;code<16;code++)for(base_dist[code]=dist,n=0;n<1<<extra_dbits[code];n++)_dist_code[dist++]=code;for(dist>>=7;code<D_CODES$1;code++)for(base_dist[code]=dist<<7,n=0;n<1<<extra_dbits[code]-7;n++)_dist_code[256+dist++]=code;for(bits=0;bits<=MAX_BITS$1;bits++)bl_count[bits]=0;for(n=0;n<=143;)static_ltree[2*n+1]=8,n++,bl_count[8]++;for(;n<=255;)static_ltree[2*n+1]=9,n++,bl_count[9]++;for(;n<=279;)static_ltree[2*n+1]=7,n++,bl_count[7]++;for(;n<=287;)static_ltree[2*n+1]=8,n++,bl_count[8]++;for(gen_codes(static_ltree,L_CODES$1+1,bl_count),n=0;n<D_CODES$1;n++)static_dtree[2*n+1]=5,static_dtree[2*n]=bi_reverse(n,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(s){var n;for(n=0;n<L_CODES$1;n++)s.dyn_ltree[2*n]=0;for(n=0;n<D_CODES$1;n++)s.dyn_dtree[2*n]=0;for(n=0;n<BL_CODES$1;n++)s.bl_tree[2*n]=0;s.dyn_ltree[2*END_BLOCK]=1,s.opt_len=s.static_len=0,s.last_lit=s.matches=0}function bi_windup(s){s.bi_valid>8?put_short(s,s.bi_buf):s.bi_valid>0&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0}function copy_block(s,buf,len,header){bi_windup(s),header&&(put_short(s,len),put_short(s,~len)),common.arraySet(s.pending_buf,s.window,buf,len,s.pending),s.pending+=len}function smaller(tree,n,m,depth){var _n2=2*n,_m2=2*m;return tree[_n2]<tree[_m2]||tree[_n2]===tree[_m2]&&depth[n]<=depth[m]}function pqdownheap(s,tree,k){for(var v=s.heap[k],j=k<<1;j<=s.heap_len&&(j<s.heap_len&&smaller(tree,s.heap[j+1],s.heap[j],s.depth)&&j++,!smaller(tree,v,s.heap[j],s.depth));)s.heap[k]=s.heap[j],k=j,j<<=1;s.heap[k]=v}function compress_block(s,ltree,dtree){var dist,lc,code,extra,lx=0;if(0!==s.last_lit)do{dist=s.pending_buf[s.d_buf+2*lx]<<8|s.pending_buf[s.d_buf+2*lx+1],lc=s.pending_buf[s.l_buf+lx],lx++,0===dist?send_code(s,lc,ltree):(send_code(s,(code=_length_code[lc])+LITERALS$1+1,ltree),0!==(extra=extra_lbits[code])&&send_bits(s,lc-=base_length[code],extra),send_code(s,code=d_code(--dist),dtree),0!==(extra=extra_dbits[code])&&send_bits(s,dist-=base_dist[code],extra))}while(lx<s.last_lit);send_code(s,END_BLOCK,ltree)}function build_tree(s,desc){var n,m,node,tree=desc.dyn_tree,stree=desc.stat_desc.static_tree,has_stree=desc.stat_desc.has_stree,elems=desc.stat_desc.elems,max_code=-1;for(s.heap_len=0,s.heap_max=HEAP_SIZE$1,n=0;n<elems;n++)0!==tree[2*n]?(s.heap[++s.heap_len]=max_code=n,s.depth[n]=0):tree[2*n+1]=0;for(;s.heap_len<2;)tree[2*(node=s.heap[++s.heap_len]=max_code<2?++max_code:0)]=1,s.depth[node]=0,s.opt_len--,has_stree&&(s.static_len-=stree[2*node+1]);for(desc.max_code=max_code,n=s.heap_len>>1;n>=1;n--)pqdownheap(s,tree,n);node=elems;do{n=s.heap[1],s.heap[1]=s.heap[s.heap_len--],pqdownheap(s,tree,1),m=s.heap[1],s.heap[--s.heap_max]=n,s.heap[--s.heap_max]=m,tree[2*node]=tree[2*n]+tree[2*m],s.depth[node]=(s.depth[n]>=s.depth[m]?s.depth[n]:s.depth[m])+1,tree[2*n+1]=tree[2*m+1]=node,s.heap[1]=node++,pqdownheap(s,tree,1)}while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1],gen_bitlen(s,desc),gen_codes(tree,max_code,s.bl_count)}function scan_tree(s,tree,max_code){var n,curlen,prevlen=-1,nextlen=tree[1],count=0,max_count=7,min_count=4;for(0===nextlen&&(max_count=138,min_count=3),tree[2*(max_code+1)+1]=65535,n=0;n<=max_code;n++)curlen=nextlen,nextlen=tree[2*(n+1)+1],++count<max_count&&curlen===nextlen||(count<min_count?s.bl_tree[2*curlen]+=count:0!==curlen?(curlen!==prevlen&&s.bl_tree[2*curlen]++,s.bl_tree[2*REP_3_6]++):count<=10?s.bl_tree[2*REPZ_3_10]++:s.bl_tree[2*REPZ_11_138]++,count=0,prevlen=curlen,0===nextlen?(max_count=138,min_count=3):curlen===nextlen?(max_count=6,min_count=3):(max_count=7,min_count=4))}function send_tree(s,tree,max_code){var n,curlen,prevlen=-1,nextlen=tree[1],count=0,max_count=7,min_count=4;for(0===nextlen&&(max_count=138,min_count=3),n=0;n<=max_code;n++)if(curlen=nextlen,nextlen=tree[2*(n+1)+1],!(++count<max_count&&curlen===nextlen)){if(count<min_count)do{send_code(s,curlen,s.bl_tree)}while(0!=--count);else 0!==curlen?(curlen!==prevlen&&(send_code(s,curlen,s.bl_tree),count--),send_code(s,REP_3_6,s.bl_tree),send_bits(s,count-3,2)):count<=10?(send_code(s,REPZ_3_10,s.bl_tree),send_bits(s,count-3,3)):(send_code(s,REPZ_11_138,s.bl_tree),send_bits(s,count-11,7));count=0,prevlen=curlen,0===nextlen?(max_count=138,min_count=3):curlen===nextlen?(max_count=6,min_count=3):(max_count=7,min_count=4)}}function build_bl_tree(s){var max_blindex;for(scan_tree(s,s.dyn_ltree,s.l_desc.max_code),scan_tree(s,s.dyn_dtree,s.d_desc.max_code),build_tree(s,s.bl_desc),max_blindex=BL_CODES$1-1;max_blindex>=3&&0===s.bl_tree[2*bl_order[max_blindex]+1];max_blindex--);return s.opt_len+=3*(max_blindex+1)+5+5+4,max_blindex}function send_all_trees(s,lcodes,dcodes,blcodes){var rank;for(send_bits(s,lcodes-257,5),send_bits(s,dcodes-1,5),send_bits(s,blcodes-4,4),rank=0;rank<blcodes;rank++)send_bits(s,s.bl_tree[2*bl_order[rank]+1],3);send_tree(s,s.dyn_ltree,lcodes-1),send_tree(s,s.dyn_dtree,dcodes-1)}function detect_data_type(s){var n,black_mask=4093624447;for(n=0;n<=31;n++,black_mask>>>=1)if(1&black_mask&&0!==s.dyn_ltree[2*n])return Z_BINARY;if(0!==s.dyn_ltree[18]||0!==s.dyn_ltree[20]||0!==s.dyn_ltree[26])return Z_TEXT;for(n=32;n<LITERALS$1;n++)if(0!==s.dyn_ltree[2*n])return Z_TEXT;return Z_BINARY}function _tr_stored_block(s,buf,stored_len,last){send_bits(s,(STORED_BLOCK<<1)+(last?1:0),3),copy_block(s,buf,stored_len,!0)}function err(strm,errorCode){return strm.msg=messages[errorCode],errorCode}function rank(f){return(f<<1)-(f>4?9:0)}function zero(buf){for(var len=buf.length;--len>=0;)buf[len]=0}function flush_pending(strm){var s=strm.state,len=s.pending;len>strm.avail_out&&(len=strm.avail_out),0!==len&&(common.arraySet(strm.output,s.pending_buf,s.pending_out,len,strm.next_out),strm.next_out+=len,s.pending_out+=len,strm.total_out+=len,strm.avail_out-=len,s.pending-=len,0===s.pending&&(s.pending_out=0))}function flush_block_only(s,last){trees._tr_flush_block(s,s.block_start>=0?s.block_start:-1,s.strstart-s.block_start,last),s.block_start=s.strstart,flush_pending(s.strm)}function put_byte(s,b){s.pending_buf[s.pending++]=b}function putShortMSB(s,b){s.pending_buf[s.pending++]=b>>>8&255,s.pending_buf[s.pending++]=255&b}function read_buf(strm,buf,start,size){var len=strm.avail_in;return len>size&&(len=size),0===len?0:(strm.avail_in-=len,common.arraySet(buf,strm.input,strm.next_in,len,start),1===strm.state.wrap?strm.adler=adler32_1(strm.adler,buf,len,start):2===strm.state.wrap&&(strm.adler=crc32_1(strm.adler,buf,len,start)),strm.next_in+=len,strm.total_in+=len,len)}function longest_match(s,cur_match){var match,len,chain_length=s.max_chain_length,scan=s.strstart,best_len=s.prev_length,nice_match=s.nice_match,limit=s.strstart>s.w_size-MIN_LOOKAHEAD?s.strstart-(s.w_size-MIN_LOOKAHEAD):0,_win=s.window,wmask=s.w_mask,prev=s.prev,strend=s.strstart+MAX_MATCH,scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len];s.prev_length>=s.good_match&&(chain_length>>=2),nice_match>s.lookahead&&(nice_match=s.lookahead);do{if(match=cur_match,_win[match+best_len]===scan_end&&_win[match+best_len-1]===scan_end1&&_win[match]===_win[scan]&&_win[++match]===_win[scan+1]){scan+=2,match++;do{}while(_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&_win[++scan]===_win[++match]&&scan<strend);if(len=MAX_MATCH-(strend-scan),scan=strend-MAX_MATCH,len>best_len){if(s.match_start=cur_match,best_len=len,len>=nice_match)break;scan_end1=_win[scan+best_len-1],scan_end=_win[scan+best_len]}}}while((cur_match=prev[cur_match&wmask])>limit&&0!=--chain_length);return best_len<=s.lookahead?best_len:s.lookahead}function fill_window(s){var p,n,m,more,str,_w_size=s.w_size;do{if(more=s.window_size-s.lookahead-s.strstart,s.strstart>=_w_size+(_w_size-MIN_LOOKAHEAD)){common.arraySet(s.window,s.window,_w_size,_w_size,0),s.match_start-=_w_size,s.strstart-=_w_size,s.block_start-=_w_size,p=n=s.hash_size;do{m=s.head[--p],s.head[p]=m>=_w_size?m-_w_size:0}while(--n);p=n=_w_size;do{m=s.prev[--p],s.prev[p]=m>=_w_size?m-_w_size:0}while(--n);more+=_w_size}if(0===s.strm.avail_in)break;if(n=read_buf(s.strm,s.window,s.strstart+s.lookahead,more),s.lookahead+=n,s.lookahead+s.insert>=MIN_MATCH)for(str=s.strstart-s.insert,s.ins_h=s.window[str],s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+1])&s.hash_mask;s.insert&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask,s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++,s.insert--,!(s.lookahead+s.insert<MIN_MATCH)););}while(s.lookahead<MIN_LOOKAHEAD&&0!==s.strm.avail_in)}function deflate_fast(s,flush){for(var hash_head,bflush;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH$1)return BS_NEED_MORE;if(0===s.lookahead)break}if(hash_head=0,s.lookahead>=MIN_MATCH&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),0!==hash_head&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD&&(s.match_length=longest_match(s,hash_head)),s.match_length>=MIN_MATCH)if(bflush=trees._tr_tally(s,s.strstart-s.match_start,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=MIN_MATCH){s.match_length--;do{s.strstart++,s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart}while(0!=--s.match_length);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+1])&s.hash_mask;else bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,flush===Z_FINISH$1?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(s,flush){for(var hash_head,bflush,max_insert;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&flush===Z_NO_FLUSH$1)return BS_NEED_MORE;if(0===s.lookahead)break}if(hash_head=0,s.lookahead>=MIN_MATCH&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=MIN_MATCH-1,0!==hash_head&&s.prev_length<s.max_lazy_match&&s.strstart-hash_head<=s.w_size-MIN_LOOKAHEAD&&(s.match_length=longest_match(s,hash_head),s.match_length<=5&&(s.strategy===Z_FILTERED||s.match_length===MIN_MATCH&&s.strstart-s.match_start>4096)&&(s.match_length=MIN_MATCH-1)),s.prev_length>=MIN_MATCH&&s.match_length<=s.prev_length){max_insert=s.strstart+s.lookahead-MIN_MATCH,bflush=trees._tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-MIN_MATCH),s.lookahead-=s.prev_length-1,s.prev_length-=2;do{++s.strstart<=max_insert&&(s.ins_h=(s.ins_h<<s.hash_shift^s.window[s.strstart+MIN_MATCH-1])&s.hash_mask,hash_head=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart)}while(0!=--s.prev_length);if(s.match_available=0,s.match_length=MIN_MATCH-1,s.strstart++,bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}else if(s.match_available){if((bflush=trees._tr_tally(s,0,s.window[s.strstart-1]))&&flush_block_only(s,!1),s.strstart++,s.lookahead--,0===s.strm.avail_out)return BS_NEED_MORE}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(bflush=trees._tr_tally(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,flush===Z_FINISH$1?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(s,flush){for(var bflush,prev,scan,strend,_win=s.window;;){if(s.lookahead<=MAX_MATCH){if(fill_window(s),s.lookahead<=MAX_MATCH&&flush===Z_NO_FLUSH$1)return BS_NEED_MORE;if(0===s.lookahead)break}if(s.match_length=0,s.lookahead>=MIN_MATCH&&s.strstart>0&&(scan=s.strstart-1,(prev=_win[scan])===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan])){strend=s.strstart+MAX_MATCH;do{}while(prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&prev===_win[++scan]&&scan<strend);s.match_length=MAX_MATCH-(strend-scan),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=MIN_MATCH?(bflush=trees._tr_tally(s,1,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH$1?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(s,flush){for(var bflush;;){if(0===s.lookahead&&(fill_window(s),0===s.lookahead)){if(flush===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(s.match_length=0,bflush=trees._tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,bflush&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH$1?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):s.last_lit&&(flush_block_only(s,!1),0===s.strm.avail_out)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(good_length,max_lazy,nice_length,max_chain,func){this.good_length=good_length,this.max_lazy=max_lazy,this.nice_length=nice_length,this.max_chain=max_chain,this.func=func}function lm_init(s){s.window_size=2*s.w_size,zero(s.head),s.max_lazy_match=configuration_table[s.level].max_lazy,s.good_match=configuration_table[s.level].good_length,s.nice_match=configuration_table[s.level].nice_length,s.max_chain_length=configuration_table[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,s.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$1,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new common.Buf16(2*HEAP_SIZE),this.dyn_dtree=new common.Buf16(2*(2*D_CODES+1)),this.bl_tree=new common.Buf16(2*(2*BL_CODES+1)),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new common.Buf16(MAX_BITS+1),this.heap=new common.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new common.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(strm){var s;return strm&&strm.state?(strm.total_in=strm.total_out=0,strm.data_type=Z_UNKNOWN,s=strm.state,s.pending=0,s.pending_out=0,s.wrap<0&&(s.wrap=-s.wrap),s.status=s.wrap?INIT_STATE:BUSY_STATE,strm.adler=2===s.wrap?0:1,s.last_flush=Z_NO_FLUSH$1,trees._tr_init(s),Z_OK$1):err(strm,Z_STREAM_ERROR)}function deflateReset(strm){var ret=deflateResetKeep(strm);return ret===Z_OK$1&&lm_init(strm.state),ret}function deflateInit2(strm,level,method,windowBits,memLevel,strategy){if(!strm)return Z_STREAM_ERROR;var wrap=1;if(level===Z_DEFAULT_COMPRESSION$1&&(level=6),windowBits<0?(wrap=0,windowBits=-windowBits):windowBits>15&&(wrap=2,windowBits-=16),memLevel<1||memLevel>MAX_MEM_LEVEL||method!==Z_DEFLATED$1||windowBits<8||windowBits>15||level<0||level>9||strategy<0||strategy>Z_FIXED)return err(strm,Z_STREAM_ERROR);8===windowBits&&(windowBits=9);var s=new DeflateState;return strm.state=s,s.strm=strm,s.wrap=wrap,s.gzhead=null,s.w_bits=windowBits,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=memLevel+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+MIN_MATCH-1)/MIN_MATCH),s.window=new common.Buf8(2*s.w_size),s.head=new common.Buf16(s.hash_size),s.prev=new common.Buf16(s.w_size),s.lit_bufsize=1<<memLevel+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new common.Buf8(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=level,s.strategy=strategy,s.method=method,deflateReset(strm)}function buf2binstring(buf,len){if(len<65537&&(buf.subarray&&STR_APPLY_UIA_OK||!buf.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,common.shrinkBuf(buf,len));for(var result="",i=0;i<len;i++)result+=String.fromCharCode(buf[i]);return result}function Deflate(options){if(!(this instanceof Deflate))return new Deflate(options);this.options=common.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},options||{});var opt=this.options;opt.raw&&opt.windowBits>0?opt.windowBits=-opt.windowBits:opt.gzip&&opt.windowBits>0&&opt.windowBits<16&&(opt.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var status=deflate_1$2.deflateInit2(this.strm,opt.level,opt.method,opt.windowBits,opt.memLevel,opt.strategy);if(status!==Z_OK)throw new Error(messages[status]);if(opt.header&&deflate_1$2.deflateSetHeader(this.strm,opt.header),opt.dictionary){var dict;if(dict="string"==typeof opt.dictionary?strings.string2buf(opt.dictionary):"[object ArrayBuffer]"===toString.call(opt.dictionary)?new Uint8Array(opt.dictionary):opt.dictionary,(status=deflate_1$2.deflateSetDictionary(this.strm,dict))!==Z_OK)throw new Error(messages[status]);this._dict_set=!0}}function deflate(input,options){var deflator=new Deflate(options);if(deflator.push(input,!0),deflator.err)throw deflator.msg||messages[deflator.err];return deflator.result}function zswap32(q){return(q>>>24&255)+(q>>>8&65280)+((65280&q)<<8)+((255&q)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new common.Buf16(320),this.work=new common.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(strm){var state;return strm&&strm.state?(state=strm.state,strm.total_in=strm.total_out=state.total=0,strm.msg="",state.wrap&&(strm.adler=1&state.wrap),state.mode=HEAD,state.last=0,state.havedict=0,state.dmax=32768,state.head=null,state.hold=0,state.bits=0,state.lencode=state.lendyn=new common.Buf32(ENOUGH_LENS),state.distcode=state.distdyn=new common.Buf32(ENOUGH_DISTS),state.sane=1,state.back=-1,Z_OK$2):Z_STREAM_ERROR$1}function inflateReset(strm){var state;return strm&&strm.state?(state=strm.state,state.wsize=0,state.whave=0,state.wnext=0,inflateResetKeep(strm)):Z_STREAM_ERROR$1}function inflateReset2(strm,windowBits){var wrap,state;return strm&&strm.state?(state=strm.state,windowBits<0?(wrap=0,windowBits=-windowBits):(wrap=1+(windowBits>>4),windowBits<48&&(windowBits&=15)),windowBits&&(windowBits<8||windowBits>15)?Z_STREAM_ERROR$1:(null!==state.window&&state.wbits!==windowBits&&(state.window=null),state.wrap=wrap,state.wbits=windowBits,inflateReset(strm))):Z_STREAM_ERROR$1}function inflateInit2(strm,windowBits){var ret,state;return strm?(state=new InflateState,strm.state=state,state.window=null,(ret=inflateReset2(strm,windowBits))!==Z_OK$2&&(strm.state=null),ret):Z_STREAM_ERROR$1}function fixedtables(state){if(virgin){var sym;for(lenfix=new common.Buf32(512),distfix=new common.Buf32(32),sym=0;sym<144;)state.lens[sym++]=8;for(;sym<256;)state.lens[sym++]=9;for(;sym<280;)state.lens[sym++]=7;for(;sym<288;)state.lens[sym++]=8;for(inftrees(LENS,state.lens,0,288,lenfix,0,state.work,{bits:9}),sym=0;sym<32;)state.lens[sym++]=5;inftrees(DISTS,state.lens,0,32,distfix,0,state.work,{bits:5}),virgin=!1}state.lencode=lenfix,state.lenbits=9,state.distcode=distfix,state.distbits=5}function updatewindow(strm,src,end,copy){var dist,state=strm.state;return null===state.window&&(state.wsize=1<<state.wbits,state.wnext=0,state.whave=0,state.window=new common.Buf8(state.wsize)),copy>=state.wsize?(common.arraySet(state.window,src,end-state.wsize,state.wsize,0),state.wnext=0,state.whave=state.wsize):((dist=state.wsize-state.wnext)>copy&&(dist=copy),common.arraySet(state.window,src,end-copy,dist,state.wnext),(copy-=dist)?(common.arraySet(state.window,src,end-copy,copy,0),state.wnext=copy,state.whave=state.wsize):(state.wnext+=dist,state.wnext===state.wsize&&(state.wnext=0),state.whave<state.wsize&&(state.whave+=dist))),0}function Inflate(options){if(!(this instanceof Inflate))return new Inflate(options);this.options=common.assign({chunkSize:16384,windowBits:0,to:""},options||{});var opt=this.options;opt.raw&&opt.windowBits>=0&&opt.windowBits<16&&(opt.windowBits=-opt.windowBits,0===opt.windowBits&&(opt.windowBits=-15)),!(opt.windowBits>=0&&opt.windowBits<16)||options&&options.windowBits||(opt.windowBits+=32),opt.windowBits>15&&opt.windowBits<48&&0==(15&opt.windowBits)&&(opt.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;var status=inflate_1$2.inflateInit2(this.strm,opt.windowBits);if(status!==constants.Z_OK)throw new Error(messages[status]);this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header)}function inflate(input,options){var inflator=new Inflate(options);if(inflator.push(input,!0),inflator.err)throw inflator.msg||messages[inflator.err];return inflator.result}function decompressZlib(input){return __awaiter(this,void 0,void 0,function*(){return index_1(new Uint8Array(input)).buffer})}function decompressLZMA(input,unpackLength){return __awaiter(this,void 0,void 0,function*(){return lzma.decodeSWF(new Uint8Array(input),unpackLength).buffer})}function TagHandler(type){return function(target){target.type=type,tagHandler.set(type,target)}}const QName=7,QNameA=13,RTQName=15,RTQNameA=16,RTQNameL=17,RTQNameLA=18,Multiname$1=9,MultinameA=14,MultinameL=27,MultinameLA=28,MTypename=29;var MethodFlags;!function(MethodFlags){MethodFlags[MethodFlags.NEED_ARGUMENTS=1]="NEED_ARGUMENTS",MethodFlags[MethodFlags.NEED_ACTIVATION=2]="NEED_ACTIVATION",MethodFlags[MethodFlags.NEED_REST=4]="NEED_REST",MethodFlags[MethodFlags.HAS_OPTIONAL=8]="HAS_OPTIONAL",MethodFlags[MethodFlags.Native=32]="Native",MethodFlags[MethodFlags.SET_DXNS=64]="SET_DXNS",MethodFlags[MethodFlags.HAS_PARAM_NAMES=128]="HAS_PARAM_NAMES"}(MethodFlags||(MethodFlags={}));var ConstantKind;!function(ConstantKind){ConstantKind[ConstantKind.Int=3]="Int",ConstantKind[ConstantKind.UInt=4]="UInt",ConstantKind[ConstantKind.Double=6]="Double",ConstantKind[ConstantKind.Utf8=1]="Utf8",ConstantKind[ConstantKind.True=11]="True",ConstantKind[ConstantKind.False=10]="False",ConstantKind[ConstantKind.Null=12]="Null",ConstantKind[ConstantKind.Undefined=0]="Undefined",ConstantKind[ConstantKind.Namespace=8]="Namespace",ConstantKind[ConstantKind.PackageNamespace=22]="PackageNamespace",ConstantKind[ConstantKind.PackageInternalNs=23]="PackageInternalNs",ConstantKind[ConstantKind.ProtectedNamespace=24]="ProtectedNamespace",ConstantKind[ConstantKind.ExplicitNamespace=25]="ExplicitNamespace",ConstantKind[ConstantKind.StaticProtectedNs=26]="StaticProtectedNs",ConstantKind[ConstantKind.PrivateNs=5]="PrivateNs"}(ConstantKind||(ConstantKind={}));const NamespaceKinds=[8,22,23,24,25,26,5];var NamespaceType;!function(NamespaceType){NamespaceType[NamespaceType.Public=0]="Public",NamespaceType[NamespaceType.Protected=1]="Protected",NamespaceType[NamespaceType.PackageInternal=2]="PackageInternal",NamespaceType[NamespaceType.Private=3]="Private",NamespaceType[NamespaceType.Explicit=4]="Explicit",NamespaceType[NamespaceType.StaticProtected=5]="StaticProtected"}(NamespaceType||(NamespaceType={}));var TRAIT;!function(TRAIT){TRAIT[TRAIT.Slot=0]="Slot",TRAIT[TRAIT.Method=1]="Method",TRAIT[TRAIT.Getter=2]="Getter",TRAIT[TRAIT.Setter=3]="Setter",TRAIT[TRAIT.Class=4]="Class",TRAIT[TRAIT.Function=5]="Function",TRAIT[TRAIT.Const=6]="Const",TRAIT[TRAIT.GetterSetter=7]="GetterSetter"}(TRAIT||(TRAIT={}));var ATTR;!function(ATTR){ATTR[ATTR.Final=1]="Final",ATTR[ATTR.Override=2]="Override",ATTR[ATTR.Metadata=4]="Metadata"}(ATTR||(ATTR={}));var InstanceFlags;!function(InstanceFlags){InstanceFlags[InstanceFlags.ClassSealed=1]="ClassSealed",InstanceFlags[InstanceFlags.ClassFinal=2]="ClassFinal",InstanceFlags[InstanceFlags.ClassInterface=4]="ClassInterface",InstanceFlags[InstanceFlags.ClassProtectedNs=8]="ClassProtectedNs"}(InstanceFlags||(InstanceFlags={}));let globalFlags={enableDebug:!1,enableLog:!1,enableWarn:!0,enableError:!0};class Logger{constructor(_tag){this._tag=_tag,this.enableDebug=null,this.enableLog=null,this.enableWarn=null,this.enableError=null,this._tag=`[${_tag}]`}get tag(){return this._tag}get _enableDebug(){return Logger.logFilter(this._tag)&&null===this.enableDebug?globalFlags.enableDebug:this.enableDebug}get _enableLog(){return Logger.logFilter(this._tag)&&null===this.enableLog?globalFlags.enableLog:this.enableLog}get _enableWarn(){return Logger.logFilter(this._tag)&&null===this.enableWarn?globalFlags.enableWarn:this.enableWarn}get _enableError(){return Logger.logFilter(this._tag)&&null===this.enableError?globalFlags.enableError:this.enableError}debug(...args){this._enableDebug&&console.log(this.tag,...args)}log(...args){this._enableLog&&console.log(this.tag,...args)}warn(...args){this._enableWarn&&console.log(this.tag,...args)}error(...args){this._enableError&&console.error(this.tag,...args)}}Logger.logFilter=(tag=>!0);new Logger("Utils");const HexString="0123456789abcdef";class BufferReaderError extends Error{}class BufferReader{constructor(buffer){this.buffer=buffer,this.dataView=new DataView(buffer,0),this.ptr=0}isEOF(){return this.ptr>=this.buffer.byteLength}throwEOF(){throw new BufferReaderError("Read EOF")}movePtr(len){const t=this.ptr;return this.ptr+=len,this.ptr>this.buffer.byteLength&&this.throwEOF(),t}readU8(){const t=this.ptr;return this.ptr=t+1,this.dataView.getUint8(t)}readU16(){return this.dataView.getUint16(this.movePtr(2),!0)}readUI16(){return this.dataView.getUint16(this.movePtr(2),!0)}readUI32(){return this.dataView.getUint32(this.movePtr(4),!0)}readS8(){return this.dataView.getInt8(this.movePtr(1))}readS24(){let right=this.readU8(),result=this.readU16()<<8|right;return result=result<<8>>8}readU30(){const view=this.dataView;let i,p=this.ptr,c=view.getUint8(p),ret=127&c;for(i=1;128&c&&i<5;i++)ret|=(127&(c=view.getUint8(p+i)))<<7*i;return this.ptr+=i,ret>>>0}readU32(){return this.readU30()}readS32(){return 0|this.readU32()}readD64(){return this.dataView.getFloat64(this.movePtr(8),!0)}readString(size){return decodeUTF8(new Uint8Array(this.readArray(size)))}readCStyleString(){let c,ptr;for(ptr=this.ptr;0!==c;ptr++)c=this.dataView.getUint8(ptr);let array=new Uint8Array(this.readArray(ptr-this.ptr-1));return this.readU8(),decodeUTF8(array)}readArray(size){size<0&&(size+=this.buffer.byteLength-this.ptr+1),this.ptr+size>this.buffer.byteLength&&(console.error("EOF",this.ptr,size,this.buffer.byteLength),this.throwEOF());let array=this.buffer.slice(this.ptr,this.ptr+size);return this.ptr+=size,array}getPosition(){return this.ptr}}new Logger("Abc");class Namespace{constructor(_type,_uri,_prefix=""){this._type=_type,this._uri=_uri,this._prefix=_prefix,this._mangledName=null,null===this._uri&&(this._uri=""),null===this._prefix&&(this._prefix="")}static Package(name){return new Namespace(NamespaceType.Public,name)}static PackageInternal(name){return new Namespace(NamespaceType.PackageInternal,name)}static get Public(){return Namespace._public||(Namespace._public=new Namespace(NamespaceType.Public,"")),Namespace._public}static Private(uri=""){return new Namespace(NamespaceType.Private,uri)}static MangledName(type,uri,prefix){return type===NamespaceType.Public&&""===uri?Namespace.PublicMangledName:"_"+type.toString(16)+"_"+prefix+"_"+uri}static read(reader,abc){let type,kind=reader.readU8();switch(kind){case ConstantKind.Namespace:case ConstantKind.PackageNamespace:type=NamespaceType.Public;break;case ConstantKind.PackageInternalNs:type=NamespaceType.PackageInternal;break;case ConstantKind.ProtectedNamespace:type=NamespaceType.Protected;break;case ConstantKind.ExplicitNamespace:type=NamespaceType.Explicit;break;case ConstantKind.StaticProtectedNs:type=NamespaceType.StaticProtected;break;case ConstantKind.PrivateNs:type=NamespaceType.Private;break;default:throw new Error("Namespace type error.")}let name=null;return NamespaceKinds.includes(kind)?name=abc.getString(reader.readU30()):console.error("kind not includes",kind),new Namespace(type,name)}get type(){return this._type}get uri(){return this._uri}get prefix(){return this._prefix}get mangledName(){return this._mangledName||(this._mangledName=Namespace.MangledName(this._type,this._uri,this._prefix)),this._mangledName}isPublic(){return this._type===NamespaceType.Public}Multiname(name){return Multiname.QName(this,name)}toString(){return this._uri}}Namespace.PublicMangledName="_public";class ExceptionInfo{static read(reader,abc){let self=new ExceptionInfo;if(self.start=reader.readU30(),self.end=reader.readU30(),self.target=reader.readU30(),self.excType=abc.getMultiname(reader.readU30()),self.varName=abc.getMultiname(reader.readU30()),self.varName){let trait=new TraitInfo(abc);trait.holder=self,trait.name=self.varName,trait.kindType=TRAIT.Slot,trait.data=new TraitSlot(abc),trait.data.typeName=self.excType,self.traits=new Traits(trait)}return self}getTrait(){return this.traits}}class MethodBodyInfo{static read(reader,abc){let self=new MethodBodyInfo;self.method=abc.getMethod(reader.readU30()),self.maxStack=reader.readU30(),self.localCount=reader.readU30(),self.initScopeDepth=reader.readU30(),self.maxScopeDepth=reader.readU30();const codeLength=reader.readU30();self.code=reader.readArray(codeLength);const exceptionCount=reader.readU30();self.exception=[];for(let i=0;i<exceptionCount;i++)self.exception.push(ExceptionInfo.read(reader,abc));const traitCount=reader.readU30();self.trait=new Traits;for(let i=0;i<traitCount;i++)self.trait.push(TraitInfo.read(reader,abc,self));return self}}class ScriptInfo{constructor(abc){this.abc=abc}static read(reader,abc){let self=new ScriptInfo(abc);self.init=abc.getMethod(reader.readU30());const traitCount=reader.readU30();self.trait=new Traits;for(let i=0;i<traitCount;i++)self.trait.push(TraitInfo.read(reader,abc,self));return self}getID(){return this.abc.script.indexOf(this)}}class ClassInfo{constructor(abc){this.abc=abc,this.trait=new Traits,this.holderMeta=[]}static read(reader,abc){let self=new ClassInfo(abc);self.cinit=abc.getMethod(reader.readU30());const traitCount=reader.readU30();for(let i=0;i<traitCount;i++)self.trait.push(TraitInfo.read(reader,abc,self));return self}getInstance(){return this.abc?this.abc.getInstanceByClass(this):null}}class TraitSlot{constructor(abc){this.abc=abc,this.vkind=-1}static read(reader,abc){let self=new TraitSlot(abc);return self.slotId=reader.readU30(),self.typeName=abc.getMultiname(reader.readU30()),self.vindex=reader.readU30(),0!==self.vindex&&(self.vkind=reader.readU8()),self}getDefaultValue(){if(-1===this.vkind){if(null===this.typeName)return;let value=typeDefaultValues[this.typeName.mangledName];return void 0===value?null:value}return this.abc.getConstant(this.vkind,this.vindex)}}class TraitClass extends TraitSlot{constructor(abc){super(abc),this.vkind=0,this.vindex=-1,this.typeName=null}static read(reader,abc){let self=new TraitClass(abc);return self.slotId=reader.readU30(),self.classi=abc.getClass(reader.readU30()),self}}class TraitMethod{static read(reader,abc){let self=new TraitMethod;return self.dispId=reader.readU30(),self.method=abc.getMethod(reader.readU30()),self}}class TraitFunction{static read(reader,abc){let self=new TraitFunction;return self.slotId=reader.readU30(),self.function=abc.getMethod(reader.readU30()),self}}class TraitInfo{constructor(abc){this.abc=abc}static read(reader,abc,belongsTo){let self=new TraitInfo(abc);self.holder=belongsTo,self.name=abc.getMultiname(reader.readU30());const kind=reader.readU8();switch(self.kindType=15&kind,self.kindFlags=kind>>4,self.data=null,self.kindType){case TRAIT.Slot:case TRAIT.Const:self.data=TraitSlot.read(reader,abc);break;case TRAIT.Method:case TRAIT.Getter:case TRAIT.Setter:self.data=TraitMethod.read(reader,abc);break;case TRAIT.Class:self.data=TraitClass.read(reader,abc);break;case TRAIT.Function:self.data=TraitFunction.read(reader,abc)}if(0!=(self.kindFlags&ATTR.Metadata)){const metadataCount=reader.readU30();self.metadata=[];for(let i=0;i<metadataCount;i++)self.metadata.push(abc.getMetadata(reader.readU30()))}if(self.data instanceof TraitClass){const cls=self.data.classi;self.metadata&&(cls.holderMeta=cls.holderMeta.concat(self.metadata)),cls.holderTraitName=self.name}return self}isSetter(){return this.kindType===TRAIT.Setter}isGetter(){return this.kindType===TRAIT.Getter}isMethod(){return this.kindType===TRAIT.Method}}class Traits extends Array{getTrait(mn){let mnName=mn.name,nss=mn.nsSet,traits=this;for(let trait of traits){let traitMn=trait.name;if(traitMn.name===mnName){let ns=traitMn.nsSet[0];for(let j=0;j<nss.length;j++)if(ns.mangledName===nss[j].mangledName)return trait}}return null}}class InstanceInfo{constructor(abc){this.abc=abc}static read(reader,abc){let self=new InstanceInfo(abc);self.name=abc.getMultiname(reader.readU30()),self.superName=abc.getMultiname(reader.readU30()),self.flags=reader.readU8(),0!=(self.flags&InstanceFlags.ClassProtectedNs)&&(self.protectedNs=abc.getNamespace(reader.readU30()));const intrfCount=reader.readU30();self.interface=[];for(let i=0;i<intrfCount;i++)self.interface.push(abc.getMultiname(reader.readU30()));self.iinit=abc.getMethod(reader.readU30());const traitCount=reader.readU30();self.trait=new Traits;for(let i=0;i<traitCount;i++)self.trait.push(TraitInfo.read(reader,abc,self));return self}getClass(){return this.abc.getClassByInstance(this)}}class MetadataInfo extends Map{static read(reader,abc){let self=new MetadataInfo;self.name=abc.getString(reader.readU30());const itemCount=reader.readU30();let keys=[];for(let i=0;i<itemCount;i++)keys.push(abc.getString(reader.readU30()));for(let i=0;i<itemCount;i++){const val=abc.getString(reader.readU30());null===keys[i]?self.value=val:self.set(keys[i],val)}return self}toJSON(){let obj={};for(let i of this.entries())obj[i[0]]=i[1];return obj.__name__=this.name,obj}}class OptionDetail{static read(reader,abc){let self=new OptionDetail,index=reader.readU30();return self.kind=reader.readU8(),self.val=abc.getConstant(self.kind,index),self}}class MethodInfo{constructor(abc){this.abc=abc}static read(reader,abc){let self=new MethodInfo(abc);const paramCount=reader.readU30();self.returnType=abc.getMultiname(reader.readU30()),self.paramType=[];for(let i=0;i<paramCount;i++)self.paramType.push(abc.getMultiname(reader.readU30()));if(self.name=abc.getString(reader.readU30()),self.flags=reader.readU8(),self.options=[],0!=(self.flags&MethodFlags.HAS_OPTIONAL)){const optionCount=reader.readU30();for(let i=0;i<optionCount;i++)self.options.push(OptionDetail.read(reader,abc))}if(self.paramNames=[],0!=(self.flags&MethodFlags.HAS_PARAM_NAMES))for(let i=0;i<paramCount;i++)self.paramNames.push(abc.getString(reader.readU30()));return self.flags,MethodFlags.Native,self}getBody(){return this.abc.getMethodBodyByMethod(this)}needsRest(){return 0!=(this.flags&MethodFlags.NEED_REST)}isNative(){return 0!=(this.flags&MethodFlags.Native)}}class Multiname{constructor(){this._mangledName=null}static Public(name){let self=new Multiname;return self.kind=QName,self.nsSet=[new Namespace(NamespaceType.Public,"")],self.name=name,self}static Package(pkg,name){let self=new Multiname;return self.kind=QName,self.nsSet=[Namespace.Package(pkg)],self.name=name,self}static PackageInternal(pkg,name){let self=new Multiname;return self.kind=QName,self.nsSet=[Namespace.PackageInternal(pkg)],self.name=name,self}static QName(ns,name){let self=new Multiname;return self.kind=QName,self.nsSet=[ns],self.name=name,self}static PublicMangledName(name){return Multiname.MangledName(Namespace.Public,name)}static MangledName(namespace,name){return"$"+namespace.mangledName+"-"+name}static stripPublicMangledName(name){const prefix=Multiname.PublicMangledName("");return name.startsWith(prefix)?name.substr(prefix.length):null}static read(reader,abc){let name,qname,params,kind=reader.readU8(),nsSet=[],lazy=!1;switch(kind){case QName:case QNameA:nsSet=[abc.getNamespace(reader.readU30())],name=abc.getString(reader.readU30());break;case RTQName:case RTQNameA:name=abc.getString(reader.readU30());break;case RTQNameL:case RTQNameLA:break;case Multiname$1:case MultinameA:name=abc.getString(reader.readU30()),nsSet=abc.getNsSet(reader.readU30());break;case MultinameL:case MultinameLA:nsSet=abc.getNsSet(reader.readU30());break;case MTypename:lazy=!0,qname=reader.readU30();const paramLength=reader.readU30();params=[];for(let i=0;i<paramLength;i++)params.push(reader.readU30());break;default:console.error("Unknown kind of Multiname:"+kind)}return getMultiname=>{let self=new Multiname;return self.kind=kind,self.name=name,self.nsSet=nsSet,self.kind===MTypename&&(self.factory=getMultiname(qname),self.params=params.map(i=>getMultiname(i)),self.nsSet=self.factory.nsSet,self.name=self.factory.name),self}}get mangledName(){let mangledName=this._mangledName;return mangledName||(mangledName=this._mangledName=Multiname.MangledName(this.nsSet[0],this.name)),mangledName}toString(){let ns=this.nsSet[0];return ns?ns.toString()+":"+this.name:this.name}toJSON(){return this.kind===QName&&1===this.nsSet.length?this.nsSet[0].isPublic()?this.name:`${this.nsSet[0].uri}::${this.name}`:this}isRuntimeName(){switch(this.kind){case RTQNameL:case RTQNameLA:case MultinameL:case MultinameLA:return!0}return!1}isRuntime(){switch(this.kind){case QName:case QNameA:case Multiname$1:case MultinameA:return!1}return!0}isRuntimeNamespace(){switch(this.kind){case RTQName:case RTQNameA:case RTQNameL:case RTQNameLA:return!0}return!1}isAttribute(){switch(this.kind){case QNameA:case RTQNameA:case RTQNameLA:case MultinameA:case MultinameLA:return!0}return!1}isAnyName(){return null===this.name}}let typeDefaultValues={[Multiname.PublicMangledName("Number")]:NaN,[Multiname.PublicMangledName("int")]:0,[Multiname.PublicMangledName("uint")]:0,[Multiname.PublicMangledName("Boolean")]:!1};class CPoolInfo{static read(self,reader,abc){const intCount=reader.readU30()-1;self.integer=[null];for(let i=0;i<intCount;i++)self.integer.push(reader.readS32());const uintCount=reader.readU30()-1;self.uinteger=[null];for(let i=0;i<uintCount;i++)self.uinteger.push(reader.readU32());const doubleCount=reader.readU30()-1;self.double=[null];for(let i=0;i<doubleCount;i++)self.double.push(reader.readD64());const stringCount=reader.readU30()-1;self.string=[null];for(let i=0;i<stringCount;i++){const size=reader.readU30();self.string.push(reader.readString(size))}const namespaceCount=reader.readU30()-1;self.namespace=[null];for(let i=0;i<namespaceCount;i++)self.namespace.push(Namespace.read(reader,abc));const nsSetCount=reader.readU30()-1;self.nsSet=[null];for(let i=0;i<nsSetCount;i++){let nsSet=[];const count=reader.readU30();for(let i=0;i<count;i++)nsSet.push(abc.getNamespace(reader.readU30()));self.nsSet.push(nsSet)}const multinameCount=reader.readU30()-1;let multiname=[null];for(let i=0;i<multinameCount;i++)multiname.push(Multiname.read(reader,abc));const getMultiname=index=>{let mn=multiname[index];return mn instanceof Multiname?mn:mn(getMultiname)};for(let i=1;i<=multinameCount;i++)multiname[i]=getMultiname(i);return self.multiname=multiname,self}}class AbcMap{constructor(){this.methodBody=this.instance=this.cls=new WeakMap}}class AbcFile{constructor(reader,app){this.app=app,this.minorVersion=reader.readU16(),this.majorVersion=reader.readU16(),this.constantPool=new CPoolInfo,CPoolInfo.read(this.constantPool,reader,this);const methodCount=reader.readU30();this.method=[];for(let i=0;i<methodCount;i++)this.method.push(MethodInfo.read(reader,this));for(let i=0;i<methodCount;i++)this.method[i].id=i;const metadataCount=reader.readU30();this.metadata=[];for(let i=0;i<metadataCount;i++)this.metadata.push(MetadataInfo.read(reader,this));const classCount=reader.readU30();this.instance=[];for(let i=0;i<classCount;i++)this.instance.push(InstanceInfo.read(reader,this));this.classes=[];for(let i=0;i<classCount;i++)this.classes.push(ClassInfo.read(reader,this));const scriptCount=reader.readU30();this.script=[];for(let i=0;i<scriptCount;i++)this.script.push(ScriptInfo.read(reader,this));const methodBodyCount=reader.readU30();this.methodBody=[];for(let i=0;i<methodBodyCount;i++)this.methodBody.push(MethodBodyInfo.read(reader,this));this.map=new AbcMap;for(let methodBody of this.methodBody)this.map.methodBody.set(methodBody.method,methodBody);for(let i=0;i<classCount;i++)this.map.instance.set(this.classes[i],this.instance[i]),this.map.cls.set(this.instance[i],this.classes[i])}getMetadata(index){return this.metadata[index]}getMethodBodyByMethod(method){return this.map.methodBody.get(method)}getInstanceByClass(cls){return this.map.instance.get(cls)}getClassByInstance(inst){return this.map.cls.get(inst)}getMethod(index){return this.method[index]}getString(index){return this.constantPool.string[index]}getMultiname(index){return this.constantPool.multiname[index]}getNamespace(index){return this.constantPool.namespace[index]}getClass(index){return this.classes[index]}getNsSet(index){return this.constantPool.nsSet[index]}getScript(index){return this.script[index]}getUInt(index){return this.constantPool.uinteger[index]}getInt(index){return this.constantPool.integer[index]}getDouble(index){return this.constantPool.double[index]}getConstant(kind,idx){switch(kind){case ConstantKind.Int:return this.getInt(idx);case ConstantKind.UInt:return this.getUInt(idx);case ConstantKind.Double:return this.getDouble(idx);case ConstantKind.Utf8:return this.getString(idx);case ConstantKind.True:case ConstantKind.False:return ConstantKind.True===kind;case ConstantKind.Null:return null;case ConstantKind.Undefined:return;default:if(NamespaceKinds.includes(kind))return this.getNamespace(idx);throw new Error("Unknown constant kind"+kind)}}toJSON(){let stack=(new Error).stack;return stack.length-stack.replace(/AbcFile\.toJSON/g,"AbcFiletoJSON").length>1?null:JSON.parse(JSON.stringify({minorVersion:this.minorVersion,majorVersion:this.majorVersion,script:this.script,classes:this.classes,instance:this.instance,method:this.method,methodBody:this.methodBody},(k,v)=>{if("abc"!==k&&"app"!==k&&"holder"!==k)return"kind"===k||"_kind"===k?`0x${v.toString(16)}`:v instanceof ArrayBuffer?hex(Array.from(new Uint8Array(v))):(v instanceof Object&&v.constructor&&v.constructor.name&&(v.cType=v.constructor.name),v)}))}}class RuntimeTraitInfo{constructor(name,kind){this.name=name,this.kind=kind,this.configurable=!0,this.enumerable=!1,this.writable=!0,this.metadata=null}setDescriptor(descriptor){const ps=["configurable","enumerable","value","writable","get","set"];Object.keys(descriptor).filter(i=>ps.includes(i)).forEach(key=>{this[key]=descriptor[key]})}descriptor(){let result={configurable:this.configurable,enumerable:this.enumerable,writable:this.writable,get:this.get,set:this.set,value:this.value};return this.get||this.set?(delete result.value,delete result.writable):(delete result.get,delete result.set),result}}class RuntimeTraits{constructor(superTraits,protectedNs,protectedNsMappings){this.superTraits=superTraits,this.protectedNs=protectedNs,this.protectedNsMappings=protectedNsMappings,this._nextSlotID=1,this.slots=[];let map=this.map=new Map;if(superTraits){let superMap=superTraits.map;for(let[key,val]of superMap)map.set(key,new Map(val))}}addTrait(trait){let mn=trait.name,mappings=this.map.get(mn.name);mappings||(mappings=new Map,this.map.set(mn.name,mappings));const nsName=mn.nsSet[0].mangledName,current=mappings.get(nsName);return mappings.set(nsName,trait),current&&(trait.kind===TRAIT.Setter&&current.get&&(trait.get=current.get,trait.kind=TRAIT.GetterSetter),trait.kind===TRAIT.Getter&&current.set&&(trait.set=current.set,trait.kind=TRAIT.GetterSetter)),current}addSlotTrait(trait){let slot=trait.slot;slot?this._nextSlotID=slot+1:slot=trait.slot=this._nextSlotID++,this.slots[slot]=trait}getTrait(nsSet,name){let mappings=this.map.get(name);if(!mappings)return null;let trait;for(let i=0;i<nsSet.length;i++){let ns=nsSet[i];if(trait=mappings.get(ns.mangledName))return trait;if(ns.type===NamespaceType.Protected){let protectedScope=this;for(;protectedScope;){if(protectedScope.protectedNs===ns&&(trait=protectedScope.protectedNsMappings[name]))return trait;protectedScope=protectedScope.superTraits}}}return null}}var Bytecode;!function(Bytecode){Bytecode[Bytecode.BKPT=1]="BKPT",Bytecode[Bytecode.NOP=2]="NOP",Bytecode[Bytecode.THROW=3]="THROW",Bytecode[Bytecode.GETSUPER=4]="GETSUPER",Bytecode[Bytecode.SETSUPER=5]="SETSUPER",Bytecode[Bytecode.DXNS=6]="DXNS",Bytecode[Bytecode.DXNSLATE=7]="DXNSLATE",Bytecode[Bytecode.KILL=8]="KILL",Bytecode[Bytecode.LABEL=9]="LABEL",Bytecode[Bytecode.LF32X4=10]="LF32X4",Bytecode[Bytecode.SF32X4=11]="SF32X4",Bytecode[Bytecode.IFNLT=12]="IFNLT",Bytecode[Bytecode.IFNLE=13]="IFNLE",Bytecode[Bytecode.IFNGT=14]="IFNGT",Bytecode[Bytecode.IFNGE=15]="IFNGE",Bytecode[Bytecode.JUMP=16]="JUMP",Bytecode[Bytecode.IFTRUE=17]="IFTRUE",Bytecode[Bytecode.IFFALSE=18]="IFFALSE",Bytecode[Bytecode.IFEQ=19]="IFEQ",Bytecode[Bytecode.IFNE=20]="IFNE",Bytecode[Bytecode.IFLT=21]="IFLT",Bytecode[Bytecode.IFLE=22]="IFLE",Bytecode[Bytecode.IFGT=23]="IFGT",Bytecode[Bytecode.IFGE=24]="IFGE",Bytecode[Bytecode.IFSTRICTEQ=25]="IFSTRICTEQ",Bytecode[Bytecode.IFSTRICTNE=26]="IFSTRICTNE",Bytecode[Bytecode.LOOKUPSWITCH=27]="LOOKUPSWITCH",Bytecode[Bytecode.PUSHWITH=28]="PUSHWITH",Bytecode[Bytecode.POPSCOPE=29]="POPSCOPE",Bytecode[Bytecode.NEXTNAME=30]="NEXTNAME",Bytecode[Bytecode.HASNEXT=31]="HASNEXT",Bytecode[Bytecode.PUSHNULL=32]="PUSHNULL",Bytecode[Bytecode.PUSHUNDEFINED=33]="PUSHUNDEFINED",Bytecode[Bytecode.PUSHFLOAT=34]="PUSHFLOAT",Bytecode[Bytecode.NEXTVALUE=35]="NEXTVALUE",Bytecode[Bytecode.PUSHBYTE=36]="PUSHBYTE",Bytecode[Bytecode.PUSHSHORT=37]="PUSHSHORT",Bytecode[Bytecode.PUSHTRUE=38]="PUSHTRUE",Bytecode[Bytecode.PUSHFALSE=39]="PUSHFALSE",Bytecode[Bytecode.PUSHNAN=40]="PUSHNAN",Bytecode[Bytecode.POP=41]="POP",Bytecode[Bytecode.DUP=42]="DUP",Bytecode[Bytecode.SWAP=43]="SWAP",Bytecode[Bytecode.PUSHSTRING=44]="PUSHSTRING",Bytecode[Bytecode.PUSHINT=45]="PUSHINT",Bytecode[Bytecode.PUSHUINT=46]="PUSHUINT",Bytecode[Bytecode.PUSHDOUBLE=47]="PUSHDOUBLE",Bytecode[Bytecode.PUSHSCOPE=48]="PUSHSCOPE",Bytecode[Bytecode.PUSHNAMESPACE=49]="PUSHNAMESPACE",Bytecode[Bytecode.HASNEXT2=50]="HASNEXT2",Bytecode[Bytecode.LI8=53]="LI8",Bytecode[Bytecode.LI16=54]="LI16",Bytecode[Bytecode.LI32=55]="LI32",Bytecode[Bytecode.LF32=56]="LF32",Bytecode[Bytecode.LF64=57]="LF64",Bytecode[Bytecode.SI8=58]="SI8",Bytecode[Bytecode.SI16=59]="SI16",Bytecode[Bytecode.SI32=60]="SI32",Bytecode[Bytecode.SF32=61]="SF32",Bytecode[Bytecode.SF64=62]="SF64",Bytecode[Bytecode.NEWFUNCTION=64]="NEWFUNCTION",Bytecode[Bytecode.CALL=65]="CALL",Bytecode[Bytecode.CONSTRUCT=66]="CONSTRUCT",Bytecode[Bytecode.CALLMETHOD=67]="CALLMETHOD",Bytecode[Bytecode.CALLSTATIC=68]="CALLSTATIC",Bytecode[Bytecode.CALLSUPER=69]="CALLSUPER",Bytecode[Bytecode.CALLPROPERTY=70]="CALLPROPERTY",Bytecode[Bytecode.RETURNVOID=71]="RETURNVOID",Bytecode[Bytecode.RETURNVALUE=72]="RETURNVALUE",Bytecode[Bytecode.CONSTRUCTSUPER=73]="CONSTRUCTSUPER",Bytecode[Bytecode.CONSTRUCTPROP=74]="CONSTRUCTPROP",Bytecode[Bytecode.CALLSUPERID=75]="CALLSUPERID",Bytecode[Bytecode.CALLPROPLEX=76]="CALLPROPLEX",Bytecode[Bytecode.CALLINTERFACE=77]="CALLINTERFACE",Bytecode[Bytecode.CALLSUPERVOID=78]="CALLSUPERVOID",Bytecode[Bytecode.CALLPROPVOID=79]="CALLPROPVOID",Bytecode[Bytecode.SXI1=80]="SXI1",Bytecode[Bytecode.SXI8=81]="SXI8",Bytecode[Bytecode.SXI16=82]="SXI16",Bytecode[Bytecode.APPLYTYPE=83]="APPLYTYPE",Bytecode[Bytecode.PUSHFLOAT4=84]="PUSHFLOAT4",Bytecode[Bytecode.NEWOBJECT=85]="NEWOBJECT",Bytecode[Bytecode.NEWARRAY=86]="NEWARRAY",Bytecode[Bytecode.NEWACTIVATION=87]="NEWACTIVATION",Bytecode[Bytecode.NEWCLASS=88]="NEWCLASS",Bytecode[Bytecode.GETDESCENDANTS=89]="GETDESCENDANTS",Bytecode[Bytecode.NEWCATCH=90]="NEWCATCH",Bytecode[Bytecode.FINDPROPSTRICT=93]="FINDPROPSTRICT",Bytecode[Bytecode.FINDPROPERTY=94]="FINDPROPERTY",Bytecode[Bytecode.FINDDEF=95]="FINDDEF",Bytecode[Bytecode.GETLEX=96]="GETLEX",Bytecode[Bytecode.SETPROPERTY=97]="SETPROPERTY",Bytecode[Bytecode.GETLOCAL=98]="GETLOCAL",Bytecode[Bytecode.SETLOCAL=99]="SETLOCAL",Bytecode[Bytecode.GETGLOBALSCOPE=100]="GETGLOBALSCOPE",Bytecode[Bytecode.GETSCOPEOBJECT=101]="GETSCOPEOBJECT",Bytecode[Bytecode.GETPROPERTY=102]="GETPROPERTY",Bytecode[Bytecode.GETOUTERSCOPE=103]="GETOUTERSCOPE",Bytecode[Bytecode.INITPROPERTY=104]="INITPROPERTY",Bytecode[Bytecode.UNUSED_69=105]="UNUSED_69",Bytecode[Bytecode.DELETEPROPERTY=106]="DELETEPROPERTY",Bytecode[Bytecode.UNUSED_6B=107]="UNUSED_6B",Bytecode[Bytecode.GETSLOT=108]="GETSLOT",Bytecode[Bytecode.SETSLOT=109]="SETSLOT",Bytecode[Bytecode.GETGLOBALSLOT=110]="GETGLOBALSLOT",Bytecode[Bytecode.SETGLOBALSLOT=111]="SETGLOBALSLOT",Bytecode[Bytecode.CONVERT_S=112]="CONVERT_S",Bytecode[Bytecode.ESC_XELEM=113]="ESC_XELEM",Bytecode[Bytecode.ESC_XATTR=114]="ESC_XATTR",Bytecode[Bytecode.CONVERT_I=115]="CONVERT_I",Bytecode[Bytecode.CONVERT_U=116]="CONVERT_U",Bytecode[Bytecode.CONVERT_D=117]="CONVERT_D",Bytecode[Bytecode.CONVERT_B=118]="CONVERT_B",Bytecode[Bytecode.CONVERT_O=119]="CONVERT_O",Bytecode[Bytecode.CHECKFILTER=120]="CHECKFILTER",Bytecode[Bytecode.CONVERT_F=121]="CONVERT_F",Bytecode[Bytecode.UNPLUS=122]="UNPLUS",Bytecode[Bytecode.CONVERT_F4=123]="CONVERT_F4",Bytecode[Bytecode.BC_7C=124]="BC_7C",Bytecode[Bytecode.BC_7D=125]="BC_7D",Bytecode[Bytecode.BC_7E=126]="BC_7E",Bytecode[Bytecode.BC_7F=127]="BC_7F",Bytecode[Bytecode.COERCE=128]="COERCE",Bytecode[Bytecode.COERCE_B=129]="COERCE_B",Bytecode[Bytecode.COERCE_A=130]="COERCE_A",Bytecode[Bytecode.COERCE_I=131]="COERCE_I",Bytecode[Bytecode.COERCE_D=132]="COERCE_D",Bytecode[Bytecode.COERCE_S=133]="COERCE_S",Bytecode[Bytecode.ASTYPE=134]="ASTYPE",Bytecode[Bytecode.ASTYPELATE=135]="ASTYPELATE",Bytecode[Bytecode.COERCE_U=136]="COERCE_U",Bytecode[Bytecode.COERCE_O=137]="COERCE_O",Bytecode[Bytecode.NEGATE=144]="NEGATE",Bytecode[Bytecode.INCREMENT=145]="INCREMENT",Bytecode[Bytecode.INCLOCAL=146]="INCLOCAL",Bytecode[Bytecode.DECREMENT=147]="DECREMENT",Bytecode[Bytecode.DECLOCAL=148]="DECLOCAL",Bytecode[Bytecode.TYPEOF=149]="TYPEOF",Bytecode[Bytecode.NOT=150]="NOT",Bytecode[Bytecode.BITNOT=151]="BITNOT",Bytecode[Bytecode.UNUSED_98=152]="UNUSED_98",Bytecode[Bytecode.UNUSED_99=153]="UNUSED_99",Bytecode[Bytecode.UNUSED_9A=154]="UNUSED_9A",Bytecode[Bytecode.UNUSED_9B=155]="UNUSED_9B",Bytecode[Bytecode.UNUSED_9C=156]="UNUSED_9C",Bytecode[Bytecode.UNUSED_9D=157]="UNUSED_9D",Bytecode[Bytecode.UNUSED_9E=158]="UNUSED_9E",Bytecode[Bytecode.UNUSED_9F=159]="UNUSED_9F",Bytecode[Bytecode.ADD=160]="ADD",Bytecode[Bytecode.SUBTRACT=161]="SUBTRACT",Bytecode[Bytecode.MULTIPLY=162]="MULTIPLY",Bytecode[Bytecode.DIVIDE=163]="DIVIDE",Bytecode[Bytecode.MODULO=164]="MODULO",Bytecode[Bytecode.LSHIFT=165]="LSHIFT",Bytecode[Bytecode.RSHIFT=166]="RSHIFT",Bytecode[Bytecode.URSHIFT=167]="URSHIFT",Bytecode[Bytecode.BITAND=168]="BITAND",Bytecode[Bytecode.BITOR=169]="BITOR",Bytecode[Bytecode.BITXOR=170]="BITXOR",Bytecode[Bytecode.EQUALS=171]="EQUALS",Bytecode[Bytecode.STRICTEQUALS=172]="STRICTEQUALS",Bytecode[Bytecode.LESSTHAN=173]="LESSTHAN",Bytecode[Bytecode.LESSEQUALS=174]="LESSEQUALS",Bytecode[Bytecode.GREATERTHAN=175]="GREATERTHAN",Bytecode[Bytecode.GREATEREQUALS=176]="GREATEREQUALS",Bytecode[Bytecode.INSTANCEOF=177]="INSTANCEOF",Bytecode[Bytecode.ISTYPE=178]="ISTYPE",Bytecode[Bytecode.ISTYPELATE=179]="ISTYPELATE",Bytecode[Bytecode.IN=180]="IN",Bytecode[Bytecode.UNUSED_B5=181]="UNUSED_B5",Bytecode[Bytecode.UNUSED_B6=182]="UNUSED_B6",Bytecode[Bytecode.UNUSED_B7=183]="UNUSED_B7",Bytecode[Bytecode.UNUSED_B8=184]="UNUSED_B8",Bytecode[Bytecode.UNUSED_B9=185]="UNUSED_B9",Bytecode[Bytecode.UNUSED_BA=186]="UNUSED_BA",Bytecode[Bytecode.UNUSED_BB=187]="UNUSED_BB",Bytecode[Bytecode.UNUSED_BC=188]="UNUSED_BC",Bytecode[Bytecode.UNUSED_BD=189]="UNUSED_BD",Bytecode[Bytecode.UNUSED_BE=190]="UNUSED_BE",Bytecode[Bytecode.UNUSED_BF=191]="UNUSED_BF",Bytecode[Bytecode.INCREMENT_I=192]="INCREMENT_I",Bytecode[Bytecode.DECREMENT_I=193]="DECREMENT_I",Bytecode[Bytecode.INCLOCAL_I=194]="INCLOCAL_I",Bytecode[Bytecode.DECLOCAL_I=195]="DECLOCAL_I",Bytecode[Bytecode.NEGATE_I=196]="NEGATE_I",Bytecode[Bytecode.ADD_I=197]="ADD_I",Bytecode[Bytecode.SUBTRACT_I=198]="SUBTRACT_I",Bytecode[Bytecode.MULTIPLY_I=199]="MULTIPLY_I",Bytecode[Bytecode.UNUSED_C8=200]="UNUSED_C8",Bytecode[Bytecode.UNUSED_C9=201]="UNUSED_C9",Bytecode[Bytecode.UNUSED_CA=202]="UNUSED_CA",Bytecode[Bytecode.UNUSED_CB=203]="UNUSED_CB",Bytecode[Bytecode.UNUSED_CC=204]="UNUSED_CC",Bytecode[Bytecode.UNUSED_CD=205]="UNUSED_CD",Bytecode[Bytecode.UNUSED_CE=206]="UNUSED_CE",Bytecode[Bytecode.UNUSED_CF=207]="UNUSED_CF",Bytecode[Bytecode.GETLOCAL0=208]="GETLOCAL0",Bytecode[Bytecode.GETLOCAL1=209]="GETLOCAL1",Bytecode[Bytecode.GETLOCAL2=210]="GETLOCAL2",Bytecode[Bytecode.GETLOCAL3=211]="GETLOCAL3",Bytecode[Bytecode.SETLOCAL0=212]="SETLOCAL0",Bytecode[Bytecode.SETLOCAL1=213]="SETLOCAL1",Bytecode[Bytecode.SETLOCAL2=214]="SETLOCAL2",Bytecode[Bytecode.SETLOCAL3=215]="SETLOCAL3",Bytecode[Bytecode.UNUSED_D8=216]="UNUSED_D8",Bytecode[Bytecode.UNUSED_D9=217]="UNUSED_D9",Bytecode[Bytecode.UNUSED_DA=218]="UNUSED_DA",Bytecode[Bytecode.UNUSED_DB=219]="UNUSED_DB",Bytecode[Bytecode.UNUSED_DC=220]="UNUSED_DC",Bytecode[Bytecode.UNUSED_DD=221]="UNUSED_DD",Bytecode[Bytecode.UNUSED_DE=222]="UNUSED_DE",Bytecode[Bytecode.UNUSED_DF=223]="UNUSED_DF",Bytecode[Bytecode.UNUSED_E0=224]="UNUSED_E0",Bytecode[Bytecode.UNUSED_E1=225]="UNUSED_E1",Bytecode[Bytecode.UNUSED_E2=226]="UNUSED_E2",Bytecode[Bytecode.UNUSED_E3=227]="UNUSED_E3",Bytecode[Bytecode.UNUSED_E4=228]="UNUSED_E4",Bytecode[Bytecode.UNUSED_E5=229]="UNUSED_E5",Bytecode[Bytecode.UNUSED_E6=230]="UNUSED_E6",Bytecode[Bytecode.UNUSED_E7=231]="UNUSED_E7",Bytecode[Bytecode.UNUSED_E8=232]="UNUSED_E8",Bytecode[Bytecode.UNUSED_E9=233]="UNUSED_E9",Bytecode[Bytecode.UNUSED_EA=234]="UNUSED_EA",Bytecode[Bytecode.UNUSED_EB=235]="UNUSED_EB",Bytecode[Bytecode.UNUSED_EC=236]="UNUSED_EC",Bytecode[Bytecode.UNUSED_ED=237]="UNUSED_ED",Bytecode[Bytecode.UNUSED_EE=238]="UNUSED_EE",Bytecode[Bytecode.INVALID=237]="INVALID",Bytecode[Bytecode.false=239]="false",Bytecode[Bytecode.falseLINE=240]="falseLINE",Bytecode[Bytecode.falseFILE=241]="falseFILE",Bytecode[Bytecode.BKPTLINE=242]="BKPTLINE",Bytecode[Bytecode.TIMESTAMP=243]="TIMESTAMP",Bytecode[Bytecode.RESTARGC=244]="RESTARGC",Bytecode[Bytecode.RESTARG=245]="RESTARG",Bytecode[Bytecode.UNUSED_F6=246]="UNUSED_F6",Bytecode[Bytecode.UNUSED_F7=247]="UNUSED_F7",Bytecode[Bytecode.UNUSED_F8=248]="UNUSED_F8",Bytecode[Bytecode.UNUSED_F9=249]="UNUSED_F9",Bytecode[Bytecode.UNUSED_FA=250]="UNUSED_FA",Bytecode[Bytecode.UNUSED_FB=251]="UNUSED_FB",Bytecode[Bytecode.UNUSED_FC=252]="UNUSED_FC",Bytecode[Bytecode.UNUSED_FD=253]="UNUSED_FD",Bytecode[Bytecode.UNUSED_FE=254]="UNUSED_FE",Bytecode[Bytecode.END=255]="END"}(Bytecode||(Bytecode={}));const OpcodeParam={[Bytecode.KILL]:"3",[Bytecode.IFNLT]:"2",[Bytecode.IFNGT]:"2",[Bytecode.IFNGE]:"2",[Bytecode.JUMP]:"2",[Bytecode.IFTRUE]:"2",[Bytecode.IFFALSE]:"2",[Bytecode.IFEQ]:"2",[Bytecode.IFNE]:"2",[Bytecode.IFLT]:"2",[Bytecode.IFLE]:"2",[Bytecode.IFGT]:"2",[Bytecode.IFGE]:"2",[Bytecode.LOOKUPSWITCH]:"LOOKUPSWITCH",[Bytecode.PUSHBYTE]:"8",[Bytecode.PUSHSHORT]:"3",[Bytecode.PUSHSTRING]:"3",[Bytecode.PUSHINT]:"3",[Bytecode.PUSHUINT]:"3",[Bytecode.PUSHNAMESPACE]:"3",[Bytecode.HASNEXT2]:"33",[Bytecode.NEWFUNCTION]:"3",[Bytecode.CALL]:"3",[Bytecode.CONSTRUCT]:"3",[Bytecode.CONSTRUCTSUPER]:"3",[Bytecode.CONSTRUCTPROP]:"33",[Bytecode.CALLSUPER]:"33",[Bytecode.CALLSUPERVOID]:"33",[Bytecode.CALLPROPLEX]:"33",[Bytecode.CALLPROPERTY]:"33",[Bytecode.CALLPROPVOID]:"33",[Bytecode.APPLYTYPE]:"3",[Bytecode.NEWOBJECT]:"3",[Bytecode.NEWARRAY]:"3",[Bytecode.NEWCLASS]:"3",[Bytecode.GETDESCENDANTS]:"3",[Bytecode.NEWCATCH]:"3",[Bytecode.FINDPROPERTY]:"3",[Bytecode.FINDPROPSTRICT]:"3",[Bytecode.FINDDEF]:"3",[Bytecode.GETLEX]:"3",[Bytecode.INITPROPERTY]:"3",[Bytecode.SETPROPERTY]:"3",[Bytecode.GETLOCAL]:"3",[Bytecode.SETLOCAL]:"3",[Bytecode.GETSCOPEOBJECT]:"3",[Bytecode.GETPROPERTY]:"3",[Bytecode.DELETEPROPERTY]:"3",[Bytecode.GETSLOT]:"3",[Bytecode.SETSLOT]:"3",[Bytecode.COERCE]:"3",[Bytecode.INCLOCAL_I]:"3",[Bytecode.DECLOCAL_I]:"3",[Bytecode.false]:"33",[Bytecode.falseLINE]:"3",[Bytecode.falseFILE]:"3"},QName$1=7,RTQNameL$1=17,RTQNameLA$1=18;var MethodFlags$1;!function(MethodFlags){MethodFlags[MethodFlags.NEED_ARGUMENTS=1]="NEED_ARGUMENTS",MethodFlags[MethodFlags.NEED_ACTIVATION=2]="NEED_ACTIVATION",MethodFlags[MethodFlags.NEED_REST=4]="NEED_REST",MethodFlags[MethodFlags.HAS_OPTIONAL=8]="HAS_OPTIONAL",MethodFlags[MethodFlags.Native=32]="Native",MethodFlags[MethodFlags.SET_DXNS=64]="SET_DXNS",MethodFlags[MethodFlags.HAS_PARAM_NAMES=128]="HAS_PARAM_NAMES"}(MethodFlags$1||(MethodFlags$1={}));var ConstantKind$1;!function(ConstantKind){ConstantKind[ConstantKind.Int=3]="Int",ConstantKind[ConstantKind.UInt=4]="UInt",ConstantKind[ConstantKind.Double=6]="Double",ConstantKind[ConstantKind.Utf8=1]="Utf8",ConstantKind[ConstantKind.True=11]="True",ConstantKind[ConstantKind.False=10]="False",ConstantKind[ConstantKind.Null=12]="Null",ConstantKind[ConstantKind.Undefined=0]="Undefined",ConstantKind[ConstantKind.Namespace=8]="Namespace",ConstantKind[ConstantKind.PackageNamespace=22]="PackageNamespace",ConstantKind[ConstantKind.PackageInternalNs=23]="PackageInternalNs",ConstantKind[ConstantKind.ProtectedNamespace=24]="ProtectedNamespace",ConstantKind[ConstantKind.ExplicitNamespace=25]="ExplicitNamespace",ConstantKind[ConstantKind.StaticProtectedNs=26]="StaticProtectedNs",ConstantKind[ConstantKind.PrivateNs=5]="PrivateNs"}(ConstantKind$1||(ConstantKind$1={}));var NamespaceType$1;!function(NamespaceType){NamespaceType[NamespaceType.Public=0]="Public",NamespaceType[NamespaceType.Protected=1]="Protected",NamespaceType[NamespaceType.PackageInternal=2]="PackageInternal",NamespaceType[NamespaceType.Private=3]="Private",NamespaceType[NamespaceType.Explicit=4]="Explicit",NamespaceType[NamespaceType.StaticProtected=5]="StaticProtected"}(NamespaceType$1||(NamespaceType$1={}));var TRAIT$1;!function(TRAIT){TRAIT[TRAIT.Slot=0]="Slot",TRAIT[TRAIT.Method=1]="Method",TRAIT[TRAIT.Getter=2]="Getter",TRAIT[TRAIT.Setter=3]="Setter",TRAIT[TRAIT.Class=4]="Class",TRAIT[TRAIT.Function=5]="Function",TRAIT[TRAIT.Const=6]="Const",TRAIT[TRAIT.GetterSetter=7]="GetterSetter"}(TRAIT$1||(TRAIT$1={}));var ATTR$1;!function(ATTR){ATTR[ATTR.Final=1]="Final",ATTR[ATTR.Override=2]="Override",ATTR[ATTR.Metadata=4]="Metadata"}(ATTR$1||(ATTR$1={}));var InstanceFlags$1;!function(InstanceFlags){InstanceFlags[InstanceFlags.ClassSealed=1]="ClassSealed",InstanceFlags[InstanceFlags.ClassFinal=2]="ClassFinal",InstanceFlags[InstanceFlags.ClassInterface=4]="ClassInterface",InstanceFlags[InstanceFlags.ClassProtectedNs=8]="ClassProtectedNs"}(InstanceFlags$1||(InstanceFlags$1={}));let Errors={NotImplementedError:{code:1001,message:"The method %1 is not implemented."},InvalidPrecisionError:{code:1002,message:"Number.toPrecision has a range of 1 to 21. Number.toFixed and Number.toExponential have a range of 0 to 20. Specified value is not within expected range."},InvalidRadixError:{code:1003,message:"The radix argument must be between 2 and 36; got %1."},InvokeOnIncompatibleObjectError:{code:1004,message:"Method %1 was invoked on an incompatible object."},ArrayIndexNotIntegerError:{code:1005,message:"Array index is not a positive integer (%1)."},CallOfNonFunctionError:{code:1006,message:"%1 is not a function."},ConstructOfNonFunctionError:{code:1007,message:"Instantiation attempted on a non-constructor."},ConvertNullToObjectError:{code:1009,message:"Cannot access a property or method of a null object reference."},ConvertUndefinedToObjectError:{code:1010,message:"A term is undefined and has no properties."},ClassNotFoundError:{code:1014,message:"Class %1 could not be found."},DescendentsError:{code:1016,message:"Descendants operator (..) not supported on type %1."},StackOverflowError:{code:1023,message:"Stack overflow occurred."},CpoolIndexRangeError:{code:1032,message:"Cpool index %1 is out of range %2."},CpoolEntryWrongTypeError:{code:1033,message:"Cpool entry %1 is wrong type."},CheckTypeFailedError:{code:1034,message:"Type Coercion failed: cannot convert %1 to %2."},CannotAssignToMethodError:{code:1037,message:"Cannot assign to a method %1 on %2."},CantUseInstanceofOnNonObjectError:{code:1040,message:"The right-hand side of instanceof must be a class or function."},IsTypeMustBeClassError:{code:1041,message:"The right-hand side of operator must be a class."},InvalidMagicError:{code:1042,message:"Not an ABC file.  major_version=%1 minor_version=%2."},UnsupportedTraitsKindError:{code:1045,message:"Unsupported traits kind=%1."},PrototypeTypeError:{code:1049,message:"Prototype objects must be vanilla Objects."},ConvertToPrimitiveError:{code:1050,message:"Cannot convert %1 to primitive."},InvalidURIError:{code:1052,message:"Invalid URI passed to %1 function."},WriteSealedError:{code:1056,message:"Cannot create property %1 on %2."},WrongArgumentCountError:{code:1063,message:"Argument count mismatch on %1. Expected %2, got %3."},UndefinedVarError:{code:1065,message:"Variable %1 is not defined."},ReadSealedError:{code:1069,message:"Property %1 not found on %2 and there is no default value."},ConstWriteError:{code:1074,message:"Illegal write to read-only property %1 on %2."},XMLPrefixNotBound:{code:1083,message:"The prefix '%1' for element '%2' is not bound."},XMLUnterminatedElementTag:{code:1085,message:"The element type '%1' must be terminated by the matching end-tag '</%2>'."},XMLOnlyWorksWithOneItemLists:{code:1086,message:"The %1 method only works on lists containing one item."},XMLAssignmentToIndexedXMLNotAllowed:{code:1087,message:"Assignment to indexed XML is not allowed."},XMLMarkupMustBeWellFormed:{code:1088,message:"The markup in the document following the root element must be well-formed."},XMLAssigmentOneItemLists:{code:1089,message:"Assignment to lists with more than one item is not supported."},XMLMalformedElement:{code:1090,message:"XML parser failure: element is malformed."},XMLUnterminatedCData:{code:1091,message:"XML parser failure: Unterminated CDATA section."},XMLUnterminatedXMLDecl:{code:1092,message:"XML parser failure: Unterminated XML declaration."},XMLUnterminatedDocTypeDecl:{code:1093,message:"XML parser failure: Unterminated DOCTYPE declaration."},XMLUnterminatedComment:{code:1094,message:"XML parser failure: Unterminated comment."},XMLUnterminatedElement:{code:1096,message:"XML parser failure: Unterminated element."},XMLNamespaceWithPrefixAndNoURI:{code:1098,message:"Illegal prefix %1 for no namespace."},RegExpFlagsArgumentError:{code:1100,message:"Cannot supply flags when constructing one RegExp from another."},InvalidBaseClassError:{code:1108,message:"The OP_newclass opcode was used with the incorrect base class."},XMLInvalidName:{code:1117,message:"Invalid XML name: %1."},XMLIllegalCyclicalLoop:{code:1118,message:"Illegal cyclical loop between nodes."},FilterError:{code:1123,message:"Filter operator not supported on type %1."},OutOfRangeError:{code:1125,message:"The index %1 is out of range %2."},VectorFixedError:{code:1126,message:"Cannot change the length of a fixed Vector."},TypeAppOfNonParamType:{code:1127,message:"Type application attempted on a non-parameterized type."},WrongTypeArgCountError:{code:1128,message:"Incorrect number of type parameters for %1. Expected %2, got %3."},JSONCyclicStructure:{code:1129,message:"Cyclic structure cannot be converted to JSON string."},JSONInvalidReplacer:{code:1131,message:"Replacer argument to JSON stringifier must be an array or a two parameter function."},JSONInvalidParseInput:{code:1132,message:"Invalid JSON parse input."},InvalidRangeError:{code:1506,message:"The specified range is invalid."},NullArgumentError:{code:1507,message:"Argument %1 cannot be null."},InvalidArgumentError:{code:1508,message:"The value specified for argument %1 is invalid."},ArrayFilterNonNullObjectError:{code:1510,message:"When the callback argument is a method of a class, the optional this argument must be null."},InvalidParamError:{code:2004,message:"One of the parameters is invalid."},ParamRangeError:{code:2006,message:"The supplied index is out of bounds."},NullPointerError:{code:2007,message:"Parameter %1 must be non-null."},InvalidEnumError:{code:2008,message:"Parameter %1 must be one of the accepted values."},CantInstantiateError:{code:2012,message:"%1 class cannot be instantiated."},InvalidBitmapData:{code:2015,message:"Invalid BitmapData."},EOFError:{code:2030,message:"End of file was encountered.",fqn:"flash.errors.EOFError"},CompressedDataError:{code:2058,message:"There was an error decompressing the data.",fqn:"flash.errors.IOError"},EmptyStringError:{code:2085,message:"Parameter %1 must be non-empty string."},ProxyGetPropertyError:{code:2088,message:"The Proxy class does not implement getProperty. It must be overridden by a subclass."},ProxySetPropertyError:{code:2089,message:"The Proxy class does not implement setProperty. It must be overridden by a subclass."},ProxyCallPropertyError:{code:2090,message:"The Proxy class does not implement callProperty. It must be overridden by a subclass."},ProxyHasPropertyError:{code:2091,message:"The Proxy class does not implement hasProperty. It must be overridden by a subclass."},ProxyDeletePropertyError:{code:2092,message:"The Proxy class does not implement deleteProperty. It must be overridden by a subclass."},ProxyGetDescendantsError:{code:2093,message:"The Proxy class does not implement getDescendants. It must be overridden by a subclass."},ProxyNextNameIndexError:{code:2105,message:"The Proxy class does not implement nextNameIndex. It must be overridden by a subclass."},ProxyNextNameError:{code:2106,message:"The Proxy class does not implement nextName. It must be overridden by a subclass."},ProxyNextValueError:{code:2107,message:"The Proxy class does not implement nextValue. It must be overridden by a subclass."},TooFewArgumentsError:{code:2001,message:"Too few arguments were specified; got %1, %2 expected."},ParamTypeError:{code:2005,message:"Parameter %1 is of the incorrect type. Should be type %2."},SocketConnectError:{code:2011,message:"Socket connection failed to %1:%2."},CantAddSelfError:{code:2024,message:"An object cannot be added as a child of itself."},NotAChildError:{code:2025,message:"The supplied DisplayObject must be a child of the caller."},UnhandledError:{code:2044,message:"Unhandled %1:."},FileVerificationError:{code:2046,message:"The loaded file did not have a valid signature."},AllowDomainArgumentError:{code:2052,message:"Only String arguments are permitted for allowDomain and allowInsecureDomain."},DelayRangeError:{code:2066,message:"The Timer delay specified is out of range."},ExternalInterfaceNotAvailableError:{code:2067,message:"The ExternalInterface is not available in this container. ExternalInterface requires Internet Explorer ActiveX, Firefox, Mozilla 1.7.5 and greater, or other browsers that support NPRuntime."},InvalidLoaderMethodError:{code:2069,message:"The Loader class does not implement this method."},InvalidStageMethodError:{code:2071,message:"The Stage class does not implement this property or method."},TimelineObjectNameSealedError:{code:2078,message:"The name property of a Timeline-placed object cannot be modified."},AlreadyConnectedError:{code:2082,message:"Connect failed because the object is already connected."},CloseNotConnectedError:{code:2083,message:"Close failed because the object is not connected."},ArgumentSizeError:{code:2084,message:"The AMF encoding of the arguments cannot exceed 40K."},AsyncError:{code:2095,message:"%1 was unable to invoke callback %2."},LoadingObjectNotSWFError:{code:2098,message:"The loading object is not a .swf file, you cannot request SWF properties from it."},LoadingObjectNotInitializedError:{code:2099,message:"The loading object is not sufficiently loaded to provide this information."},DecodeParamError:{code:2101,message:"The String passed to URLVariables.decode() must be a URL-encoded query string containing name/value pairs."},SceneNotFoundError:{code:2108,message:"Scene %1 was not found."},FrameLabelNotFoundError:{code:2109,message:"Frame label %1 not found in scene %2."},InvalidLoaderInfoMethodError:{code:2118,message:"The LoaderInfo class does not implement this method."},SecuritySwfNotAllowedError:{code:2121,message:"Security sandbox violation: %1: %2 cannot access %3. This may be worked around by calling Security.allowDomain."},UnknownFileTypeError:{code:2124,message:"Loaded file is an unknown type."},CantAddParentError:{code:2150,message:"An object cannot be added as a child to one of it's children (or children's children, etc.)."},Matrix3DRefCannontBeShared:{code:2189,message:"A Matrix3D can not be assigned to more than one DisplayObject."},ObjectWithStringsParamError:{code:2196,message:"Parameter %1 must be an Object with only String values."},AllowCodeImportError:{code:3226,message:"Cannot import a SWF file when LoaderContext.allowCodeImport is false."},PermissionDenied:{code:3315,message:"The current security context does not allow this operation."},InternalErrorIV:{code:3343,message:"Internal Error."}};for(let k in Errors){let error=Errors[k];error.typeName=k,Errors[error.code]=error}const logger$5=new Logger("Runtime");var ScriptInfoState;!function(ScriptInfoState){ScriptInfoState[ScriptInfoState.None=0]="None",ScriptInfoState[ScriptInfoState.Executing=1]="Executing",ScriptInfoState[ScriptInfoState.Executed=2]="Executed"}(ScriptInfoState||(ScriptInfoState={}));const scriptRuntime=new WeakMap,vectorTypes=new WeakMap;class ApplicationDomain$$1{constructor(sec,parent){this.sec=sec,this.parent=parent,this.system=parent?parent.system:this,this.abcs=[],this.triatMethod=this.methodActivation=this.catchScope=new WeakMap,this.findPropertyCache=new Map,this.scriptNameMap=new Map}loadABC(abc){if(-1===this.abcs.indexOf(abc)){abc.app=this;for(let script of abc.script){scriptRuntime.set(script,{state:ScriptInfoState.None,global:null});const map=this.scriptNameMap;for(let trait of script.trait){const name=trait.name.name;map.has(name)||map.set(name,[]),map.get(name).push(script)}}this.abcs.push(abc)}}findProperty(mn,strict,execute){const cache=this.findPropertyCache;let script=cache.get(mn.mangledName);return script||(script=this.findDefiningScript(mn,execute),cache.set(mn.mangledName,script)),script?scriptRuntime.get(script).global:null}getClass(mn){return this.getProperty(mn,!0,!0)}getProperty(mn,strict,execute){if(!mn)return null;let global=this.findProperty(mn,strict,execute);return global?global.axGetProperty(mn):null}findDefiningScript(mn,execute){if(this.parent){let script=this.parent.findDefiningScript(mn,execute);if(script)return script}const scripts=this.scriptNameMap.get(mn.name);if(!scripts)return null;for(let script of scripts){const runtimeScript=scriptRuntime.get(script);if(script.trait.getTrait(mn))return this.prepareGlobal(script),execute&&runtimeScript.state===ScriptInfoState.None&&this.executeScript(script),script}return null}prepareGlobal(script){let runtimeScript=scriptRuntime.get(script);if(runtimeScript.global)return;let global=this.createGlobal(script);runtimeScript.global=global}executeScript(script){script.abc.app;this.prepareGlobal(script);script.init;let runtimeScript=scriptRuntime.get(script),global=runtimeScript.global;return runtimeScript.state=ScriptInfoState.Executing,this.sec.flashEmu.interpreter.interpret(global,script.init,global.scope,[],null),runtimeScript.state=ScriptInfoState.Executed,global}createGlobal(script){const AXGlobalClass=new AXClass(this,null);AXGlobalClass.name=`ScriptGlobal${script.getID()}`;let global=new class extends AXGlobalBase{constructor(app){super(AXGlobalClass,app)}}(this);return applyTraits(global,script.trait,global.scope),global}throwError(type,error,...args){let message=error.message;message=error.message.replace(/%(\d)/,(_,i)=>args[i-1]);let errType=this.getClass(Multiname.Public(type));throw new ErrorWrapper(errType.axNew(message))}createClass(newCls,superCls,scope){const meta=newCls.holderMeta.filter(m=>"native"===m.name)[0],interpreter=this.sec.flashEmu.interpreter,instance=newCls.getInstance();let axClass;axClass=meta?getNativeAXClass(this,meta.get("cls"),superCls):new AXClass(this,superCls);let classScope=new Scope(scope,axClass);axClass.classInfo=newCls,axClass.applyClass(newCls,classScope),axClass instanceof AXNativeClass&&axClass.native&&axClass.native._onPrototype&&axClass.native._onPrototype(axClass.prototype,axClass);let nativeClass=null;for(let cur=axClass;cur;cur=cur.superCls)if(cur instanceof AXNativeClass&&"ObjectClass"!==cur.nativeName){nativeClass=cur;break}const construct=!!meta;return axClass.iinit=construct?function(...args){if(this instanceof AXObject){let self=this;self.native||(self.native=newNativeInstance(this,meta.get("cls"),...args))}else logger$5.error(`iinit's this is not instanceof AXObject`)}:function(...args){let self=this;nativeClass&&!self.native&&(self.native=newNativeInstance(this,nativeClass.nativeName));const bin=this.axClass.bin;return bin&&(self.native.buf=bin.slice(0,bin.byteLength)),interpreter.interpret(this,instance.iinit,classScope,args,null)},isEmptyMethod(newCls.cinit.getBody().code)||interpreter.interpret(axClass,newCls.cinit,classScope,[axClass],null),axClass}createActivation(methodInfo,scope){const body=methodInfo.getBody();let actClass=this.methodActivation.get(methodInfo);actClass||(actClass=new AXClass(this));let act=actClass.axNew();return applyTraits(act,body.trait,scope),act}createCatch(exceptionInfo,scope){let catClass=this.catchScope.get(exceptionInfo);catClass||(catClass=new AXClass(this));let cat=catClass.axNew();return applyTraits(cat,exceptionInfo.getTrait(),scope),cat}createMethodForTrait(trait,scope){let methodTraitInfo=trait.data,method=this.triatMethod.get(methodTraitInfo);if(method)return method;let methodInfo=methodTraitInfo.method;if(methodInfo.isNative()){const parent=trait.holder;if(parent instanceof ClassInfo)method=getMethodOrAccessorNative(this,trait);else if(parent instanceof InstanceInfo)method=getMethodOrAccessorNative(this,trait);else if(parent instanceof ScriptInfo){const meta=trait.metadata&&trait.metadata.filter(m=>"native"===m.name);if(1!==meta.length)throw new Error(`Native global function don't have metadata`);(method=getNativeFunction(this,meta[0].value))||logger$5.error(`Native function ${meta[0].value} not found`)}else logger$5.error("Unknown type of trait holder")}else method=this.sec.createFunction(methodInfo,scope);return this.triatMethod.set(methodTraitInfo,method),method}applyType(axClass,types){1!==types.length&&this.throwError("TypeError",Errors.WrongTypeArgCountError,"__AS3__.vec::Vector",1,types.length);let vType=vectorTypes.get(types[0]);if(!vType){const VectorObject=this.getClass(Multiname.PackageInternal("__AS3__.vec","Vector$object"));(vType=new AXClass(this,VectorObject)).name=`Vector.<${types.map(i=>i.name).join(", ")}>`,vType.applyClass(null,null),vectorTypes.set(types[0],vType)}return vType}}class SecurityDomain$$1{constructor(flashEmu){this.flashEmu=flashEmu,this.system=new ApplicationDomain$$1(this,null),this.apps=[this.system],this.vectorClasses=new WeakMap,this.AXClass=getNativeAXClass(this.system,"Class",null),this.AXClass.axClass=this.AXClass,this.AXObject=getNativeAXClass(this.system,"ObjectClass",null),this.AXObject.iinit=(()=>null),this.AXString=getNativeAXClass(this.system,"StringClass",this.AXObject),this.AXArray=getNativeAXClass(this.system,"ArrayClass",this.AXObject)}onBuiltinLoaded(){this.system}createApplicationDomain(parent){if(parent=parent||this.system,!this.apps.includes(parent))throw new Error("createApplicationDomain parent domain should be in sec domain");let app=new ApplicationDomain$$1(this,parent);return this.apps.push(app),app}createFunction(methodInfo,scope,hasDynamicScope){const interpreter=this.flashEmu.interpreter;let axFunc;return axFunc=wrapFunction(this,function(...args){return interpreter.interpret(this,methodInfo,scope,args,axFunc)})}box(v){return void 0==v?v:v instanceof AXObject?v:v instanceof Array?this.AXArray.axBox(v):"string"==typeof v?this.AXString.axBox(v):void 0}}class Scope{constructor(parent,object,isWith=!1){this.parent=parent,this.object=object,this.isWith=isWith,this.global=parent?parent.global:this,this.cache=new Map}getScopeProperty(mn,strict,scopeOnly){return this.findScopeProperty(mn,strict,scopeOnly).axGetProperty(mn)}findScopeProperty(mn,strict,scopeOnly){let object;if(!scopeOnly&&!mn.isRuntime()&&(object=this.cache.get(mn.mangledName)))return object;if(this.object&&(this.isWith?this.object.axHasPropertyInternal(mn):this.object.traits.getTrait(mn.nsSet,mn.name)))return this.object;if(this.parent)return object=this.parent.findScopeProperty(mn,strict,scopeOnly),mn.kind===QName$1&&this.cache.set(mn.mangledName,object),object;if(scopeOnly)return null;const globalObject=this.global.object;return mn.isAttribute()&&globalObject.app.throwError("ReferenceError",Errors.UndefinedletError,mn.nsSet[0].uri+"."+mn.name),(object=globalObject.app.findProperty(mn,strict,!0))?object:(strict&&(globalObject.has(Multiname.PublicMangledName(mn.name))||globalObject.app.throwError("ReferenceError",Errors.UndefinedVarError,mn.nsSet[0].uri+"."+mn.name)),globalObject)}}class ErrorWrapper{constructor(error){this.error=error}}const wrapedFunction=new WeakMap;let now,funcTable=new Map,startStack=new Map;now="undefined"!=typeof performance?()=>performance.now()/1e3:"undefined"!=typeof process?()=>{const r=process.hrtime();return 1e3*r[0]+r[1]/1e6}:()=>(new Date).getTime();const logger$4=new Logger("Base");class AXObject{constructor(axClass){this.axClass=axClass,this.dynamic=!1,this.val=new Map,axClass&&(this.app=axClass.app,this._proto=axClass.prototype,this.traits=new RuntimeTraits(this._proto&&this._proto.traits))}static __axNew(axClass){return new AXObject(axClass)}get(key,self=this){if(!this.val.has(key)&&this._proto)return this._proto.get(key,self);if(this.val.has(key)){let desc=this.val.get(key);return desc.get?desc.get.call(self):desc.value}const desc=this.val.get(key);return desc&&desc.value}setDescriptor(key,descriptor){let desc=this.get(key);if(!desc)throw new Error("not found");desc=Object.assign(desc,descriptor),this.val.set(key,desc)}set(key,val,self=this){if(!this.val.has(key)&&this._proto)return this._proto.set(key,val,self);if(this.val.has(key)){let desc=this.val.get(key);if(desc.set)return desc.set.call(self,val);let nd={configurable:desc.configurable,enumerable:desc.enumerable,value:val,writable:desc.writable,get:desc.get,set:desc.set};self.val.set(key,nd)}else this.val.set(key,{value:val})}has(key){return!this.val.has(key)&&this._proto?this._proto.has(key):this.val.has(key)}axIsPrototypeOf(v){for(let cur=v._proto;cur;cur=cur._proto)if(cur===this)return!0;return!1}axResolveMultiname(mn){let name=mn.name;if("number"==typeof name)return+name;let t=this.traits.getTrait(mn.nsSet,name);return t?t.name.mangledName:Multiname.PublicMangledName(name)}axCallProperty(mn,args,isLex){const name=this.axResolveMultiname(mn);let func=this.get(name);func instanceof AXNativeObject&&(func=func.native);const hookFunc=this.app.sec.flashEmu.hooks.get(mn.name);if(hookFunc&&(func=hookFunc.callback),func)return func.call(this,...args);throw new Error("axCallProperty: could not found Method: "+name)}callProperty(publicName,...args){return this.axCallProperty(Multiname.Public(publicName),args,!0)}axSetSlot(index,value){let trait=this.traits.slots[index];this.set(trait.name.mangledName,value)}axGetSlot(index){let t=this.traits.slots[index];return this.get(t.name.mangledName)}axHasPropertyInternal(mn){return!!this.traits.getTrait(mn.nsSet,mn.name)||void 0!==this.get(mn.mangledName)}axGetProperty(mn){let name=this.axResolveMultiname(mn),value=this.get(name);return value instanceof Function&&(value=wrapFunction(this.app.sec,value.bind(this))),value}axDeleteProperty(mn){let name=axCoerceName(mn.name);return!this.traits.getTrait(mn.nsSet,name)&&this.val.delete(Multiname.PublicMangledName(mn.name))}axSetProperty(mn,value,isInit){let mangledName,name=mn.name,freeze=!1,t=this.traits.getTrait(mn.nsSet,name);const app=this.axClass.app;if(t){switch(mangledName=t.name.mangledName,t.kind){case TRAIT.Method:app.throwError("ReferenceError",Errors.CannotAssignToMethodError,name,this.axClass.name);break;case TRAIT.Getter:app.throwError("ReferenceError",Errors.ConstWriteError,name,this.axClass.name);break;case TRAIT.Class:case TRAIT.Const:isInit||app.throwError("ReferenceError",Errors.ConstWriteError,name,this.axClass.name),freeze=!0}let type=this.app.getClass(t.typeName);type&&(value=type.axCoerce(value))}else mangledName="number"==typeof name?name:Multiname.PublicMangledName(name);this.set(mangledName,value)}setProperty(publicName,value){return this.axSetProperty(Multiname.Public(publicName),value,!1)}axConstructProperty(mn,args){let name=this.axResolveMultiname(mn);return this.get(name).axNew(...args)}axCallSuper(mn,scope,...args){let name=this.axResolveMultiname(mn),func=this.superObject.get(name);if(func)return func.call(this,...args);throw new Error("axCallProperty: could not found Method: "+name)}axGetEnumerableKeys(){let keys=[];for(let key of this.val.keys()){if("number"==typeof key){keys.push(key.toString());continue}let name=Multiname.stripPublicMangledName(key);name&&keys.push(name)}return keys}}class AXNativeObject extends AXObject{static __axNew(axClass){return new AXNativeObject(axClass)}}class AXDynamicNativeObject extends AXNativeObject{static __axNew(axClass){return new AXDynamicNativeObject(axClass)}get(key,self){return this.native.dynamic_shouldHandle(key)?this.native.dynamic_get(key):super.get(key,self)}set(key,val){this.native.dynamic_shouldHandle(key)&&this.native.dynamic_set(key,val),super.set(key,val)}has(key){return this.native.dynamic_shouldHandle(key)?this.native.dynamic_has(key):super.has(key)}axGetEnumerableKeys(){return this.native.dynamic_keys?this.native.dynamic_keys():super.axGetEnumerableKeys()}}class AXClass extends AXObject{constructor(app,superCls){super(app.sec.AXClass),this.app=app,this.superCls=superCls,this.name=null,this.axObjectCtor=superCls?superCls.axObjectCtor:AXObject}setName(n){const name=n.nsSet[0].uri+"."+n.name;if(null!==this.name)return;const bin=this.app.sec.flashEmu.binaryData.get(name);bin&&(this.bin=bin),this.name=name}applyClass(classInfo,scope){let prototype=this.app.sec.AXObject.axNew();if(this.traits=new RuntimeTraits(null),prototype.traits=new RuntimeTraits(this.superCls&&this.superCls.prototype.traits),prototype._proto=this.superCls&&this.superCls.prototype,this.prototype=prototype,classInfo){const instInfo=classInfo.getInstance();applyTraits(this,classInfo.trait,scope),applyTraits(prototype,instInfo.trait,scope)}}axCoerce(v){return v}axNew(...args){let self=this.axObjectCtor.__axNew(this);return this._axNew(self,...args),self}axSuperNew(self,...args){const superClass=this.superCls;superClass&&superClass._axNew(self,...args)}axIsType(x){return!(!x||"object"!=typeof x)&&this.prototype.axIsPrototypeOf(x)}_axNew(self,...args){return this.iinit?this.iinit.call(self,...args):this.axSuperNew(self,...args),self}}class AXNativeClass extends AXClass{constructor(app,nativeCls,nativeName,superCls){super(app,superCls),this.nativeName=nativeName,nativeCls?this.native=new nativeCls(this):logger$4.warn("Native class ctor error "+nativeName),this.axObjectCtor=AXNativeObject}axCoerce(v){return this.native&&this.native.axCoerce?this.native.axCoerce(v,this):super.axCoerce(v)}axBox(v){if(this.native&&this.native.axBox)return this.native.axBox(v,this);throw new Error("Can not box"+v)}}class AXDynamicNativeClass extends AXNativeClass{constructor(app,nativeCls,nativeName,superCls){super(app,nativeCls,nativeName,superCls),this.axObjectCtor=AXDynamicNativeObject}}class AXGlobalBase extends AXObject{constructor(axClass,app){super(axClass),this.scope=new Scope(null,this)}}const logger$6=new Logger("Native");let nativeIsDynamic=new WeakMap,nativeFunctions=new Map,nativeClasses=new Map,secNative=new WeakMap,nativeFuncClsNameMap=new WeakMap;class DynamicPassError extends Error{}new DynamicPassError;class NativeFuncClass{constructor(app){this.app=app}}const trace=new Logger("Trace");new Logger("Functions");class GlobalFunctions extends NativeFuncClass{print(...args){args=args.map(i=>i instanceof AXObject?i.callProperty("toString"):i&&i.toString()),trace.log(...args)}casi32(addr,expectedVal,newVal){const view=this.app.sec.flashEmu.interpreter.getCurrentAPP().domainMemory.view,old=view.getInt32(addr,!0);return old===expectedVal&&view.setInt32(addr,newVal,!0),old}describeType(){return null}}__decorate([NativeFunction()],GlobalFunctions.prototype,"print",null),__decorate([NativeFunction()],GlobalFunctions.prototype,"casi32",null),__decorate([NativeFunction()],GlobalFunctions.prototype,"describeType",null);class NativeObject{}let ObjectClass=class{constructor(self){this.self=self}axNewNative(self,app){return new NativeObject}_onPrototype(prototype,self){self.prototype.setProperty("toString",function(){return"[object Object]"})}["_init"](){}};ObjectClass=__decorate([NativeClass()],ObjectClass);let ClassClass=class{get_prototype(){return null}};ClassClass=__decorate([NativeClass("Class")],ClassClass);class ReferenceError extends Error{constructor(...args){super(...args)}}let ReferenceErrorClass=class{constructor(self){this.self=self}axNewNative(self,...args){return new ReferenceError(...args)}};ReferenceErrorClass=__decorate([NativeClass()],ReferenceErrorClass);class ArrayObj extends Array{toString(){return super.toString()}dynamic_shouldHandle(k){return"number"==typeof k}dynamic_set(k,v){this[k]=v}dynamic_get(k){return this[k]}dynamic_has(k){return void 0!==this[k]}}let ArrayClass=class{constructor(self){this.self=self}axBox(v,self){return self.axNew(...v)}axNewNative(self,...args){return new ArrayObj(...args)}};ArrayClass=__decorate([NativeClass(),Dynamic()],ArrayClass);class NamespaceObj extends Namespace{constructor(prefixValue,uriValue){void 0===uriValue&&(uriValue=prefixValue,prefixValue=""),super(NamespaceType.Public,uriValue,prefixValue)}toString(){return this.uri}valueOf(){console.error("Namespace.valueOf not impl")}}let NamespaceClass=class{constructor(self){this.self=self}axNewNative(self,...args){return new NamespaceObj(...args)}};NamespaceClass=__decorate([NativeClass()],NamespaceClass);class ByteArray{constructor(){this.position=0,this._length=0,this.littleEndian=!1,this.buf||(this.buf=new ArrayBuffer(0))}get bytesAvailable(){throw 1}set endian(v){this.littleEndian="littleEndian"===v}get endian(){return this.littleEndian?"littleEndian":"bigEndian"}get buf(){return this._buf}set buf(v){this._buf=v,this.reset(),this._length=v.byteLength}get length(){return this._length}set length(v){this.ensureCapacity(v),this._length=v}movePos(len){let p=this.position;return this.position+=len,this.position>this.length&&(this.length=this.position),p}readByte(){const p=this.movePos(1);return this.view.getInt8(p)}readUnsignedByte(){const p=this.movePos(1);return this.view.getUint8(p)}readInt(){const p=this.movePos(4);return this.view.getInt32(p,this.littleEndian)}readUnsignedInt(){const p=this.movePos(4);return this.view.getUint32(p,this.littleEndian)}readUTFBytes(length){const p=this.movePos(length);return decodeUTF8(this.u8view.slice(p,p+length))}readCStyleString(position){let out="";for(let i=0;!0;i++){const c=this.u8view[position+i];if(0===c)return out;out+=String.fromCharCode(c)}}writeByte(val){const p=this.movePos(1);this.view.setInt8(p,val)}writeBytes({native:bytes},offset=0,length=0){if(!(bytes instanceof ByteArray))throw new TypeError("writeBytes(bytes)");0===length&&(length=bytes.length),this._writeBytes(bytes.buf,offset,length)}_writeBytes(buf,offset=0,length=0){let src=new Uint8Array(buf.slice(offset,offset+length));const p=this.movePos(src.byteLength);this.u8view.set(src,p)}writeUnsignedInt(value){const p=this.movePos(4);this.view.setUint32(p,value,this.littleEndian)}writeInt(value){const p=this.movePos(4);this.view.setInt32(p,value,this.littleEndian)}writeUTFBytes(value){const src=encodeUTF8(value),p=this.movePos(src.byteLength);this.u8view.set(src,p)}ensureCapacity(length){const curBufrer=this.buf;if(curBufrer.byteLength<length){let newLength=Math.max(curBufrer.byteLength,1);for(;newLength<length;)newLength*=2;if(newLength>4294967295)throw new RangeError("RangeError");const newBuffer=new ArrayBuffer(newLength);new Uint8Array(newBuffer).set(new Uint8Array(curBufrer)),this.buf=newBuffer}}reset(){this.view=new DataView(this.buf),this.u8view=new Uint8Array(this.buf)}}let ByteArrayClass=class{constructor(self){this.self=self}axNewNative(self,...args){return new ByteArray(...args)}};ByteArrayClass=__decorate([NativeClass()],ByteArrayClass);let NumberClass=class{static get_MAX_VALUE(){return Number.MAX_VALUE}static get_MIN_VALUE(){return Number.MIN_VALUE}static get_NaN(){return Number.NaN}static get_NEGATIVE_INFINITY(){return Number.NEGATIVE_INFINITY}static get_POSITIVE_INFINITY(){return Number.POSITIVE_INFINITY}};NumberClass=__decorate([NativeClass()],NumberClass);class Dictionary{constructor(weakKeys=!1){this.dict=new Map}dynamic_shouldHandle(k){return!0}dynamic_set(k,v){return this.dict.set(k,v)}dynamic_get(k){return this.dict.get(k)}dynamic_has(k){return this.dict.has(k)}}let DictionaryClass=class{constructor(self){this.self=self}axNewNative(self,...args){return new Dictionary(...args)}};DictionaryClass=__decorate([NativeClass(),Dynamic()],DictionaryClass);let VectorClass=class{constructor(self){this.self=self}axNewNative(self,...args){throw new Error("not imp")}};VectorClass=__decorate([NativeClass()],VectorClass);class ObjectVector extends Array{toString(){return super.toString()}dynamic_shouldHandle(k){return"number"==typeof k}dynamic_set(k,v){this[k]=v}dynamic_get(k){return this[k]}dynamic_has(k){return void 0!==this[k]}dynamic_keys(){let out=[];for(let i=0;i<this.length;i++)out.push(i);return out}concat(...args){let ret=super.concat(...args),r=this.self.axClass.axNew();return r.native=ret,r.native.self=r,r}reverse(){let ret=super.reverse(),r=this.self.axClass.axNew();return r.native=ret,r.native.self=r,r}}let ObjectVectorClass=class{constructor(self){this.self=self}axNewNative(self,...args){const ret=new ObjectVector(...args);return ret.self=self,ret}};ObjectVectorClass=__decorate([NativeClass(),Dynamic()],ObjectVectorClass);class FunctionObj{call(self,...args){return this.func.call(self,...args)}apply(self,args){return args instanceof AXNativeObject&&(args=args.native),this.call(self,...args)}}let FunctionClass=class{constructor(self){this.self=self}axNewNative(self,...args){return new FunctionObj(...args)}_onPrototype(prototype,self){const set=(name,val)=>{prototype.axSetProperty(Multiname.Public(name),function(...args){return val.call(this.native,...args)},!1)},p=FunctionObj.prototype;set("call",p.call),set("apply",p.apply)}};FunctionClass=__decorate([NativeClass()],FunctionClass);class StringObj{constructor(str){this.str=str}replace(pattern,repl){return pattern&&pattern.native&&(pattern=pattern.native),repl&&repl.native&&(repl=repl.native),this.str.replace(pattern,repl)}split(s){return s&&s.native&&(s=s.native),this.str.split(s)}substr(from=0,length){return this.str.substr(from,length)}get length(){return this.str.length}set length(v){}}let StringClass=class{constructor(self){this.self=self}axNewNative(self,str){return new StringObj(str)}axCoerce(v,self){return v&&v.native?v.native.toString():v}axBox(v,self){return self.axNew(v)}};StringClass=__decorate([NativeClass()],StringClass);class DateObj extends Date{toString(){return super.toString()}get time(){return this.getTime()}set time(v){this.setTime(v)}}let DateClass=class{constructor(self){this.self=self}axNewNative(self,...args){return new DateObj(...args)}};DateClass=__decorate([NativeClass()],DateClass);class RegExpObj extends RegExp{constructor(pattern,options){super(pattern,options)}}let RegExpClass=class{constructor(self){this.self=self}axNewNative(self,...args){return new RegExpObj(...args)}};RegExpClass=__decorate([NativeClass()],RegExpClass);let XMLListClass=class{constructor(self){this.self=self}axNewNative(self,...args){return{}}};XMLListClass=__decorate([NativeClass()],XMLListClass);class EventDispatcher{addEventListener(type,listener,useCapture,priority,useWeakReference){"addedToStage"===type&&listener.call(this.self)}removeEventListener(type,listener,useCapture){}}let EventDispatcherClass=class{constructor(self){this.self=self}axNewNative(self,...args){let ret=new EventDispatcher(...args);return ret.self=self,ret}};EventDispatcherClass=__decorate([NativeClass()],EventDispatcherClass);let DisplayObjectClass=class extends EventDispatcherClass{constructor(){super(),this.stage=!0}};DisplayObjectClass=__decorate([NativeClass()],DisplayObjectClass);class AXApplicationDomain{constructor(app){this.app=app}get domainMemory(){const domainMemory=this.app.domainMemory;return domainMemory&&domainMemory.self}set domainMemory(v){this.app.domainMemory=v.native}}let ApplicationDomainClass=class{constructor(self){this.self=self}axNewNative(self,app){return new AXApplicationDomain(app)}get currentDomain(){return this.self.axNew(this.self.app.sec.flashEmu.interpreter.getCurrentAPP())}get MIN_DOMAIN_MEMORY_LENGTH(){return 1024}};ApplicationDomainClass=__decorate([NativeClass()],ApplicationDomainClass);new Logger("Interpreter");class Interpreter{constructor(){this.psc=new WeakMap,this.globalStacks=[],this.Errors=Errors,this.callTable=[];let bcs=[];for(let bc=0;bc<256;bc++)this[bc]&&bcs.push(bc);for(let bc of bcs)this.callTable[bc]=this[bc]}[Bytecode.SETLOCAL0]({locals:locals,stack:stack,bc:bc}){locals[0]=stack.pop()}[Bytecode.SETLOCAL1]({locals:locals,stack:stack,bc:bc}){locals[1]=stack.pop()}[Bytecode.SETLOCAL2]({locals:locals,stack:stack,bc:bc}){locals[2]=stack.pop()}[Bytecode.SETLOCAL3]({locals:locals,stack:stack,bc:bc}){locals[3]=stack.pop()}[Bytecode.GETLOCAL0]({locals:locals,stack:stack,bc:bc}){stack.push(locals[0])}[Bytecode.GETLOCAL1]({locals:locals,stack:stack,bc:bc}){stack.push(locals[1])}[Bytecode.GETLOCAL2]({locals:locals,stack:stack,bc:bc}){stack.push(locals[2])}[Bytecode.GETLOCAL3]({locals:locals,stack:stack,bc:bc}){stack.push(locals[3])}[Bytecode.GETLOCAL]({locals:locals,stack:stack,bc:bc,u30:u30}){stack.push(locals[u30()])}[Bytecode.SETLOCAL]({locals:locals,stack:stack,u30:u30}){locals[u30()]=stack.pop()}[Bytecode.PUSHSCOPE]({value:value,scopes:scopes,stack:stack,bc:bc,u30:u30}){value=stack.pop(),scopes.push(value,!1)}[Bytecode.FINDPROPERTY](intParam){return this[Bytecode.FINDPROPSTRICT](intParam)}[Bytecode.FINDPROPSTRICT]({scopes:scopes,value:value,rn:rn,stack:stack,bc:bc,u30:u30,abc:abc}){this.popNameInto(stack,abc.getMultiname(u30()),rn),value=scopes.topScope().findScopeProperty(rn,bc===Bytecode.FINDPROPSTRICT,!1),stack.push(value)}[Bytecode.CONSTRUCT]({receiver:receiver,locals:locals,stack:stack,bc:bc,u30:u30,args:args}){this.popManyInto(stack,u30(),args),receiver=stack.pop(),stack.push(receiver.axNew(...args))}[Bytecode.CONSTRUCTPROP]({receiver:receiver,abc:abc,index:index,rn:rn,args:args,locals:locals,stack:stack,bc:bc,u30:u30}){index=u30(),this.popManyInto(stack,u30(),args),this.popNameInto(stack,abc.getMultiname(index),rn),receiver=stack.pop(),stack.push(receiver.axConstructProperty(rn,args))}[Bytecode.CONSTRUCTSUPER]({savedScope:savedScope,receiver:receiver,args:args,locals:locals,stack:stack,bc:bc,u30:u30}){this.popManyInto(stack,u30(),args),receiver=stack.pop(),savedScope.object.axSuperNew(receiver,...args)}[Bytecode.CALL]({object:object,value:value,args:args,locals:locals,stack:stack,bc:bc,u30:u30}){this.popManyInto(stack,u30(),args),object=stack.pop(),value=stack[stack.length-1],stack[stack.length-1]=value.axCallProperty(this.getPublicMultiname("call"),[object,...args])}[Bytecode.CALLSUPER](intParam){return this[Bytecode.CALLSUPERVOID](intParam)}[Bytecode.CALLSUPERVOID]({receiver:receiver,result:result,rn:rn,abc:abc,args:args,argCount:argCount,savedScope:savedScope,index:index,locals:locals,stack:stack,bc:bc,u30:u30}){index=u30(),argCount=u30(),this.popManyInto(stack,argCount,args),this.popNameInto(stack,abc.getMultiname(index),rn),result=stack.pop().axCallSuper(rn,savedScope,args),bc!==Bytecode.CALLSUPERVOID&&stack.push(result)}[Bytecode.NEWFUNCTION]({value:value,sec:sec,scopes:scopes,abc:abc,locals:locals,stack:stack,bc:bc,u30:u30}){value=sec.createFunction(abc.getMethod(u30()),scopes.topScope(),!0),stack.push(value)}[Bytecode.FINDDEF]({app:app,value:value,rn:rn,abc:abc,index:index,locals:locals,stack:stack,bc:bc,u30:u30}){index=u30(),this.popNameInto(stack,abc.getMultiname(index),rn),value=app.findProperty(rn,!0,!0),stack.push(value)}[Bytecode.CALLPROPLEX](intParam){return this[Bytecode.CALLPROPVOID](intParam)}[Bytecode.CALLPROPERTY](intParam){return this[Bytecode.CALLPROPVOID](intParam)}[Bytecode.CALLPROPVOID]({result:result,rn:rn,abc:abc,receiver:receiver,sec:sec,app:app,args:args,argCount:argCount,index:index,locals:locals,stack:stack,bc:bc,u30:u30}){index=u30(),argCount=u30(),this.popManyInto(stack,argCount,args),this.popNameInto(stack,abc.getMultiname(index),rn),(receiver=stack[stack.length-1])&&this.instanceofAXObject(receiver)||(receiver=sec.box(receiver))||app.throwError("ReferenceError",this.Errors.NotImplementedError,1,2),result=receiver.axCallProperty(rn,args,bc===Bytecode.CALLPROPLEX),bc===Bytecode.CALLPROPVOID?stack.length--:stack[stack.length-1]=result}[Bytecode.NOP](intParam){}[Bytecode.COERCE_A](intParam){}[Bytecode.RETURNVOID]({returnValue:returnValue}){return this.globalStacks.pop(),returnValue(void 0)}[Bytecode.RETURNVALUE]({value:value,stack:stack,returnValue:returnValue}){return value=stack.pop(),this.globalStacks.pop(),returnValue(value)}[Bytecode.PUSHSTRING]({abc:abc,stack:stack,u30:u30}){stack.push(abc.getString(u30()))}[Bytecode.PUSHTRUE]({stack:stack}){stack.push(!0)}[Bytecode.PUSHFALSE]({stack:stack}){stack.push(!1)}[Bytecode.PUSHSHORT]({stack:stack,u30:u30}){stack.push(u30()<<16>>16)}[Bytecode.PUSHUNDEFINED]({locals:locals,stack:stack,bc:bc,u30:u30}){stack.push(void 0)}[Bytecode.GETGLOBALSCOPE]({savedScope:savedScope,stack:stack}){stack.push(savedScope.global.object)}[Bytecode.SWAP]({value:value,locals:locals,stack:stack,bc:bc,u30:u30}){value=stack[stack.length-1],stack[stack.length-1]=stack[stack.length-2],stack[stack.length-2]=value}[Bytecode.SETSLOT]({value:value,stack:stack,receiver:receiver,u30:u30}){value=stack.pop(),stack.pop().axSetSlot(u30(),value)}[Bytecode.PUSHBYTE]({stack:stack,s8:s8}){stack.push(s8())}[Bytecode.ADD]({a:a,b:b,value:value,locals:locals,stack:stack,bc:bc,u30:u30}){b=stack.pop(),value=stack.pop()+b,stack.push(value)}[Bytecode.MULTIPLY]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-2]*=stack.pop()}[Bytecode.DIVIDE]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-2]/=stack.pop()}[Bytecode.MODULO]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-2]%=stack.pop()}[Bytecode.SUBTRACT]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-2]-=stack.pop()}[Bytecode.JUMP]({pc:pc,s24:s24}){pc(s24())}[Bytecode.LESSTHAN]({stack:stack}){stack[stack.length-2]=stack[stack.length-2]<stack.pop()}[Bytecode.LESSEQUALS]({stack:stack}){stack[stack.length-2]=stack[stack.length-2]<=stack.pop()}[Bytecode.GREATERTHAN]({stack:stack}){stack[stack.length-2]=stack[stack.length-2]>stack.pop()}[Bytecode.GREATEREQUALS]({stack:stack}){stack[stack.length-2]=stack[stack.length-2]>=stack.pop()}[Bytecode.IFLE]({stack:stack,a:a,b:b,s24:s24,pc:pc,offset:offset}){b=stack.pop(),a=stack.pop(),offset=s24(),a<=b&&pc(offset)}[Bytecode.IFNLT]({a:a,b:b,stack:stack,s24:s24,offset:offset,pc:pc}){b=stack.pop(),a=stack.pop(),offset=s24(),a<b||pc(offset)}[Bytecode.IFGE]({a:a,b:b,stack:stack,s24:s24,offset:offset,pc:pc}){b=stack.pop(),a=stack.pop(),offset=s24(),a>=b&&pc(offset)}[Bytecode.IFGT]({offset:offset,stack:stack,a:a,b:b,s24:s24,pc:pc}){b=stack.pop(),a=stack.pop(),offset=s24(),a>b&&pc(offset)}[Bytecode.IFNGT]({offset:offset,stack:stack,a:a,b:b,s24:s24,pc:pc}){b=stack.pop(),a=stack.pop(),offset=s24(),a>b||pc(offset)}[Bytecode.IFNGE]({offset:offset,stack:stack,a:a,b:b,s24:s24,pc:pc}){b=stack.pop(),a=stack.pop(),offset=s24(),a>=b||pc(offset)}[Bytecode.IFLT]({offset:offset,stack:stack,a:a,b:b,s24:s24,pc:pc}){b=stack.pop(),a=stack.pop(),offset=s24(),a<b&&pc(offset)}[Bytecode.IFNE]({offset:offset,stack:stack,a:a,b:b,s24:s24,pc:pc}){b=stack.pop(),a=stack.pop(),offset=s24(),this.axEquals(a,b)||pc(offset)}[Bytecode.THROW]({value:value,stack:stack}){value=stack.pop(),this.throwWrapper(value)}[Bytecode.GETSLOT]({receiver:receiver,stack:stack,result:result,u30:u30}){result=stack.pop().axGetSlot(u30()),stack.push(result)}[Bytecode.LABEL]({locals:locals,stack:stack,bc:bc,u30:u30}){}[Bytecode.INCLOCAL_I]({locals:locals,index:index,u30:u30}){locals[index=u30()]=1+(0|locals[index])}[Bytecode.DECLOCAL_I]({locals:locals,index:index,u30:u30}){locals[index=u30()]=(0|locals[index])-1}[Bytecode.INCREMENT]({locals:locals,stack:stack}){++stack[stack.length-1]}[Bytecode.DECREMENT]({locals:locals,stack:stack}){--stack[stack.length-1]}[Bytecode.INCREMENT_I]({locals:locals,stack:stack}){stack[stack.length-1]=1+(0|stack[stack.length-1])}[Bytecode.DECREMENT_I]({locals:locals,stack:stack}){stack[stack.length-1]=(0|stack[stack.length-1])-1}[Bytecode.KILL]({locals:locals,stack:stack,u30:u30}){locals[u30()]=void 0}[Bytecode.POP]({locals:locals,stack:stack,bc:bc,u30:u30}){stack.pop()}[Bytecode.GETSCOPEOBJECT]({scopes:scopes,stack:stack,value:value,u30:u30}){value=scopes.get(u30()),stack.push(value)}[Bytecode.GETPROPERTY]({receiver:receiver,sec:sec,app:app,result:result,abc:abc,stack:stack,rn:rn,u30:u30}){this.popNameInto(stack,abc.getMultiname(u30()),rn),receiver=stack.pop(),this.instanceofAXObject(receiver)||(receiver=sec.box(receiver)),receiver||app.throwError("ReferenceError",this.Errors.UndefinedVarError,rn.name),result=receiver.axGetProperty(rn),stack.push(result)}[Bytecode.DELETEPROPERTY]({locals:locals,stack:stack,abc:abc,u30:u30,rn:rn,receiver:receiver}){this.popNameInto(stack,abc.getMultiname(u30()),rn),receiver=stack.pop(),stack.push(receiver.axDeleteProperty(rn))}[Bytecode.NEWCLASS]({locals:locals,stack:stack,value:value,app:app,abc:abc,scopes:scopes,u30:u30}){value=stack.pop(),value=app.createClass(abc.getClass(u30()),value,scopes.topScope()),stack.push(value)}[Bytecode.GETLEX]({locals:locals,stack:stack,rn:rn,object:object,result:result,scopes:scopes,u30:u30,abc:abc}){this.popNameInto(stack,abc.getMultiname(u30()),rn),result=scopes.topScope().findScopeProperty(rn,!0,!1).axGetProperty(rn),stack.push(result)}[Bytecode.POPSCOPE]({scopes:scopes}){scopes.pop()}[Bytecode.INITPROPERTY](intParam){return this[Bytecode.SETPROPERTY](intParam)}[Bytecode.SETPROPERTY]({locals:locals,stack:stack,rn:rn,abc:abc,value:value,receiver:receiver,bc:bc,u30:u30}){value=stack.pop(),this.popNameInto(stack,abc.getMultiname(u30()),rn),stack.pop().axSetProperty(rn,value,bc===Bytecode.INITPROPERTY),this.instanceofAXClass(value)&&value.setName(rn)}[Bytecode.NEWACTIVATION]({scopes:scopes,methodInfo:methodInfo,stack:stack,app:app,u30:u30}){stack.push(app.createActivation(methodInfo,scopes.topScope()))}[Bytecode.DUP]({locals:locals,stack:stack,bc:bc,u30:u30}){stack.push(stack[stack.length-1])}[Bytecode.PUSHNULL]({locals:locals,stack:stack,bc:bc,u30:u30}){stack.push(null)}[Bytecode.NEWARRAY]({locals:locals,stack:stack,app:app,object:object,u30:u30,argCount:argCount}){object=this.getPublicClass(app,"Array").axNew(),argCount=u30();for(let i=stack.length-argCount;i<stack.length;i++)object.native.push(stack[i]);stack.length-=argCount,stack.push(object)}[Bytecode.NOT]({stack:stack}){stack[stack.length-1]=!stack[stack.length-1]}[Bytecode.IFTRUE]({pc:pc,s24:s24,offset:offset,stack:stack}){offset=s24(),stack.pop()&&pc(offset)}[Bytecode.IFFALSE]({pc:pc,s24:s24,offset:offset,stack:stack}){offset=s24(),stack.pop()||pc(offset)}[Bytecode.NEGATE]({stack:stack}){stack[stack.length-1]=-stack[stack.length-1]}[Bytecode.COERCE_S]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-1]=this.axCoerceString(stack[stack.length-1])}[Bytecode.CONVERT_S]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-1]=this.axConvertString(stack[stack.length-1])}[Bytecode.COERCE_I](intParam){return this[Bytecode.CONVERT_I](intParam)}[Bytecode.CONVERT_I]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-1]|=0}[Bytecode.COERCE_B](intParam){return this[Bytecode.CONVERT_B](intParam)}[Bytecode.CONVERT_B]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-1]=!!stack[stack.length-1]}[Bytecode.COERCE_U](intParam){return this[Bytecode.CONVERT_U](intParam)}[Bytecode.CONVERT_U]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-1]>>>=0}[Bytecode.COERCE_D](intParam){return this[Bytecode.CONVERT_D](intParam)}[Bytecode.CONVERT_D]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-1]=+stack[stack.length-1]}[Bytecode.COERCE]({locals:locals,stack:stack,abc:abc,rn:rn,scopes:scopes,receiver:receiver,u30:u30}){this.popNameInto(stack,abc.getMultiname(u30()),rn),receiver=scopes.topScope().getScopeProperty(rn,!0,!1),stack[stack.length-1]=receiver.axCoerce(stack[stack.length-1])}[Bytecode.COERCE_S]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-1]=this.axCoerceString(stack[stack.length-1])}[Bytecode.APPLYTYPE]({locals:locals,stack:stack,args:args,app:app,u30:u30}){this.popManyInto(stack,u30(),args),stack[stack.length-1]=app.applyType(stack[stack.length-1],args)}[Bytecode.ISTYPELATE]({stack:stack,receiver:receiver}){receiver=stack.pop(),stack[stack.length-1]=receiver.axIsType(stack[stack.length-1])}[Bytecode.ASTYPELATE]({value:value,stack:stack,receiver:receiver,u30:u30}){receiver=stack.pop(),value=stack.pop(),receiver.axIsType(value)||(value=null),stack.push(value)}[Bytecode.NEWCATCH]({locals:locals,stack:stack,app:app,u30:u30,methodBody:methodBody,scopes:scopes}){stack.push(app.createCatch(methodBody.exception[u30()],scopes.topScope()))}[Bytecode.NEWOBJECT]({locals:locals,stack:stack,object:object,value:value,app:app,argCount:argCount,u30:u30}){object=this.getPublicClass(app,"Object").axNew(),argCount=u30();for(let i=stack.length-2*argCount;i<stack.length;i+=2)value=stack[i+1],object.axSetProperty(this.getPublicMultiname(stack[i]),value,!0);stack.length-=2*argCount,stack.push(object)}[Bytecode.falseLINE]({u30:u30}){u30()}[Bytecode.falseFILE]({u30:u30}){u30()}[Bytecode.false]({pc:pc,u30:u30}){pc(1),u30(),pc(1),u30()}[Bytecode.PUSHNAN]({locals:locals,stack:stack,bc:bc,u30:u30}){stack.push(Number.NaN)}[Bytecode.PUSHINT]({stack:stack,abc:abc,u30:u30}){stack.push(abc.getInt(u30()))}[Bytecode.PUSHUINT]({stack:stack,abc:abc,u30:u30}){stack.push(abc.getUInt(u30()))}[Bytecode.PUSHNAMESPACE]({locals:locals,stack:stack,app:app,abc:abc,u30:u30}){let ns=abc.getNamespace(u30()),cls=this.getPublicClass(app,"Namespace");stack.push(cls.axNew(ns.uri))}[Bytecode.IFEQ]({a:a,b:b,offset:offset,stack:stack,pc:pc,s24:s24}){b=stack.pop(),a=stack.pop(),offset=s24(),this.axEquals(a,b)&&pc(offset)}[Bytecode.EQUALS]({a:a,b:b,stack:stack}){a=stack[stack.length-2],b=stack.pop(),stack[stack.length-1]=this.axEquals(a,b)}lookupSwitch(context){const basePC=context.pc-1;let offset=context.s24();const caseCount=context.u30(),index=context.stack.pop();index<=caseCount&&(context.pc+=3*index,offset=context.s24()),context.pc=basePC+offset}[Bytecode.LOOKUPSWITCH]({context:context}){this.lookupSwitch(context)}[Bytecode.TYPEOF]({locals:locals,stack:stack,bc:bc,u30:u30}){stack[stack.length-1]=this.axTypeOf(stack[stack.length-1])}[Bytecode.HASNEXT2]({a:a,b:b,result:result,value:value,locals:locals,stack:stack,object:object,index:index,u30:u30}){a=u30(),b=u30(),object=locals[a],value=(index=locals[b])<object.axGetEnumerableKeys().length,locals[b]=index+1,stack.push(value)}[Bytecode.NEXTNAME]({receiver:receiver,stack:stack,index:index}){index=stack.pop(),receiver=stack.pop(),stack.push(receiver.axGetEnumerableKeys()[index-1])}[Bytecode.NEXTVALUE]({receiver:receiver,stack:stack,index:index}){index=stack.pop(),index=(receiver=stack.pop()).axGetEnumerableKeys()[index-1],stack.push(receiver.axGetProperty(this.getPublicMultiname(index)))}[Bytecode.CHECKFILTER]({locals:locals,stack:stack,bc:bc,u30:u30}){}[Bytecode.GETDESCENDANTS]({app:app,stack:stack,abc:abc,rn:rn,result:result,u30:u30}){this.popNameInto(stack,abc.getMultiname(u30()),rn),void 0===rn.name&&(rn.name="*"),result=this.getPublicClass(app,"Array").axNew(),stack[stack.length-1]=result}[Bytecode.LSHIFT]({stack:stack}){stack[stack.length-2]<<=stack.pop()}[Bytecode.RSHIFT]({stack:stack}){stack[stack.length-2]>>=stack.pop()}[Bytecode.URSHIFT]({stack:stack}){stack[stack.length-2]>>>=stack.pop()}[Bytecode.BITAND]({stack:stack}){stack[stack.length-2]&=stack.pop()}[Bytecode.BITXOR]({stack:stack}){stack[stack.length-2]^=stack.pop()}[Bytecode.BITOR]({stack:stack}){stack[stack.length-2]|=stack.pop()}[Bytecode.SI8]({stack:stack,a:a,domainMemory:domainMemory}){a=stack.pop(),domainMemory.u8view[a]=stack.pop()}[Bytecode.SI16]({stack:stack,a:a,value:value,domainMemory:domainMemory}){a=stack.pop(),value=stack.pop(),domainMemory.view.setUint16(a,value,!0)}[Bytecode.SI32]({stack:stack,a:a,value:value,domainMemory:domainMemory}){a=stack.pop(),value=stack.pop(),domainMemory.view.setInt32(a,value,!0)}[Bytecode.SF64]({stack:stack,a:a,value:value,domainMemory:domainMemory}){a=stack.pop(),value=stack.pop(),domainMemory.view.setFloat64(a,value,!0)}[Bytecode.LI8]({stack:stack,a:a,value:value,domainMemory:domainMemory}){stack[stack.length-1]=domainMemory.u8view[stack[stack.length-1]]}[Bytecode.LI16]({stack:stack,a:a,value:value,domainMemory:domainMemory}){a=stack.pop(),value=domainMemory.view.getUint16(a,!0),stack.push(value)}[Bytecode.LI32]({stack:stack,a:a,value:value,domainMemory:domainMemory}){a=stack.pop(),value=domainMemory.view.getInt32(a,!0),stack.push(value)}[Bytecode.LF32]({stack:stack,a:a,value:value,domainMemory:domainMemory}){a=stack.pop(),value=domainMemory.view.getFloat32(a,!0),stack.push(value)}[Bytecode.LF64]({stack:stack,a:a,value:value,domainMemory:domainMemory}){a=stack.pop(),value=domainMemory.view.getFloat64(a,!0),stack.push(value)}[Bytecode.SXI8]({stack:stack,value:value}){value=(value=stack.pop())<<24>>24,stack.push(value)}[Bytecode.SXI16]({stack:stack,value:value}){value=(value=stack.pop())<<16>>16,stack.push(value)}getPublicMultiname(name){return Multiname.Public(name)}getPublicClass(app,name){return app.getClass(Multiname.Public(name))}popNameInto(stack,mn,rn){if(rn._mangledName=null,rn.kind=mn.kind,mn.isRuntimeName()){let name=stack.pop();if(name&&name.axClass)return name=name.name,rn.kind=mn.isAttribute()?RTQNameLA$1:RTQNameL$1,rn.name=name.name,rn.nsSet=name.nsSet,void unwrapNsset(rn);rn.name=name}else rn.name=mn.name;if(mn.isRuntimeNamespace()){let ns=stack.pop();rn.nsSet=[ns]}else rn.nsSet=mn.nsSet;unwrapNsset(rn)}popManyInto(src,count,dst){popManyInto(src,count,dst)}throwWrapper(value){throw new ErrorWrapper(value)}axEquals(left,right){return axEquals(left,right)}axTypeOf(x){return axTypeOf(x)}axCoerceString(x){return axCoerceString(x)}axConvertString(x){return axConvertString(x)}newMultiname(){return new Multiname}newScopeStack(parentScope){return new ScopeStack(parentScope)}newContext(self,methodBody,savedScope,callArgs,callee){return new Context(self,methodBody,savedScope,callArgs,callee)}function2str(func){let code=func.toString();return code=/[\s\S]*?\([\s\S]*?\)[\s\S]*?\{([\s\S]*)\}/.exec(code)[1],code=code.replace(/Bytecode\.(\w+)/g,(substr,...args)=>Bytecode[args[0]])}instanceofAXObject(v){return v instanceof AXObject}instanceofAXClass(v){return v instanceof AXClass}procCatch(context,e){if(e instanceof ErrorWrapper){const methodBody=context.methodBody,stack=context.stack,scopes=context.scopes,sec=context.app.sec,pc=context.pc,err=e.error;for(let exception of methodBody.exception)if(pc>=exception.start&&pc<=exception.end){const type=context.app.getClass(exception.excType);if(!type||type.axIsType(err)){if(type);else{let display=err;sec.AXObject.axIsType(err)&&(display=err.axClass.name)}return stack.length=0,stack.push(err),scopes.clear(),context.pc=exception.target,!1}}}throw this.globalStacks.pop(),e}interpret(self,methodInfo,savedScope,callArgs,callee){let bc,value,app=methodInfo.abc.app,sec=app.sec,abc=methodInfo.abc,methodBody=abc.getMethodBodyByMethod(methodInfo),context=this.newContext(self,methodBody,savedScope,callArgs,callee),locals=context.locals,stack=context.stack,scopes=context.scopes,rn=this.newMultiname(),domainMemory=app.domainMemory,args=[];this.globalStacks.push(context);let u30,s8,s24,stop=!1,intParam={locals:locals,stack:stack,bc:bc,value:value,object:void 0,a:void 0,b:void 0,args:args,index:void 0,receiver:void 0,result:void 0,context:context,savedScope:savedScope,scopes:scopes,rn:rn,abc:abc,sec:sec,app:app,methodInfo:methodInfo,methodBody:methodBody,argCount:void 0,offset:void 0,domainMemory:domainMemory,pc:offset=>{context.pc+=offset},u30:u30=(()=>context.u30()),s8:s8=(()=>context.s8()),s24:s24=(()=>context.s24()),returnValue:x=>{stop=!0,value=x}};for(;!stop;){bc=context.bc(),intParam.bc=bc;try{this.callTable[bc].call(this,intParam)}catch(e){this.procCatch(context,e)}}if(stop)return value}prepare(code){const reader=new BufferReader(code);let out=[];for(;!reader.isEOF();){const pc=reader.ptr,bc=reader.readU8(),ps=OpcodeParam[bc];if(out[pc]=[bc],void 0!==ps){if("LOOKUPSWITCH"===ps){out[pc].push(reader.ptr);const offset=reader.readS24();reader.ptr=pc+offset;continue}if(ps.length>0)for(let p of ps)"2"===p?out[pc].push(reader.readS24()):"3"===p?out[pc].push(reader.readU30()):"8"===p&&out[pc].push(reader.readS8())}out[pc].push(reader.ptr)}return out}getCurrentAPP(){return 0===this.globalStacks.length?null:this.globalStacks[this.globalStacks.length-1].scopes.topScope().global.object.app}}class ScopeStack{constructor(parentScope=null){this.parent=parentScope,this.stack=[],this.isWith=[],this.scopes=null}get(index){return this.stack[index]}clear(){this.stack.length=0,this.isWith.length=0}push(val,isWith=!1){this.stack.push(val),this.isWith.push(isWith)}pop(){return this.isWith.pop(),this.stack.pop()}topScope(){if(!this.scopes){if(0===this.stack.length)return this.parent;this.scopes=[]}let parent=this.parent;for(let i=0;i<this.stack.length;i++){const object=this.stack[i],isWith=this.isWith[i];let scope=this.scopes[i];scope&&scope.parent===parent&&scope.object===object&&scope.isWith===isWith||(scope=this.scopes[i]=new Scope(parent,object,isWith)),parent=scope}return parent}}class Context{constructor(receiver,methodBody,parentScope,callArgs,callee){let methodInfo=methodBody.method;this.methodBody=methodBody,this.methodInfo=methodInfo,this.app=methodInfo.abc.app,this.stack=[],this.locals=[receiver],this.scopes=new ScopeStack(parentScope),this.reader=new BufferReader(methodBody.code),this.codeView=new Uint8Array(methodBody.code);const optLen=methodInfo.options.length,argCount=callArgs.length,paramType=methodInfo.paramType;let arg;for(let i=0;i<paramType.length;i++){arg=i<argCount?callArgs[i]:i<optLen?methodInfo.options[i].val:void 0;let rn=paramType[i];if(rn&&!rn.isAnyName()){let type=parentScope.getScopeProperty(rn,!0,!1);type&&(arg=type instanceof AXClass?type.axCoerce(arg):type(arg))}this.locals.push(arg)}methodInfo.needsRest()&&this.locals.push(callArgs.slice(paramType.length,callArgs.length))}bc(){return this.codeView[this.reader.ptr++]}u30(){return this.reader.readU30()}u8(){return this.reader.readU8()}s8(){return this.reader.readS8()}s24(){return this.reader.readS24()}set pc(value){this.reader.ptr=value}get pc(){return this.reader.ptr}}var common=function(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}(function(module,exports){var TYPED_OK="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;exports.assign=function(obj){for(var sources=Array.prototype.slice.call(arguments,1);sources.length;){var source=sources.shift();if(source){if("object"!=typeof source)throw new TypeError(source+"must be non-object");for(var p in source)source.hasOwnProperty(p)&&(obj[p]=source[p])}}return obj},exports.shrinkBuf=function(buf,size){return buf.length===size?buf:buf.subarray?buf.subarray(0,size):(buf.length=size,buf)};var fnTyped={arraySet:function(dest,src,src_offs,len,dest_offs){if(src.subarray&&dest.subarray)dest.set(src.subarray(src_offs,src_offs+len),dest_offs);else for(var i=0;i<len;i++)dest[dest_offs+i]=src[src_offs+i]},flattenChunks:function(chunks){var i,l,len,pos,chunk,result;for(len=0,i=0,l=chunks.length;i<l;i++)len+=chunks[i].length;for(result=new Uint8Array(len),pos=0,i=0,l=chunks.length;i<l;i++)chunk=chunks[i],result.set(chunk,pos),pos+=chunk.length;return result}},fnUntyped={arraySet:function(dest,src,src_offs,len,dest_offs){for(var i=0;i<len;i++)dest[dest_offs+i]=src[src_offs+i]},flattenChunks:function(chunks){return[].concat.apply([],chunks)}};exports.setTyped=function(on){on?(exports.Buf8=Uint8Array,exports.Buf16=Uint16Array,exports.Buf32=Int32Array,exports.assign(exports,fnTyped)):(exports.Buf8=Array,exports.Buf16=Array,exports.Buf32=Array,exports.assign(exports,fnUntyped))},exports.setTyped(TYPED_OK)}),Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2,STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],static_ltree=new Array(2*(L_CODES$1+2));zero$1(static_ltree);var static_dtree=new Array(2*D_CODES$1);zero$1(static_dtree);var _dist_code=new Array(512);zero$1(_dist_code);var _length_code=new Array(256);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);var static_l_desc,static_d_desc,static_bl_desc,configuration_table,static_init_done=!1,trees={_tr_init:function(s){static_init_done||(tr_static_init(),static_init_done=!0),s.l_desc=new TreeDesc(s.dyn_ltree,static_l_desc),s.d_desc=new TreeDesc(s.dyn_dtree,static_d_desc),s.bl_desc=new TreeDesc(s.bl_tree,static_bl_desc),s.bi_buf=0,s.bi_valid=0,init_block(s)},_tr_stored_block:_tr_stored_block,_tr_flush_block:function(s,buf,stored_len,last){var opt_lenb,static_lenb,max_blindex=0;s.level>0?(s.strm.data_type===Z_UNKNOWN$1&&(s.strm.data_type=detect_data_type(s)),build_tree(s,s.l_desc),build_tree(s,s.d_desc),max_blindex=build_bl_tree(s),opt_lenb=s.opt_len+3+7>>>3,(static_lenb=s.static_len+3+7>>>3)<=opt_lenb&&(opt_lenb=static_lenb)):opt_lenb=static_lenb=stored_len+5,stored_len+4<=opt_lenb&&-1!==buf?_tr_stored_block(s,buf,stored_len,last):s.strategy===Z_FIXED$1||static_lenb===opt_lenb?(send_bits(s,(STATIC_TREES<<1)+(last?1:0),3),compress_block(s,static_ltree,static_dtree)):(send_bits(s,(DYN_TREES<<1)+(last?1:0),3),send_all_trees(s,s.l_desc.max_code+1,s.d_desc.max_code+1,max_blindex+1),compress_block(s,s.dyn_ltree,s.dyn_dtree)),init_block(s),last&&bi_windup(s)},_tr_tally:function(s,dist,lc){return s.pending_buf[s.d_buf+2*s.last_lit]=dist>>>8&255,s.pending_buf[s.d_buf+2*s.last_lit+1]=255&dist,s.pending_buf[s.l_buf+s.last_lit]=255&lc,s.last_lit++,0===dist?s.dyn_ltree[2*lc]++:(s.matches++,dist--,s.dyn_ltree[2*(_length_code[lc]+LITERALS$1+1)]++,s.dyn_dtree[2*d_code(dist)]++),s.last_lit===s.lit_bufsize-1},_tr_align:function(s){send_bits(s,STATIC_TREES<<1,3),send_code(s,END_BLOCK,static_ltree),bi_flush(s)}},adler32_1=function(adler,buf,len,pos){for(var s1=65535&adler|0,s2=adler>>>16&65535|0,n=0;0!==len;){len-=n=len>2e3?2e3:len;do{s2=s2+(s1=s1+buf[pos++]|0)|0}while(--n);s1%=65521,s2%=65521}return s1|s2<<16|0},crcTable=function(){for(var c,table=[],n=0;n<256;n++){c=n;for(var k=0;k<8;k++)c=1&c?3988292384^c>>>1:c>>>1;table[n]=c}return table}(),crc32_1=function(crc,buf,len,pos){var t=crcTable,end=pos+len;crc^=-1;for(var i=pos;i<end;i++)crc=crc>>>8^t[255&(crc^buf[i])];return-1^crc},messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH$1=4,Z_BLOCK=5,Z_OK$1=0,Z_STREAM_END$1=1,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_BUF_ERROR=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN=2,Z_DEFLATED$1=8,MAX_MEM_LEVEL=9,MAX_WBITS=15,DEF_MEM_LEVEL=8,L_CODES=286,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;configuration_table=[new Config(0,0,0,0,function(s,flush){var max_block_size=65535;for(max_block_size>s.pending_buf_size-5&&(max_block_size=s.pending_buf_size-5);;){if(s.lookahead<=1){if(fill_window(s),0===s.lookahead&&flush===Z_NO_FLUSH$1)return BS_NEED_MORE;if(0===s.lookahead)break}s.strstart+=s.lookahead,s.lookahead=0;var max_start=s.block_start+max_block_size;if((0===s.strstart||s.strstart>=max_start)&&(s.lookahead=s.strstart-max_start,s.strstart=max_start,flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE;if(s.strstart-s.block_start>=s.w_size-MIN_LOOKAHEAD&&(flush_block_only(s,!1),0===s.strm.avail_out))return BS_NEED_MORE}return s.insert=0,flush===Z_FINISH$1?(flush_block_only(s,!0),0===s.strm.avail_out?BS_FINISH_STARTED:BS_FINISH_DONE):(s.strstart>s.block_start&&(flush_block_only(s,!1),s.strm.avail_out),BS_NEED_MORE)}),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];var deflate_1$2={deflateInit:function(strm,level){return deflateInit2(strm,level,Z_DEFLATED$1,MAX_WBITS,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)},deflateInit2:deflateInit2,deflateReset:deflateReset,deflateResetKeep:deflateResetKeep,deflateSetHeader:function(strm,head){return strm&&strm.state?2!==strm.state.wrap?Z_STREAM_ERROR:(strm.state.gzhead=head,Z_OK$1):Z_STREAM_ERROR},deflate:function(strm,flush){var old_flush,s,beg,val;if(!strm||!strm.state||flush>Z_BLOCK||flush<0)return strm?err(strm,Z_STREAM_ERROR):Z_STREAM_ERROR;if(s=strm.state,!strm.output||!strm.input&&0!==strm.avail_in||s.status===FINISH_STATE&&flush!==Z_FINISH$1)return err(strm,0===strm.avail_out?Z_BUF_ERROR:Z_STREAM_ERROR);if(s.strm=strm,old_flush=s.last_flush,s.last_flush=flush,s.status===INIT_STATE)if(2===s.wrap)strm.adler=0,put_byte(s,31),put_byte(s,139),put_byte(s,8),s.gzhead?(put_byte(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),put_byte(s,255&s.gzhead.time),put_byte(s,s.gzhead.time>>8&255),put_byte(s,s.gzhead.time>>16&255),put_byte(s,s.gzhead.time>>24&255),put_byte(s,9===s.level?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0),put_byte(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(put_byte(s,255&s.gzhead.extra.length),put_byte(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=EXTRA_STATE):(put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,0),put_byte(s,9===s.level?2:s.strategy>=Z_HUFFMAN_ONLY||s.level<2?4:0),put_byte(s,OS_CODE),s.status=BUSY_STATE);else{var header=Z_DEFLATED$1+(s.w_bits-8<<4)<<8;header|=(s.strategy>=Z_HUFFMAN_ONLY||s.level<2?0:s.level<6?1:6===s.level?2:3)<<6,0!==s.strstart&&(header|=PRESET_DICT),header+=31-header%31,s.status=BUSY_STATE,putShortMSB(s,header),0!==s.strstart&&(putShortMSB(s,strm.adler>>>16),putShortMSB(s,65535&strm.adler)),strm.adler=1}if(s.status===EXTRA_STATE)if(s.gzhead.extra){for(beg=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending!==s.pending_buf_size));)put_byte(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=NAME_STATE)}else s.status=NAME_STATE;if(s.status===NAME_STATE)if(s.gzhead.name){beg=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size)){val=1;break}val=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,put_byte(s,val)}while(0!==val);s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),0===val&&(s.gzindex=0,s.status=COMMENT_STATE)}else s.status=COMMENT_STATE;if(s.status===COMMENT_STATE)if(s.gzhead.comment){beg=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),flush_pending(strm),beg=s.pending,s.pending===s.pending_buf_size)){val=1;break}val=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,put_byte(s,val)}while(0!==val);s.gzhead.hcrc&&s.pending>beg&&(strm.adler=crc32_1(strm.adler,s.pending_buf,s.pending-beg,beg)),0===val&&(s.status=HCRC_STATE)}else s.status=HCRC_STATE;if(s.status===HCRC_STATE&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&flush_pending(strm),s.pending+2<=s.pending_buf_size&&(put_byte(s,255&strm.adler),put_byte(s,strm.adler>>8&255),strm.adler=0,s.status=BUSY_STATE)):s.status=BUSY_STATE),0!==s.pending){if(flush_pending(strm),0===strm.avail_out)return s.last_flush=-1,Z_OK$1}else if(0===strm.avail_in&&rank(flush)<=rank(old_flush)&&flush!==Z_FINISH$1)return err(strm,Z_BUF_ERROR);if(s.status===FINISH_STATE&&0!==strm.avail_in)return err(strm,Z_BUF_ERROR);if(0!==strm.avail_in||0!==s.lookahead||flush!==Z_NO_FLUSH$1&&s.status!==FINISH_STATE){var bstate=s.strategy===Z_HUFFMAN_ONLY?deflate_huff(s,flush):s.strategy===Z_RLE?deflate_rle(s,flush):configuration_table[s.level].func(s,flush);if(bstate!==BS_FINISH_STARTED&&bstate!==BS_FINISH_DONE||(s.status=FINISH_STATE),bstate===BS_NEED_MORE||bstate===BS_FINISH_STARTED)return 0===strm.avail_out&&(s.last_flush=-1),Z_OK$1;if(bstate===BS_BLOCK_DONE&&(flush===Z_PARTIAL_FLUSH?trees._tr_align(s):flush!==Z_BLOCK&&(trees._tr_stored_block(s,0,0,!1),flush===Z_FULL_FLUSH&&(zero(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),flush_pending(strm),0===strm.avail_out))return s.last_flush=-1,Z_OK$1}return flush!==Z_FINISH$1?Z_OK$1:s.wrap<=0?Z_STREAM_END$1:(2===s.wrap?(put_byte(s,255&strm.adler),put_byte(s,strm.adler>>8&255),put_byte(s,strm.adler>>16&255),put_byte(s,strm.adler>>24&255),put_byte(s,255&strm.total_in),put_byte(s,strm.total_in>>8&255),put_byte(s,strm.total_in>>16&255),put_byte(s,strm.total_in>>24&255)):(putShortMSB(s,strm.adler>>>16),putShortMSB(s,65535&strm.adler)),flush_pending(strm),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?Z_OK$1:Z_STREAM_END$1)},deflateEnd:function(strm){var status;return strm&&strm.state?(status=strm.state.status)!==INIT_STATE&&status!==EXTRA_STATE&&status!==NAME_STATE&&status!==COMMENT_STATE&&status!==HCRC_STATE&&status!==BUSY_STATE&&status!==FINISH_STATE?err(strm,Z_STREAM_ERROR):(strm.state=null,status===BUSY_STATE?err(strm,Z_DATA_ERROR):Z_OK$1):Z_STREAM_ERROR},deflateSetDictionary:function(strm,dictionary){var s,str,n,wrap,avail,next,input,tmpDict,dictLength=dictionary.length;if(!strm||!strm.state)return Z_STREAM_ERROR;if(s=strm.state,2===(wrap=s.wrap)||1===wrap&&s.status!==INIT_STATE||s.lookahead)return Z_STREAM_ERROR;for(1===wrap&&(strm.adler=adler32_1(strm.adler,dictionary,dictLength,0)),s.wrap=0,dictLength>=s.w_size&&(0===wrap&&(zero(s.head),s.strstart=0,s.block_start=0,s.insert=0),tmpDict=new common.Buf8(s.w_size),common.arraySet(tmpDict,dictionary,dictLength-s.w_size,s.w_size,0),dictionary=tmpDict,dictLength=s.w_size),avail=strm.avail_in,next=strm.next_in,input=strm.input,strm.avail_in=dictLength,strm.next_in=0,strm.input=dictionary,fill_window(s);s.lookahead>=MIN_MATCH;){str=s.strstart,n=s.lookahead-(MIN_MATCH-1);do{s.ins_h=(s.ins_h<<s.hash_shift^s.window[str+MIN_MATCH-1])&s.hash_mask,s.prev[str&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=str,str++}while(--n);s.strstart=str,s.lookahead=MIN_MATCH-1,fill_window(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,strm.next_in=next,strm.input=input,strm.avail_in=avail,s.wrap=wrap,Z_OK$1},deflateInfo:"pako deflate (from Nodeca project)"},STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(__){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(__){STR_APPLY_UIA_OK=!1}for(var _utf8len=new common.Buf8(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1;var strings={string2buf:function(str){var buf,c,c2,m_pos,i,str_len=str.length,buf_len=0;for(m_pos=0;m_pos<str_len;m_pos++)55296==(64512&(c=str.charCodeAt(m_pos)))&&m_pos+1<str_len&&56320==(64512&(c2=str.charCodeAt(m_pos+1)))&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++),buf_len+=c<128?1:c<2048?2:c<65536?3:4;for(buf=new common.Buf8(buf_len),i=0,m_pos=0;i<buf_len;m_pos++)55296==(64512&(c=str.charCodeAt(m_pos)))&&m_pos+1<str_len&&56320==(64512&(c2=str.charCodeAt(m_pos+1)))&&(c=65536+(c-55296<<10)+(c2-56320),m_pos++),c<128?buf[i++]=c:c<2048?(buf[i++]=192|c>>>6,buf[i++]=128|63&c):c<65536?(buf[i++]=224|c>>>12,buf[i++]=128|c>>>6&63,buf[i++]=128|63&c):(buf[i++]=240|c>>>18,buf[i++]=128|c>>>12&63,buf[i++]=128|c>>>6&63,buf[i++]=128|63&c);return buf},buf2binstring:function(buf){return buf2binstring(buf,buf.length)},binstring2buf:function(str){for(var buf=new common.Buf8(str.length),i=0,len=buf.length;i<len;i++)buf[i]=str.charCodeAt(i);return buf},buf2string:function(buf,max){var i,out,c,c_len,len=max||buf.length,utf16buf=new Array(2*len);for(out=0,i=0;i<len;)if((c=buf[i++])<128)utf16buf[out++]=c;else if((c_len=_utf8len[c])>4)utf16buf[out++]=65533,i+=c_len-1;else{for(c&=2===c_len?31:3===c_len?15:7;c_len>1&&i<len;)c=c<<6|63&buf[i++],c_len--;c_len>1?utf16buf[out++]=65533:c<65536?utf16buf[out++]=c:(c-=65536,utf16buf[out++]=55296|c>>10&1023,utf16buf[out++]=56320|1023&c)}return buf2binstring(utf16buf,out)},utf8border:function(buf,max){var pos;for((max=max||buf.length)>buf.length&&(max=buf.length),pos=max-1;pos>=0&&128==(192&buf[pos]);)pos--;return pos<0?max:0===pos?max:pos+_utf8len[buf[pos]]>max?pos:max}},zstream=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},toString=Object.prototype.toString,Z_OK=0,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED=8;Deflate.prototype.push=function(data,mode){var status,_mode,strm=this.strm,chunkSize=this.options.chunkSize;if(this.ended)return!1;_mode=mode===~~mode?mode:!0===mode?4:0,"string"==typeof data?strm.input=strings.string2buf(data):"[object ArrayBuffer]"===toString.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;do{if(0===strm.avail_out&&(strm.output=new common.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),1!==(status=deflate_1$2.deflate(strm,_mode))&&status!==Z_OK)return this.onEnd(status),this.ended=!0,!1;0!==strm.avail_out&&(0!==strm.avail_in||4!==_mode&&2!==_mode)||("string"===this.options.to?this.onData(strings.buf2binstring(common.shrinkBuf(strm.output,strm.next_out))):this.onData(common.shrinkBuf(strm.output,strm.next_out)))}while((strm.avail_in>0||0===strm.avail_out)&&1!==status);return 4===_mode?(status=deflate_1$2.deflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===Z_OK):2!==_mode||(this.onEnd(Z_OK),strm.avail_out=0,!0)},Deflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Deflate.prototype.onEnd=function(status){status===Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg};var lenfix,distfix,deflate_1={Deflate:Deflate,deflate:deflate,deflateRaw:function(input,options){return options=options||{},options.raw=!0,deflate(input,options)},gzip:function(input,options){return options=options||{},options.gzip=!0,deflate(input,options)}},inffast=function(strm,start){var state,_in,last,_out,beg,end,dmax,wsize,whave,wnext,s_window,hold,bits,lcode,dcode,lmask,dmask,here,op,len,dist,from,from_source,input,output;state=strm.state,_in=strm.next_in,input=strm.input,last=_in+(strm.avail_in-5),_out=strm.next_out,output=strm.output,beg=_out-(start-strm.avail_out),end=_out+(strm.avail_out-257),dmax=state.dmax,wsize=state.wsize,whave=state.whave,wnext=state.wnext,s_window=state.window,hold=state.hold,bits=state.bits,lcode=state.lencode,dcode=state.distcode,lmask=(1<<state.lenbits)-1,dmask=(1<<state.distbits)-1;top:do{bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=lcode[hold&lmask];dolen:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,0===(op=here>>>16&255))output[_out++]=65535&here;else{if(!(16&op)){if(0==(64&op)){here=lcode[(65535&here)+(hold&(1<<op)-1)];continue dolen}if(32&op){state.mode=12;break top}strm.msg="invalid literal/length code",state.mode=30;break top}len=65535&here,(op&=15)&&(bits<op&&(hold+=input[_in++]<<bits,bits+=8),len+=hold&(1<<op)-1,hold>>>=op,bits-=op),bits<15&&(hold+=input[_in++]<<bits,bits+=8,hold+=input[_in++]<<bits,bits+=8),here=dcode[hold&dmask];dodist:for(;;){if(op=here>>>24,hold>>>=op,bits-=op,!(16&(op=here>>>16&255))){if(0==(64&op)){here=dcode[(65535&here)+(hold&(1<<op)-1)];continue dodist}strm.msg="invalid distance code",state.mode=30;break top}if(dist=65535&here,op&=15,bits<op&&(hold+=input[_in++]<<bits,(bits+=8)<op&&(hold+=input[_in++]<<bits,bits+=8)),(dist+=hold&(1<<op)-1)>dmax){strm.msg="invalid distance too far back",state.mode=30;break top}if(hold>>>=op,bits-=op,op=_out-beg,dist>op){if((op=dist-op)>whave&&state.sane){strm.msg="invalid distance too far back",state.mode=30;break top}if(from=0,from_source=s_window,0===wnext){if(from+=wsize-op,op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist,from_source=output}}else if(wnext<op){if(from+=wsize+wnext-op,(op-=wnext)<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);if(from=0,wnext<len){len-=op=wnext;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist,from_source=output}}}else if(from+=wnext-op,op<len){len-=op;do{output[_out++]=s_window[from++]}while(--op);from=_out-dist,from_source=output}for(;len>2;)output[_out++]=from_source[from++],output[_out++]=from_source[from++],output[_out++]=from_source[from++],len-=3;len&&(output[_out++]=from_source[from++],len>1&&(output[_out++]=from_source[from++]))}else{from=_out-dist;do{output[_out++]=output[from++],output[_out++]=output[from++],output[_out++]=output[from++],len-=3}while(len>2);len&&(output[_out++]=output[from++],len>1&&(output[_out++]=output[from++]))}break}}break}}while(_in<last&&_out<end);_in-=len=bits>>3,hold&=(1<<(bits-=len<<3))-1,strm.next_in=_in,strm.next_out=_out,strm.avail_in=_in<last?last-_in+5:5-(_in-last),strm.avail_out=_out<end?end-_out+257:257-(_out-end),state.hold=hold,state.bits=bits},lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],inftrees=function(type,lens,lens_index,codes,table,table_index,work,opts){var incr,fill,low,mask,next,end,here_bits,here_op,here_val,bits=opts.bits,len=0,sym=0,min=0,max=0,root=0,curr=0,drop=0,left=0,used=0,huff=0,base=null,base_index=0,count=new common.Buf16(16),offs=new common.Buf16(16),extra=null,extra_index=0;for(len=0;len<=15;len++)count[len]=0;for(sym=0;sym<codes;sym++)count[lens[lens_index+sym]]++;for(root=bits,max=15;max>=1&&0===count[max];max--);if(root>max&&(root=max),0===max)return table[table_index++]=20971520,table[table_index++]=20971520,opts.bits=1,0;for(min=1;min<max&&0===count[min];min++);for(root<min&&(root=min),left=1,len=1;len<=15;len++)if(left<<=1,(left-=count[len])<0)return-1;if(left>0&&(0===type||1!==max))return-1;for(offs[1]=0,len=1;len<15;len++)offs[len+1]=offs[len]+count[len];for(sym=0;sym<codes;sym++)0!==lens[lens_index+sym]&&(work[offs[lens[lens_index+sym]]++]=sym);if(0===type?(base=extra=work,end=19):1===type?(base=lbase,base_index-=257,extra=lext,extra_index-=257,end=256):(base=dbase,extra=dext,end=-1),huff=0,sym=0,len=min,next=table_index,curr=root,drop=0,low=-1,used=1<<root,mask=used-1,1===type&&used>852||2===type&&used>592)return 1;for(;;){here_bits=len-drop,work[sym]<end?(here_op=0,here_val=work[sym]):work[sym]>end?(here_op=extra[extra_index+work[sym]],here_val=base[base_index+work[sym]]):(here_op=96,here_val=0),incr=1<<len-drop,min=fill=1<<curr;do{table[next+(huff>>drop)+(fill-=incr)]=here_bits<<24|here_op<<16|here_val|0}while(0!==fill);for(incr=1<<len-1;huff&incr;)incr>>=1;if(0!==incr?(huff&=incr-1,huff+=incr):huff=0,sym++,0==--count[len]){if(len===max)break;len=lens[lens_index+work[sym]]}if(len>root&&(huff&mask)!==low){for(0===drop&&(drop=root),next+=min,left=1<<(curr=len-drop);curr+drop<max&&!((left-=count[curr+drop])<=0);)curr++,left<<=1;if(used+=1<<curr,1===type&&used>852||2===type&&used>592)return 1;table[low=huff&mask]=root<<24|curr<<16|next-table_index|0}}return 0!==huff&&(table[next+huff]=len-drop<<24|64<<16|0),opts.bits=root,0},CODES=0,LENS=1,DISTS=2,Z_FINISH$2=4,Z_BLOCK$1=5,Z_TREES=6,Z_OK$2=0,Z_STREAM_END$2=1,Z_NEED_DICT=2,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR$1=-5,Z_DEFLATED$2=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,DEF_WBITS=15,virgin=!0,inflate_1$2={inflateReset:inflateReset,inflateReset2:inflateReset2,inflateResetKeep:inflateResetKeep,inflateInit:function(strm){return inflateInit2(strm,DEF_WBITS)},inflateInit2:inflateInit2,inflate:function(strm,flush){var state,input,output,next,put,have,left,hold,bits,_in,_out,copy,from,from_source,here_bits,here_op,here_val,last_bits,last_op,last_val,len,ret,opts,n,here=0,hbuf=new common.Buf8(4),order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!strm||!strm.state||!strm.output||!strm.input&&0!==strm.avail_in)return Z_STREAM_ERROR$1;(state=strm.state).mode===TYPE&&(state.mode=TYPEDO),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,_in=have,_out=left,ret=Z_OK$2;inf_leave:for(;;)switch(state.mode){case HEAD:if(0===state.wrap){state.mode=TYPEDO;break}for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(2&state.wrap&&35615===hold){state.check=0,hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0),hold=0,bits=0,state.mode=FLAGS;break}if(state.flags=0,state.head&&(state.head.done=!1),!(1&state.wrap)||(((255&hold)<<8)+(hold>>8))%31){strm.msg="incorrect header check",state.mode=BAD;break}if((15&hold)!==Z_DEFLATED$2){strm.msg="unknown compression method",state.mode=BAD;break}if(hold>>>=4,bits-=4,len=8+(15&hold),0===state.wbits)state.wbits=len;else if(len>state.wbits){strm.msg="invalid window size",state.mode=BAD;break}state.dmax=1<<len,strm.adler=state.check=1,state.mode=512&hold?DICTID:TYPE,hold=0,bits=0;break;case FLAGS:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.flags=hold,(255&state.flags)!==Z_DEFLATED$2){strm.msg="unknown compression method",state.mode=BAD;break}if(57344&state.flags){strm.msg="unknown header flags set",state.mode=BAD;break}state.head&&(state.head.text=hold>>8&1),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=TIME;case TIME:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.time=hold),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,hbuf[2]=hold>>>16&255,hbuf[3]=hold>>>24&255,state.check=crc32_1(state.check,hbuf,4,0)),hold=0,bits=0,state.mode=OS;case OS:for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.head&&(state.head.xflags=255&hold,state.head.os=hold>>8),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0)),hold=0,bits=0,state.mode=EXLEN;case EXLEN:if(1024&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length=hold,state.head&&(state.head.extra_len=hold),512&state.flags&&(hbuf[0]=255&hold,hbuf[1]=hold>>>8&255,state.check=crc32_1(state.check,hbuf,2,0)),hold=0,bits=0}else state.head&&(state.head.extra=null);state.mode=EXTRA;case EXTRA:if(1024&state.flags&&((copy=state.length)>have&&(copy=have),copy&&(state.head&&(len=state.head.extra_len-state.length,state.head.extra||(state.head.extra=new Array(state.head.extra_len)),common.arraySet(state.head.extra,input,next,copy,len)),512&state.flags&&(state.check=crc32_1(state.check,input,copy,next)),have-=copy,next+=copy,state.length-=copy),state.length))break inf_leave;state.length=0,state.mode=NAME;case NAME:if(2048&state.flags){if(0===have)break inf_leave;copy=0;do{len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.name+=String.fromCharCode(len))}while(len&&copy<have);if(512&state.flags&&(state.check=crc32_1(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.name=null);state.length=0,state.mode=COMMENT;case COMMENT:if(4096&state.flags){if(0===have)break inf_leave;copy=0;do{len=input[next+copy++],state.head&&len&&state.length<65536&&(state.head.comment+=String.fromCharCode(len))}while(len&&copy<have);if(512&state.flags&&(state.check=crc32_1(state.check,input,copy,next)),have-=copy,next+=copy,len)break inf_leave}else state.head&&(state.head.comment=null);state.mode=HCRC;case HCRC:if(512&state.flags){for(;bits<16;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(65535&state.check)){strm.msg="header crc mismatch",state.mode=BAD;break}hold=0,bits=0}state.head&&(state.head.hcrc=state.flags>>9&1,state.head.done=!0),strm.adler=state.check=0,state.mode=TYPE;break;case DICTID:for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}strm.adler=state.check=zswap32(hold),hold=0,bits=0,state.mode=DICT;case DICT:if(0===state.havedict)return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,Z_NEED_DICT;strm.adler=state.check=1,state.mode=TYPE;case TYPE:if(flush===Z_BLOCK$1||flush===Z_TREES)break inf_leave;case TYPEDO:if(state.last){hold>>>=7&bits,bits-=7&bits,state.mode=CHECK;break}for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}switch(state.last=1&hold,hold>>>=1,bits-=1,3&hold){case 0:state.mode=STORED;break;case 1:if(fixedtables(state),state.mode=LEN_,flush===Z_TREES){hold>>>=2,bits-=2;break inf_leave}break;case 2:state.mode=TABLE;break;case 3:strm.msg="invalid block type",state.mode=BAD}hold>>>=2,bits-=2;break;case STORED:for(hold>>>=7&bits,bits-=7&bits;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if((65535&hold)!=(hold>>>16^65535)){strm.msg="invalid stored block lengths",state.mode=BAD;break}if(state.length=65535&hold,hold=0,bits=0,state.mode=COPY_,flush===Z_TREES)break inf_leave;case COPY_:state.mode=COPY;case COPY:if(copy=state.length){if(copy>have&&(copy=have),copy>left&&(copy=left),0===copy)break inf_leave;common.arraySet(output,input,next,copy,put),have-=copy,next+=copy,left-=copy,put+=copy,state.length-=copy;break}state.mode=TYPE;break;case TABLE:for(;bits<14;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(state.nlen=257+(31&hold),hold>>>=5,bits-=5,state.ndist=1+(31&hold),hold>>>=5,bits-=5,state.ncode=4+(15&hold),hold>>>=4,bits-=4,state.nlen>286||state.ndist>30){strm.msg="too many length or distance symbols",state.mode=BAD;break}state.have=0,state.mode=LENLENS;case LENLENS:for(;state.have<state.ncode;){for(;bits<3;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.lens[order[state.have++]]=7&hold,hold>>>=3,bits-=3}for(;state.have<19;)state.lens[order[state.have++]]=0;if(state.lencode=state.lendyn,state.lenbits=7,opts={bits:state.lenbits},ret=inftrees(CODES,state.lens,0,19,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid code lengths set",state.mode=BAD;break}state.have=0,state.mode=CODELENS;case CODELENS:for(;state.have<state.nlen+state.ndist;){for(;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_val<16)hold>>>=here_bits,bits-=here_bits,state.lens[state.have++]=here_val;else{if(16===here_val){for(n=here_bits+2;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold>>>=here_bits,bits-=here_bits,0===state.have){strm.msg="invalid bit length repeat",state.mode=BAD;break}len=state.lens[state.have-1],copy=3+(3&hold),hold>>>=2,bits-=2}else if(17===here_val){for(n=here_bits+3;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}bits-=here_bits,len=0,copy=3+(7&(hold>>>=here_bits)),hold>>>=3,bits-=3}else{for(n=here_bits+7;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}bits-=here_bits,len=0,copy=11+(127&(hold>>>=here_bits)),hold>>>=7,bits-=7}if(state.have+copy>state.nlen+state.ndist){strm.msg="invalid bit length repeat",state.mode=BAD;break}for(;copy--;)state.lens[state.have++]=len}}if(state.mode===BAD)break;if(0===state.lens[256]){strm.msg="invalid code -- missing end-of-block",state.mode=BAD;break}if(state.lenbits=9,opts={bits:state.lenbits},ret=inftrees(LENS,state.lens,0,state.nlen,state.lencode,0,state.work,opts),state.lenbits=opts.bits,ret){strm.msg="invalid literal/lengths set",state.mode=BAD;break}if(state.distbits=6,state.distcode=state.distdyn,opts={bits:state.distbits},ret=inftrees(DISTS,state.lens,state.nlen,state.ndist,state.distcode,0,state.work,opts),state.distbits=opts.bits,ret){strm.msg="invalid distances set",state.mode=BAD;break}if(state.mode=LEN_,flush===Z_TREES)break inf_leave;case LEN_:state.mode=LEN;case LEN:if(have>=6&&left>=258){strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,inffast(strm,_out),put=strm.next_out,output=strm.output,left=strm.avail_out,next=strm.next_in,input=strm.input,have=strm.avail_in,hold=state.hold,bits=state.bits,state.mode===TYPE&&(state.back=-1);break}for(state.back=0;here=state.lencode[hold&(1<<state.lenbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(here_op&&0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.lencode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(last_bits+here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,state.length=here_val,0===here_op){state.mode=LIT;break}if(32&here_op){state.back=-1,state.mode=TYPE;break}if(64&here_op){strm.msg="invalid literal/length code",state.mode=BAD;break}state.extra=15&here_op,state.mode=LENEXT;case LENEXT:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.length+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}state.was=state.length,state.mode=DIST;case DIST:for(;here=state.distcode[hold&(1<<state.distbits)-1],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(0==(240&here_op)){for(last_bits=here_bits,last_op=here_op,last_val=here_val;here=state.distcode[last_val+((hold&(1<<last_bits+last_op)-1)>>last_bits)],here_bits=here>>>24,here_op=here>>>16&255,here_val=65535&here,!(last_bits+here_bits<=bits);){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}hold>>>=last_bits,bits-=last_bits,state.back+=last_bits}if(hold>>>=here_bits,bits-=here_bits,state.back+=here_bits,64&here_op){strm.msg="invalid distance code",state.mode=BAD;break}state.offset=here_val,state.extra=15&here_op,state.mode=DISTEXT;case DISTEXT:if(state.extra){for(n=state.extra;bits<n;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}state.offset+=hold&(1<<state.extra)-1,hold>>>=state.extra,bits-=state.extra,state.back+=state.extra}if(state.offset>state.dmax){strm.msg="invalid distance too far back",state.mode=BAD;break}state.mode=MATCH;case MATCH:if(0===left)break inf_leave;if(copy=_out-left,state.offset>copy){if((copy=state.offset-copy)>state.whave&&state.sane){strm.msg="invalid distance too far back",state.mode=BAD;break}copy>state.wnext?(copy-=state.wnext,from=state.wsize-copy):from=state.wnext-copy,copy>state.length&&(copy=state.length),from_source=state.window}else from_source=output,from=put-state.offset,copy=state.length;copy>left&&(copy=left),left-=copy,state.length-=copy;do{output[put++]=from_source[from++]}while(--copy);0===state.length&&(state.mode=LEN);break;case LIT:if(0===left)break inf_leave;output[put++]=state.length,left--,state.mode=LEN;break;case CHECK:if(state.wrap){for(;bits<32;){if(0===have)break inf_leave;have--,hold|=input[next++]<<bits,bits+=8}if(_out-=left,strm.total_out+=_out,state.total+=_out,_out&&(strm.adler=state.check=state.flags?crc32_1(state.check,output,_out,put-_out):adler32_1(state.check,output,_out,put-_out)),_out=left,(state.flags?hold:zswap32(hold))!==state.check){strm.msg="incorrect data check",state.mode=BAD;break}hold=0,bits=0}state.mode=LENGTH;case LENGTH:if(state.wrap&&state.flags){for(;bits<32;){if(0===have)break inf_leave;have--,hold+=input[next++]<<bits,bits+=8}if(hold!==(4294967295&state.total)){strm.msg="incorrect length check",state.mode=BAD;break}hold=0,bits=0}state.mode=DONE;case DONE:ret=Z_STREAM_END$2;break inf_leave;case BAD:ret=Z_DATA_ERROR$1;break inf_leave;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR$1}return strm.next_out=put,strm.avail_out=left,strm.next_in=next,strm.avail_in=have,state.hold=hold,state.bits=bits,(state.wsize||_out!==strm.avail_out&&state.mode<BAD&&(state.mode<CHECK||flush!==Z_FINISH$2))&&updatewindow(strm,strm.output,strm.next_out,_out-strm.avail_out)?(state.mode=MEM,Z_MEM_ERROR):(_in-=strm.avail_in,_out-=strm.avail_out,strm.total_in+=_in,strm.total_out+=_out,state.total+=_out,state.wrap&&_out&&(strm.adler=state.check=state.flags?crc32_1(state.check,output,_out,strm.next_out-_out):adler32_1(state.check,output,_out,strm.next_out-_out)),strm.data_type=state.bits+(state.last?64:0)+(state.mode===TYPE?128:0)+(state.mode===LEN_||state.mode===COPY_?256:0),(0===_in&&0===_out||flush===Z_FINISH$2)&&ret===Z_OK$2&&(ret=Z_BUF_ERROR$1),ret)},inflateEnd:function(strm){if(!strm||!strm.state)return Z_STREAM_ERROR$1;var state=strm.state;return state.window&&(state.window=null),strm.state=null,Z_OK$2},inflateGetHeader:function(strm,head){var state;return strm&&strm.state?0==(2&(state=strm.state).wrap)?Z_STREAM_ERROR$1:(state.head=head,head.done=!1,Z_OK$2):Z_STREAM_ERROR$1},inflateSetDictionary:function(strm,dictionary){var state,dictid,dictLength=dictionary.length;return strm&&strm.state?0!==(state=strm.state).wrap&&state.mode!==DICT?Z_STREAM_ERROR$1:state.mode===DICT&&(dictid=1,(dictid=adler32_1(dictid,dictionary,dictLength,0))!==state.check)?Z_DATA_ERROR$1:updatewindow(strm,dictionary,dictLength,dictLength)?(state.mode=MEM,Z_MEM_ERROR):(state.havedict=1,Z_OK$2):Z_STREAM_ERROR$1},inflateInfo:"pako inflate (from Nodeca project)"},constants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},gzheader=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},toString$1=Object.prototype.toString;Inflate.prototype.push=function(data,mode){var status,_mode,next_out_utf8,tail,utf8str,dict,strm=this.strm,chunkSize=this.options.chunkSize,dictionary=this.options.dictionary,allowBufError=!1;if(this.ended)return!1;_mode=mode===~~mode?mode:!0===mode?constants.Z_FINISH:constants.Z_NO_FLUSH,"string"==typeof data?strm.input=strings.binstring2buf(data):"[object ArrayBuffer]"===toString$1.call(data)?strm.input=new Uint8Array(data):strm.input=data,strm.next_in=0,strm.avail_in=strm.input.length;do{if(0===strm.avail_out&&(strm.output=new common.Buf8(chunkSize),strm.next_out=0,strm.avail_out=chunkSize),(status=inflate_1$2.inflate(strm,constants.Z_NO_FLUSH))===constants.Z_NEED_DICT&&dictionary&&(dict="string"==typeof dictionary?strings.string2buf(dictionary):"[object ArrayBuffer]"===toString$1.call(dictionary)?new Uint8Array(dictionary):dictionary,status=inflate_1$2.inflateSetDictionary(this.strm,dict)),status===constants.Z_BUF_ERROR&&!0===allowBufError&&(status=constants.Z_OK,allowBufError=!1),status!==constants.Z_STREAM_END&&status!==constants.Z_OK)return this.onEnd(status),this.ended=!0,!1;strm.next_out&&(0!==strm.avail_out&&status!==constants.Z_STREAM_END&&(0!==strm.avail_in||_mode!==constants.Z_FINISH&&_mode!==constants.Z_SYNC_FLUSH)||("string"===this.options.to?(next_out_utf8=strings.utf8border(strm.output,strm.next_out),tail=strm.next_out-next_out_utf8,utf8str=strings.buf2string(strm.output,next_out_utf8),strm.next_out=tail,strm.avail_out=chunkSize-tail,tail&&common.arraySet(strm.output,strm.output,next_out_utf8,tail,0),this.onData(utf8str)):this.onData(common.shrinkBuf(strm.output,strm.next_out)))),0===strm.avail_in&&0===strm.avail_out&&(allowBufError=!0)}while((strm.avail_in>0||0===strm.avail_out)&&status!==constants.Z_STREAM_END);return status===constants.Z_STREAM_END&&(_mode=constants.Z_FINISH),_mode===constants.Z_FINISH?(status=inflate_1$2.inflateEnd(this.strm),this.onEnd(status),this.ended=!0,status===constants.Z_OK):_mode!==constants.Z_SYNC_FLUSH||(this.onEnd(constants.Z_OK),strm.avail_out=0,!0)},Inflate.prototype.onData=function(chunk){this.chunks.push(chunk)},Inflate.prototype.onEnd=function(status){status===constants.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=status,this.msg=this.strm.msg};var inflate_1={Inflate:Inflate,inflate:inflate,inflateRaw:function(input,options){return options=options||{},options.raw=!0,inflate(input,options)},ungzip:inflate},pako={};(0,common.assign)(pako,deflate_1,inflate_1,constants);var index_1=pako.inflate;class MEMORY{static allocateUint8(len){MEMORY.u8=new Uint8Array(len)}static allocateUint16(len){MEMORY.u16=new Uint16Array(len)}static allocateUint32(len){MEMORY.u32=new Uint32Array(len)}static getUint8(){return MEMORY.u8||MEMORY.allocateUint8(10),MEMORY.u8Index++}static getUint16(){return MEMORY.u16||MEMORY.allocateUint16(24),MEMORY.u16Index++}static getUint32(){return MEMORY.u32||MEMORY.allocateUint32(10),MEMORY.u32Index++}}MEMORY.u8Index=0,MEMORY.u16Index=0,MEMORY.u32Index=0;class RangeDecoder{constructor(){this.rangeI=0,this.codeI=1,this.loc1=2,this.loc2=3,this.idPos=13}isFinishedOK(){return 0===this.U32[this.codeI]}init(){this.U32=new Uint32Array(4),this.U16=new Uint16Array(4),this.corrupted=!1,0!==this.inStream[this.idPos++]&&(this.corrupted=!0),this.U32[this.rangeI]=4294967295,this.U32[this.codeI]=0;for(let i=0;i<4;i++)this.U32[this.codeI]=this.U32[this.codeI]<<8|this.inStream[this.idPos++];this.U32[this.codeI]===this.U32[this.rangeI]&&(this.corrupted=!0)}normalize(){this.U32[this.rangeI]<RangeDecoder.kTopValue&&(this.U32[this.rangeI]<<=8,this.U32[this.codeI]=this.U32[this.codeI]<<8|this.inStream[this.idPos++])}decodeDirectBits(numBits){this.U32[this.loc1]=0;do{this.U32[this.rangeI]>>>=1,this.U32[this.codeI]-=this.U32[this.rangeI],this.U32[this.loc2]=0-(this.U32[this.codeI]>>>31),this.U32[this.codeI]+=this.U32[this.rangeI]&this.U32[this.loc2],this.U32[this.codeI]===this.U32[this.rangeI]&&(this.corrupted=!0),this.normalize(),this.U32[this.loc1]<<=1,this.U32[this.loc1]+=this.U32[this.loc2]+1}while(--numBits);return this.U32[this.loc1]}decodeBit(prob,index){return this.U16[0]=prob[index],this.U32[2]=(this.U32[0]>>>11)*this.U16[0],this.U32[1]<this.U32[2]?(this.U16[0]+=2048-this.U16[0]>>>5,this.U32[0]=this.U32[2],this.U16[1]=0):(this.U16[0]-=this.U16[0]>>>5,this.U32[1]-=this.U32[2],this.U32[0]-=this.U32[2],this.U16[1]=1),prob[index]=this.U16[0],this.U32[0]<16777216&&(this.U32[0]<<=8,this.U32[1]=this.U32[1]<<8|this.inStream[this.idPos++]),this.U16[1]}}RangeDecoder.kTopValue=1<<24;class OutWindow{constructor(){this.outPos=0}create(dictSize){this.buf=new Uint8Array(dictSize),this.pos=0,this.size=dictSize,this.isFull=!1,this.totalPos=0}putByte(b){this.totalPos++,this.buf[this.pos++]=b,this.pos===this.size&&(this.pos=0,this.isFull=!0),this.outStream[this.outPos++]=b}getByte(dist){return this.buf[dist<=this.pos?this.pos-dist:this.size-dist+this.pos]}copyMatch(dist,len){for(;len>0;len--)this.putByte(this.getByte(dist))}checkDistance(dist){return dist<=this.pos||this.isFull}isEmpty(){return 0===this.pos&&!this.isFull}}class BitTreeDecoder{constructor(numBits){this.numBits=numBits,this.probs=new Uint16Array(1<<this.numBits)}static constructArray(numBits,len){let vec=[];for(let i=0;i<len;i++)vec[i]=new BitTreeDecoder(numBits);return vec}init(){LZMA.INIT_PROBS(this.probs)}decode(rc){let m=1;for(let i=0;i<this.numBits;i++)m=(m<<1)+rc.decodeBit(this.probs,m);return m-(1<<this.numBits)}reverseDecode(rc){return LZMA.BitTreeReverseDecode(this.probs,this.numBits,rc)}}class LenDecoder{constructor(){this.choice=new Uint16Array([LZMA.PROB_INIT_VAL,LZMA.PROB_INIT_VAL]),this.lowCoder=BitTreeDecoder.constructArray(3,1<<LZMA.kNumPosBitsMax),this.midCoder=BitTreeDecoder.constructArray(3,1<<LZMA.kNumPosBitsMax),this.highCoder=new BitTreeDecoder(8)}init(){this.highCoder.init();for(let i=0;i<1<<LZMA.kNumPosBitsMax;i++)this.lowCoder[i].init(),this.midCoder[i].init()}decode(rc,posState){return 0===rc.decodeBit(this.choice,0)?this.lowCoder[posState].decode(rc):0===rc.decodeBit(this.choice,1)?8+this.midCoder[posState].decode(rc):16+this.highCoder.decode(rc)}}class LzmaDecoder{constructor(){this.posSlotDecoder=BitTreeDecoder.constructArray(6,LZMA.kNumLenToPosStates),this.alignDecoder=new BitTreeDecoder(LZMA.kNumAlignBits),this.posDecoders=new Uint16Array(1+LZMA.kNumFullDistances-LZMA.kEndPosModelIndex),this.isMatch=new Uint16Array(LZMA.kNumStates<<LZMA.kNumPosBitsMax),this.isRep=new Uint16Array(LZMA.kNumStates),this.isRepG0=new Uint16Array(LZMA.kNumStates),this.isRepG1=new Uint16Array(LZMA.kNumStates),this.isRepG2=new Uint16Array(LZMA.kNumStates),this.isRep0Long=new Uint16Array(LZMA.kNumStates<<LZMA.kNumPosBitsMax),this.lenDecoder=new LenDecoder,this.repLenDecoder=new LenDecoder,this.rangeDec=new RangeDecoder,this.outWindow=new OutWindow}init(){this.loc1=0|MEMORY.getUint32(),this.loc2=0|MEMORY.getUint32(),this.matchBitI=0|MEMORY.getUint16(),this.matchByteI=0|MEMORY.getUint16(),this.bitI=0|MEMORY.getUint16(),this.symbolI=0|MEMORY.getUint16(),this.prevByteI=0|MEMORY.getUint16(),this.litStateI=0|MEMORY.getUint16(),this.initLiterals(),this.initDist(),LZMA.INIT_PROBS(this.isMatch),LZMA.INIT_PROBS(this.isRep),LZMA.INIT_PROBS(this.isRepG0),LZMA.INIT_PROBS(this.isRepG1),LZMA.INIT_PROBS(this.isRepG2),LZMA.INIT_PROBS(this.isRep0Long),this.lenDecoder.init(),this.repLenDecoder.init()}create(){this.outWindow.create(this.dictSize),this.createLiterals()}decodeProperties(properties){let prop=new Uint8Array(4);if(prop[0]=properties[0],prop[0]>=225)throw new Error("Incorrect LZMA properties");prop[1]=prop[0]%9,prop[0]/=9,prop[2]=prop[0]/5,prop[3]=prop[0]%5,this.lc=prop[1],this.pb=prop[2],this.lp=prop[3],this.dictSizeInProperties=0;for(let i=0;i<4;i++)this.dictSizeInProperties|=properties[i+1]<<8*i;this.dictSize=this.dictSizeInProperties,this.dictSize<LZMA.LZMA_DIC_MIN&&(this.dictSize=LZMA.LZMA_DIC_MIN)}decode(unpackSizeDefined,unpackSize){this.init(),this.rangeDec.init(),unpackSizeDefined&&(this.outWindow.outStream=new Uint8Array(new ArrayBuffer(unpackSize)));let rep0=0,rep1=0,rep2=0,rep3=0,state=0;for(;;){if(unpackSizeDefined&&0===unpackSize&&!this.markerIsMandatory&&this.rangeDec.isFinishedOK())return LZMA.LZMA_RES_FINISHED_WITHOUT_MARKER;let posState=this.outWindow.totalPos&(1<<this.pb)-1;if(0===this.rangeDec.decodeBit(this.isMatch,(state<<LZMA.kNumPosBitsMax)+posState)){if(unpackSizeDefined&&0===unpackSize)return LZMA.LZMA_RES_ERROR;this.decodeLiteral(state,rep0),state=this.updateState_Literal(state),unpackSize--;continue}let len;if(0!==this.rangeDec.decodeBit(this.isRep,state)){if(unpackSizeDefined&&0===unpackSize)return LZMA.LZMA_RES_ERROR;if(this.outWindow.isEmpty())return LZMA.LZMA_RES_ERROR;if(0===this.rangeDec.decodeBit(this.isRepG0,state)){if(0===this.rangeDec.decodeBit(this.isRep0Long,(state<<LZMA.kNumPosBitsMax)+posState)){state=this.updateState_ShortRep(state),this.outWindow.putByte(this.outWindow.getByte(rep0+1)),unpackSize--;continue}}else{let dist;0===this.rangeDec.decodeBit(this.isRepG1,state)?dist=rep1:(0===this.rangeDec.decodeBit(this.isRepG2,state)?dist=rep2:(dist=rep3,rep3=rep2),rep2=rep1),rep1=rep0,rep0=dist}len=this.repLenDecoder.decode(this.rangeDec,posState),state=this.updateState_Rep(state)}else{if(rep3=rep2,rep2=rep1,rep1=rep0,len=this.lenDecoder.decode(this.rangeDec,posState),state=this.updateState_Match(state),4294967295===(rep0=this.decodeDistance(len)))return this.rangeDec.isFinishedOK()?LZMA.LZMA_RES_FINISHED_WITH_MARKER:LZMA.LZMA_RES_ERROR;if(unpackSizeDefined&&0===unpackSize)return LZMA.LZMA_RES_ERROR;if(rep0>=this.dictSize||!this.outWindow.checkDistance(rep0))return LZMA.LZMA_RES_ERROR}len+=LZMA.kMatchMinLen;let isError=!1;if(unpackSizeDefined&&unpackSize<len&&(len=unpackSize,isError=!0),this.outWindow.copyMatch(rep0+1,len),unpackSize-=len,isError)return LZMA.LZMA_RES_ERROR}}createLiterals(){this.litProbs=new Uint16Array(768<<this.lc+this.lp)}initLiterals(){let num=768<<this.lc+this.lp;for(let i=0;i<num;i++)this.litProbs[i]=LZMA.PROB_INIT_VAL}decodeLiteral(state,rep0){MEMORY.u16[this.prevByteI]=0,this.outWindow.isEmpty()||(MEMORY.u16[this.prevByteI]=this.outWindow.getByte(1)),MEMORY.u16[this.symbolI]=1,MEMORY.u16[this.litStateI]=((this.outWindow.totalPos&(1<<this.lp)-1)<<this.lc)+(MEMORY.u16[this.prevByteI]>>>8-this.lc);let probsOffset=768*MEMORY.u16[this.litStateI]|0;if(state>=7){MEMORY.u16[this.matchByteI]=this.outWindow.getByte(rep0+1);do{if(MEMORY.u16[this.matchBitI]=MEMORY.u16[this.matchByteI]>>>7&1,MEMORY.u16[this.matchByteI]<<=1,MEMORY.u16[this.bitI]=this.rangeDec.decodeBit(this.litProbs,probsOffset+(1+MEMORY.u16[this.matchBitI]<<8)+MEMORY.u16[this.symbolI]),MEMORY.u16[this.symbolI]=MEMORY.u16[this.symbolI]<<1|MEMORY.u16[this.bitI],MEMORY.u16[this.matchBitI]!==MEMORY.u16[this.bitI])break}while(MEMORY.u16[this.symbolI]<256)}for(;MEMORY.u16[this.symbolI]<256;)MEMORY.u16[this.symbolI]=MEMORY.u16[this.symbolI]<<1|this.rangeDec.decodeBit(this.litProbs,probsOffset+MEMORY.u16[this.symbolI]);this.outWindow.putByte(MEMORY.u16[this.symbolI]-256)}decodeDistance(len){let lenState=len;lenState>LZMA.kNumLenToPosStates-1&&(lenState=LZMA.kNumLenToPosStates-1);let posSlot=this.posSlotDecoder[lenState].decode(this.rangeDec);if(posSlot<4)return posSlot;let numDirectBits=(posSlot>>>1)-1;return MEMORY.u32[this.loc1]=(2|1&posSlot)<<numDirectBits,posSlot<LZMA.kEndPosModelIndex?MEMORY.u32[this.loc1]+=LZMA.BitTreeReverseDecode(this.posDecoders,numDirectBits,this.rangeDec,MEMORY.u32[this.loc1]-posSlot):(MEMORY.u32[this.loc1]+=this.rangeDec.decodeDirectBits(numDirectBits-LZMA.kNumAlignBits)<<LZMA.kNumAlignBits,MEMORY.u32[this.loc1]+=this.alignDecoder.reverseDecode(this.rangeDec)),MEMORY.u32[this.loc1]}initDist(){for(let i=0;i<LZMA.kNumLenToPosStates;i++)this.posSlotDecoder[i].init();this.alignDecoder.init(),LZMA.INIT_PROBS(this.posDecoders)}updateState_Literal(state){return state<4?0:state<10?state-3:state-6}updateState_ShortRep(state){return state<7?9:11}updateState_Rep(state){return state<7?8:11}updateState_Match(state){return state<7?7:10}}class LZMA{constructor(){this.decoder=new LzmaDecoder}static INIT_PROBS(p){for(let i=0;i<p.length;i++)p[i]=this.PROB_INIT_VAL}static BitTreeReverseDecode(probs,numBits,rc,offset=0){let m=1,symbol=0;for(let i=0;i<numBits;i++){let bit=rc.decodeBit(probs,offset+m);m<<=1,m+=bit,symbol|=bit<<i}return symbol}decodeSWF(data,unpackLength){let i,header=new Uint8Array(5);for(i=0;i<5;i++)header[i]=data[i];this.decoder.decodeProperties(header);let unpackSize=unpackLength;this.decoder.markerIsMandatory=!1,this.decoder.rangeDec.inStream=data,this.decoder.rangeDec.idPos=5,this.decoder.create();let res=this.decoder.decode(!0,unpackSize);if(res===LZMA.LZMA_RES_ERROR)throw"LZMA decoding error";if(res===LZMA.LZMA_RES_FINISHED_WITHOUT_MARKER);else{if(res!==LZMA.LZMA_RES_FINISHED_WITH_MARKER)throw"Internal Error";if(this.decoder.outWindow.outPos!==unpackSize)throw"Finished with end marker before than specified size"}return this.decoder.rangeDec.corrupted&&console.log("Warning: LZMA stream is corrupted"),this.decoder.outWindow.outStream}decode(data){let i,header=new Uint8Array(13);for(i=0;i<13;i++)header[i]=data[i];this.decoder.decodeProperties(header);let unpackSize=0,unpackSizeDefined=!1;for(i=0;i<8;i++){let b=header[5+i];255!==b&&(unpackSizeDefined=!0),unpackSize|=b<<8*i}this.decoder.markerIsMandatory=!unpackSizeDefined,this.decoder.rangeDec.inStream=data,this.decoder.create();let res=this.decoder.decode(unpackSizeDefined,unpackSize);if(res===LZMA.LZMA_RES_ERROR)throw"LZMA decoding error";if(res===LZMA.LZMA_RES_FINISHED_WITHOUT_MARKER);else{if(res!==LZMA.LZMA_RES_FINISHED_WITH_MARKER)throw"Internal Error";if(unpackSizeDefined&&this.decoder.outWindow.outPos!==unpackSize)throw"Finished with end marker before than specified size"}return this.decoder.rangeDec.corrupted&&console.log("Warning: LZMA stream is corrupted"),this.decoder.outWindow.outStream}}LZMA.LZMA_DIC_MIN=4096,LZMA.LZMA_RES_ERROR=0,LZMA.LZMA_RES_FINISHED_WITH_MARKER=1,LZMA.LZMA_RES_FINISHED_WITHOUT_MARKER=2,LZMA.kNumBitModelTotalBits=11,LZMA.kNumMoveBits=5,LZMA.PROB_INIT_VAL=(1<<LZMA.kNumBitModelTotalBits)/2,LZMA.kNumPosBitsMax=4,LZMA.kNumStates=12,LZMA.kNumLenToPosStates=4,LZMA.kNumAlignBits=4,LZMA.kStartPosModelIndex=4,LZMA.kEndPosModelIndex=14,LZMA.kNumFullDistances=1<<(LZMA.kEndPosModelIndex>>>1),LZMA.kMatchMinLen=2;const lzma=new LZMA;let tagHandler=new Map;var CompressType;!function(CompressType){CompressType[CompressType.uncompressed=70]="uncompressed",CompressType[CompressType.zlibCompressed=67]="zlibCompressed",CompressType[CompressType.lzmaCompressed=90]="lzmaCompressed"}(CompressType||(CompressType={}));var TagType;!function(TagType){TagType[TagType.End=0]="End",TagType[TagType.SymbolClass=76]="SymbolClass",TagType[TagType.DoABC=82]="DoABC",TagType[TagType.DefineBinaryData=87]="DefineBinaryData"}(TagType||(TagType={}));class Tag{constructor(reader,noMovePtr=!1){let typeAndLength=reader.readUI16(),type=typeAndLength>>6,length=63&typeAndLength;63===length&&(length=reader.readUI32()),this.type=type,this.length=length,noMovePtr||reader.movePtr(length)}toJSON(){let ret={type:this.type,length:this.length},name=this.constructor.name;return"Tag"!==name&&(ret.className=name),this.data instanceof ArrayBuffer&&(ret.data=hex(Array.from(new Uint8Array(this.data.slice(0,20))))),ret}}let TagDoABC=class extends Tag{constructor(reader){super(reader,!0);let start=reader.getPosition();this.flags=reader.readUI32(),this.name=reader.readCStyleString();const offset=reader.getPosition()-start;this.data=reader.readArray(this.length-offset)}toJSON(){let ret=super.toJSON();return ret.flags=this.flags,ret.name=this.name,ret}};TagDoABC=__decorate([TagHandler(TagType.DoABC)],TagDoABC);let TagDefineBinaryData=class extends Tag{constructor(reader){super(reader,!0),this.tag=reader.readUI16(),reader.readUI32(),this.data=reader.readArray(this.length-6)}toJSON(){let ret=super.toJSON();return ret.tag=this.tag,ret.symbolName=this.symbolName,ret}};TagDefineBinaryData=__decorate([TagHandler(TagType.DefineBinaryData)],TagDefineBinaryData);let TagSymbolClass=class extends Tag{constructor(reader){super(reader,!0),this.symbols=new Map;const count=reader.readUI16(),symbols=this.symbols;for(let i=0;i<count;i++){const tag=reader.readUI16(),name=reader.readCStyleString();symbols.set(tag,name)}}toJSON(){let ret=super.toJSON();return ret.symbols=this.symbols,ret}};TagSymbolClass=__decorate([TagHandler(TagType.SymbolClass)],TagSymbolClass);class SWFFile{constructor(app){this.app=app,this.tags=[]}read(reader){return __awaiter(this,void 0,void 0,function*(){this.compressType=reader.readU8(),reader.readU8()===ord("W")&&reader.readU8()===ord("S")||this.app.throwError("VerifyError",Errors.FileVerificationError),this.version=reader.readU8(),this.fileLength=reader.readUI32();const body=yield this.expandBody(reader),bodyReader=new BufferReader(body),swfReader=new SWFReader(bodyReader);this.frameSize=swfReader.readRect(),this.frameRate=swfReader.readFixed8(),this.frameCount=bodyReader.readU16(),this.tags=[];for(let tag of swfReader.readTags())this.tags.push(tag);const binary=this.getTags(TagDefineBinaryData),symbol=this.getTags(TagSymbolClass)[0];if(binary.length>0&&!symbol)throw new Error("SymbolClass not found");for(let b of binary)b.symbolName=symbol.symbols.get(b.tag)})}getTags(type){return this.tags.filter(t=>t.type===type.type)}dropUnusedTags(){this.tags=this.tags.filter(i=>i.constructor!==Tag);this.tags.filter(i=>i.constructor===TagDoABC)}expandBody(reader){return __awaiter(this,void 0,void 0,function*(){const headerLen=reader.getPosition();if(this.compressType===CompressType.uncompressed)return reader.readArray(this.fileLength-headerLen);if(this.compressType===CompressType.zlibCompressed)return yield decompressZlib(reader.readArray(-1));if(this.compressType===CompressType.lzmaCompressed){reader.readUI32();return yield decompressLZMA(reader.readArray(-1),this.fileLength-headerLen)}return null})}toJSON(){return{compressType:CompressType[this.compressType],version:this.version,fileLength:this.fileLength,frameSize:this.frameSize,frameRate:this.frameRate,frameCount:this.frameCount,tags:this.tags}}}class Rect{}class SWFReader{constructor(reader){this.reader=reader,this.bitPos=0,this.tempByte=0}readFixed(){let num=this.reader.readUI32();return(65535&num)/65536+(num>>16)}readFixed8(){let num=this.reader.readUI16();return(255&num)/256+(num>>8)}readUB(nBits){if(0===nBits)return 0;let ret=0;0===this.bitPos&&(this.tempByte=this.reader.readU8());for(let bit=0;bit<nBits;bit++)ret+=(this.tempByte>>7-this.bitPos&1)<<nBits-1-bit,8===++this.bitPos&&(this.bitPos=0,bit!==nBits-1&&(this.tempByte=this.reader.readU8()));return ret}readSB(nBits){let uval=this.readUB(nBits);const shift=32-nBits;return uval=uval<<shift>>shift}alignByte(){this.bitPos=0}readRect(){let ret=new Rect;const nbits=this.readUB(5);return ret.Xmin=this.readSB(nbits),ret.Xmax=this.readSB(nbits),ret.Ymin=this.readSB(nbits),ret.Ymax=this.readSB(nbits),this.alignByte(),ret}*readTags(){for(let tag=this.readTag();null!==tag&&(yield tag,tag.type!==TagType.End);tag=this.readTag());}readTag(){try{let type=this.reader.readUI16()>>6;this.reader.movePtr(-2);let tagType=tagHandler.get(type);return tagType||(tagType=Tag),new tagType(this.reader)}catch(e){return e instanceof BufferReaderError||console.error(e),null}}}const logger=new Logger("FlashEmu");class FlashEmu{constructor(fi){this.binaryData=new Map,this.hooks=new Map,this._inited=!1,this.sec=new SecurityDomain$$1(this),this.app=this.sec.createApplicationDomain(null),this.interpreter=new Interpreter,this.fi=fi}static setLogFilter(f){Logger.logFilter=f}static setGlobalFlags(flags){setGlobalFlags(flags)}static swfBuffer2str(buffer){return __awaiter(this,void 0,void 0,function*(){let flashEmu=new FlashEmu({readFile(filename){return __awaiter(this,void 0,void 0,function*(){return null})}}),app=new SecurityDomain$$1(flashEmu).createApplicationDomain(null);const swf=new SWFFile(app);yield swf.read(new BufferReader(buffer));let abcs=swf.getTags(TagDoABC),out="";for(let abcTag of abcs){const reader=new BufferReader(abcTag.data);let abc=new AbcFile(reader,app);out+=JSON.stringify(abc,null,2)}return out})}static abcBuffer2str(buffer){let flashEmu=new FlashEmu({readFile(filename){return __awaiter(this,void 0,void 0,function*(){return null})}}),app=new SecurityDomain$$1(flashEmu).createApplicationDomain(null),reader=new BufferReader(buffer),abc=new AbcFile(reader,app);return JSON.stringify(abc,null,2)}init(){return __awaiter(this,void 0,void 0,function*(){if(!this._inited){this._inited=!0;const systemDomain=this.sec.system;yield this.loadABCFile(FlashEmu.BUILTIN,systemDomain),yield this.loadABCFile(FlashEmu.PLAYERGLOBAL,systemDomain),this.sec.onBuiltinLoaded()}})}loadABC(stream,app){const reader=new BufferReader(stream),abc=new AbcFile(reader,this.app);app.loadABC(abc)}loadABCFile(fileName,app){return __awaiter(this,void 0,void 0,function*(){this._inited||(yield this.init()),this.loadABC(yield this.fi.readFile(fileName),app)})}getClass(mn){return this.app.getClass(mn)}getPublicClass(name){return this.app.getClass(Multiname.Public(name))}getProperty(pkg,name){return this.app.getProperty(Multiname.Package(pkg,name),!0,!0)}executeScript(abcid=-1,id=-1){abcid<0&&(abcid+=this.app.abcs.length);const abc=this.app.abcs[abcid];id<0&&(id+=abc.script.length);let script=abc.getScript(id);return this.app.executeScript(script)}hookFlascc(name,espPkg,argCount,func){const self=this;this.hooks.set(name,{name:name,callback:function(){const esp=self.getProperty(espPkg,"ESP"),view=this.app.domainMemory.view;let ps=[];for(let i=0;i<argCount;i++)ps.push(view.getUint32(esp+4*i,!0));return func.call(this,...ps)}})}loadSWF(fileName){return __awaiter(this,void 0,void 0,function*(){yield this.init();const stream=yield this.fi.readFile(fileName),reader=new BufferReader(stream),swf=new SWFFile(this.app);yield swf.read(reader),this.swf=swf;let bins=swf.getTags(TagDefineBinaryData);for(let b of bins)this.binaryData.set(b.symbolName,b.data)})}runSWF(fileName){return __awaiter(this,void 0,void 0,function*(){yield this.loadSWF(fileName),this.swf.dropUnusedTags();const doAbc=this.swf.getTags(TagDoABC);for(let abc of doAbc)this.loadABC(abc.data,this.app);this.executeScript()})}testswf2(fileName){return __awaiter(this,void 0,void 0,function*(){yield this.loadSWF(fileName),this.swf.dropUnusedTags();const doAbc=this.swf.getTags(TagDoABC);for(let abc of doAbc)this.loadABC(abc.data,this.app);this.app.getClass(Multiname.Package("com.adobe.flascc","CModule")).callProperty("startAsync");let check=this.getProperty("MyCPP","check"),ret=check.call(check,"123");logger.error(ret)})}testswf(fileName){return __awaiter(this,void 0,void 0,function*(){this.hookFlascc("Fmemset","sample.xx",3,(dest,val,len)=>{this.app.domainMemory.u8view.fill(val,dest,dest+len)});let time=(new Date).getTime();yield this.loadSWF(fileName),this.swf.dropUnusedTags();const doAbc=this.swf.getTags(TagDoABC);for(let abc of doAbc)this.loadABC(abc.data,this.app);let CModule=this.app.getClass(Multiname.Package("sample.xx","CModule")),xx=this.app.getClass(Multiname.Public("xx"));logger.error("CModule get"),CModule.callProperty("startAsync"),logger.error("CModule loaded");const sign=()=>{let time=(new Date).getTime(),StreamSignDataPtr=CModule.callProperty("malloc",4),outptr1=CModule.callProperty("malloc",4),datalen=xx.callProperty("sub_13",687423,25020488,"D2C2C9675D34594BCD066616B5C9AE44",outptr1,StreamSignDataPtr),pSign=CModule.callProperty("read32",StreamSignDataPtr),sign=CModule.callProperty("readString",pSign,datalen);logger.error(pSign,sign),CModule.callProperty("free",StreamSignDataPtr),CModule.callProperty("free",outptr1),logger.error("sign time:",(new Date).getTime()-time)};clear(),sign(),sign(),sign(),logger.error("time:",(new Date).getTime()-time),logger.error(topFunctions(50)),logger.error(topFunctions(50,"times"))})}}return FlashEmu.BUILTIN="./lib/builtin.abc",FlashEmu.PLAYERGLOBAL="./lib/playerglobal.abc",FlashEmu});
